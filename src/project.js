System.register([], function(_export, _context) { return { execute: function () {
System.register("chunks:///Config.js",["cc"],(function(e,i){var n,t,a,c,o;return e("EnvType",void 0),{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"1c95bfLt8hDMI/mY7kSxKrA","Config",void 0),function(e){e[e.online=0]="online",e[e.develop=1]="develop"}(t||e("EnvType",t={})),e("Env",a=t.develop),e("UseSign",!1),e("DebugGameTime",18e4),e("config",c={matchCode:"match-na9u3tge",gameId:"obg-4zid10f3",secretKey:"nothing",initConfig:{url:"4zid10f3.wxlagame.com",reconnectMaxTimes:5,reconnectInterval:1e3,resendInterval:1e3,resendTimeout:1e4,isAutoRequestFrame:!0}}),e("serverURL",o={gameInit:"https://dev-api.didiapp.com/client/awesome/game/jump/info/",accountInit:"https://dev-api.didiapp.com/client/account/user/",sign:"https://dev-api.didiapp.com/client/awesome/game/jump/sign"}),a==t.develop&&(c.gameId="obg-6hgl7n1x",c.secretKey="56b5d33b7bafe1fc5a7f8b34e7486a214dee172a",c.matchCode="match-rezk4kbg",c.initConfig.url="6hgl7n1x.wxlagame.com",o.gameInit="https://dev-api.didiapp.com/client/awesome/game/jump/info/",o.accountInit="https://dev-api.didiapp.com/client/account/user/info/",o.sign="https://dev-api.didiapp.com/client/awesome/game/jump/sign"),n._RF.pop()}}}));

System.register("chunks:///Const.js",["cc"],(function(e,t){var n,o,a,r,c,i,l,u,p;return e({log:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var a;n[0]="［"+n[0]+"]",n.unshift("["+((a=new Date).getHours()+":"+a.getMinutes()+":"+a.getSeconds()+":"+a.getMilliseconds())+"]:"),(e=console).log.apply(e,n)},BoxShape:void 0,JumpStatus:void 0,ServerDataType:void 0,ClientDataType:void 0,RoomDataType:void 0,EmojiType:void 0,DialogButtonType:void 0}),{setters:[function(e){n=e.cclegacy,o=e.Color}],execute:function(){n._RF.push({},"286ccI0TulGCrD81NytQWoS","Const",void 0),function(e){e[e.cube=0]="cube",e[e.circle=1]="circle"}(a||e("BoxShape",a={})),e("BoxSizeName",{mini:0,small:1,middle:2,large:3,huge:4,center:5}),e("BoxSize",{0:1.3,1:1.833,2:2.249,3:2.6,4:2.24*1.3,5:.26}),function(e){e[e.next=0]="next",e[e.current=1]="current",e[e.dead=2]="dead"}(r||e("JumpStatus",r={})),function(e){e[e.Error=-1]="Error",e[e.Init=0]="Init",e[e.Sync=1]="Sync",e[e.Result=2]="Result",e[e.Start=3]="Start",e[e.Reconnect=4]="Reconnect",e[e.Map=5]="Map",e[e.NetState=6]="NetState",e[e.ChangeControler=7]="ChangeControler",e[e.ReconnectFailed=8]="ReconnectFailed"}(c||e("ServerDataType",c={})),function(e){e[e.Ready=0]="Ready",e[e.Action=1]="Action",e[e.End=2]="End",e[e.Reconnect=3]="Reconnect",e[e.ChangeControler=4]="ChangeControler",e[e.ReconnectComplete=5]="ReconnectComplete",e[e.Heart=6]="Heart",e[e.RequestInitData=7]="RequestInitData",e[e.RequestSyncData=8]="RequestSyncData",e[e.SyncComplete=9]="SyncComplete"}(i||e("ClientDataType",i={})),function(e){e[e.EnemyPowerEnd=0]="EnemyPowerEnd",e[e.Power=1]="Power",e[e.PowerEnd=2]="PowerEnd",e[e.emoji=3]="emoji",e[e.SyncComplete=4]="SyncComplete",e[e.MatchedJoinGroup=5]="MatchedJoinGroup"}(l||e("RoomDataType",l={})),function(e){e[e.Angry=0]="Angry",e[e.Worship=1]="Worship",e[e.Unfortunately=2]="Unfortunately",e[e.Applause=3]="Applause"}(u||e("EmojiType",u={})),e("PlayerState",{NotReady:0,Ready:1}),e("NetState",{Offline:0,Online:1}),e("GroupMessageType",{Sys:1,Talk:2}),e("GroupSysMessageType",{Matching:1}),e("LabelColor",{Captain:new o(46,139,33),Ready:new o(46,139,33),NotReady:new o(131,123,123)}),function(e){e[e.single=0]="single",e[e.multiple=1]="multiple"}(p||e("DialogButtonType",p={})),n._RF.pop()}}}));

System.register("chunks:///Player.js",["cc","./Const.js","./_virtual/_rollupPluginBabelHelpers.js"],(function(t,e){var i,s,o,n,r,a,u,h,l,m,p,d,c,_,f,w,g,P,y,j,v,x,R,B,b,k,T,z,H,A,C,I,D,S,Y,F,N,U,M;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){i=t.cclegacy,s=t._decorator,o=t.Vec3,n=t.Quat,r=t.Prefab,a=t.CCFloat,u=t.Vec2,h=t.systemEvent,l=t.SystemEvent,m=t.tween,p=t.Component,d=t.loader,c=t.instantiate},function(t){_=t.log,f=t.JumpStatus,w=t.BoxSizeName},function(t){g=t.applyDecoratedDescriptor,P=t.inherits,y=t.classCallCheck,j=t.possibleConstructorReturn,v=t.getPrototypeOf,x=t.initializerDefineProperty,R=t.assertThisInitialized,B=t.createClass,b=t.asyncToGenerator}],execute:function(){i._RF.push({},"06087OdteJF9alMqGeb4DFG","Player",void 0),N=s.ccclass,U=s.property,new o,new o,M=new n,new n,t("Player",(k=N("Player"),T=U({type:r}),z=U({type:a}),H=U({type:a}),A=U({type:a}),k((D=g((I=function(t){function e(){var t,i;y(this,e);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=j(this,(t=v(e)).call.apply(t,[this].concat(r))),x(i,"playerPrfb",D,R(i)),x(i,"jumpHeight",S,R(i)),x(i,"jumpDuration",Y,R(i)),x(i,"max_time",F,R(i)),i.originPosY=0,i.originRotation=new n(0,1,0,0),i.curRotation=new n,i.curPostion=new o,i._jump_time=0,i.jumpResult={time:null,distance:null,offset:null,status:null,perfect:!1},i._face=new u,i._axis=new o,i._stat_power=!1,i._stat_jump=!1,i.curBox=null,i.nextBox=null,i._isRunning=!1,i._control=!1,i.is_controler=!1,i.modelBody=null,i.modelHead=null,i.modelHeadPos=new o,i.modelTire=null,i.AI=!1,i.AI_power=!1,i.AI_jump=!1,i}var i,s;return P(e,t),B(e,[{key:"onLoad",value:function(){this.node.getRotation(M)}},{key:"initEvent",value:function(){this.node.on("SetFace",this.onSetFace,this)}},{key:"initPlayer",value:function(){var t=new o(0,this.originPosY,0);this.node.setPosition(t),this.node.setRotation(this.originRotation),this.curPostion.x=0,this.curPostion.y=this.originPosY,this.curPostion.z=0,this._isRunning=!1,this._control=!1,this.is_controler=!1,this._jump_time=0,this.AI_power=!1,this.AI_jump=!1,_("设置power","初始化player"),this._stat_power=!1,this._stat_jump=!1}},{key:"onSetFace",value:function(t){}},{key:"start",value:function(){this.originPosY=this.node.position.y,this.node.getRotation(this.curRotation),this.initEvent(),h.on(l.EventType.TOUCH_START,this.onTouchDown,this),h.on(l.EventType.TOUCH_END,this.onTouchUp,this)}},{key:"onTouchDown",value:function(t){this.control&&this.is_controler&&0==this._stat_power&&0==this._stat_jump&&(this.onPowerDown(),this._stat_power=!0,this.jumpResult.time=0,this._control=!1)}},{key:"onTouchUp",value:function(t){if(this._stat_power&&this.is_controler){_("设置power","松开蓄力"),this._stat_power=!1,m(this.curBox.node).to(.05,{scale:new o(1,1,1)}).start(),this.modelBody.setScale(new o(1,1,1)),this.modelHead.setPosition(this.modelHeadPos),this.modelTire&&this.modelTire.setPosition(new o(0,0,0));var e=new o;this.node.getPosition(e),e.y=this.originPosY,this.node.setPosition(e),this.start_jump()}}},{key:"teammatePower",value:function(){0==this.control&&(this.jumpResult.time=0,this._stat_power=!0)}},{key:"teammatePowerEnd",value:function(t){if(0==this.control){_("设置power","队友松开蓄力"),this._stat_power=!1,m(this.curBox.node).to(.05,{scale:new o(1,1,1)}).start(),this.modelBody.setScale(new o(1,1,1)),this.modelHead.setPosition(this.modelHeadPos),this.modelTire&&this.modelTire.setPosition(new o(0,0,0));var e=new o;this.node.getPosition(e),e.y=this.originPosY,this.node.setPosition(e),this.start_jump(t)}}},{key:"funnction_jump",value:function(t){return 7*t*t+5*t}},{key:"start_jump",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this._stat_power)if(this._stat_jump=!0,this._jump_time=0,this.getFace(this._face),this._axis=this.gameManager.Util.getJumpAxis(this.node,this.nextBox.node),this.node.getRotation(this.curRotation),this.node.getPosition(this.curPostion),null==t){this.jumpResult.distance=this.funnction_jump(this.jumpResult.time);var e=new o,i=new o,s=new o,n=new u,r=null,a=!1,h=null;this.node.getPosition(s),this.curBox.node.getPosition(i),this.nextBox.node.getPosition(e),this.getFace(n),n.normalize(),n.multiplyScalar(this.jumpResult.distance),n.x+=s.x,n.y+=s.z;var l=new u(999,999);this.gameManager.Util.posInBox(n,new u(e.x,e.z),this.nextBox.size,this.nextBox.shape,l)?(r=[n.x-e.x,n.y-e.z],h=f.next,l.x<.325&&(a=!0)):this.gameManager.Util.posInBox(n,new u(i.x,i.z),this.curBox.size,this.curBox.shape)?(r=[n.x-i.x,n.y-i.z],h=f.current):(h=f.dead,r=[n.x-e.x,n.y-e.z]),this.jumpResult.offset=r,this.jumpResult.status=h,this.jumpResult.perfect=a,this.onPowerUp()}else _("队友此次跳跃的结果",t),this.jumpResult.distance=t.distance,this.jumpResult.offset=t.pos,this.jumpResult.status=t.status,this.jumpResult.time=t.time,this.jumpResult.perfect=t.perfect}},{key:"action_power",value:function(t){if(this._stat_power){if(this.jumpResult.time<this.max_time){this.jumpResult.time+=t;var e=new o;this.node.getPosition(e),e.y=this.originPosY-this.jumpResult.time/this.max_time*.776,this.node.setPosition(e);var i=new o;if(this.modelHead.getPosition(i),i.y=this.modelHeadPos.y-this.jumpResult.time/this.max_time*.572,this.modelHead.setPosition(i),this.modelTire){var s=new o;this.modelTire.getPosition(s),s.y=this.jumpResult.time/this.max_time*-.572,this.modelTire.setPosition(s)}var n=new o;this.curBox.node.getScale(n),n.y=1-this.jumpResult.time/this.max_time*.5,this.curBox.node.setScale(n),this.modelBody.setScale(n)}if(this.AI&&this.AI_power&&!this.AI_jump&&this.nextBox){var r=this.funnction_jump(this.jumpResult.time),a=new o,h=new o,l=new u;this.getFace(l),l.normalize(),l.multiplyScalar(r),this.node.getPosition(a),this.nextBox.node.getPosition(h),l.x+=a.x,l.y+=a.z;var m=new u(l.x,l.y),p=new u(h.x,h.z);if(this.gameManager.Util.posInBox(m,p,w.center,this.nextBox.shape)||this.jumpResult.time>=this.max_time){_("设置power","AI松开蓄力"),this._stat_power=!1,this.curBox.node.setScale(new o(1,1,1)),this.modelBody.setScale(new o(1,1,1)),this.modelHead.setPosition(this.modelHeadPos),this.modelTire&&this.modelTire.setPosition(new o(0,0,0));var d=new o;this.node.getPosition(d),d.y=this.originPosY,this.node.setPosition(d),this.AI_jump=!0,this.AI_power=!1,this.start_jump()}}}}},{key:"action_jump",value:function(t){if(this._stat_jump){this._jump_time+=t;var e=0,i=0,s=0,r=!1;if(this._jump_time<this.jumpDuration){var a=-4*this.jumpHeight/(this.jumpDuration*this.jumpDuration),u=this.jumpDuration/2,h=this.jumpHeight;e=a*(this._jump_time-u)*(this._jump_time-u)+h+this.originPosY,i=t/this.jumpDuration*this.jumpResult.distance,s=this._jump_time/this.jumpDuration*360}else e=this.originPosY,s=0,this._stat_jump=!1,r=!0;var l=new o;this.node.getPosition(l);var m=this.gameManager.Util.getPosWithVec(l,this._face,i);m.y=e,n.rotateAround(M,this.curRotation,this._axis,3.1415*s/180),this.node.setPosition(m),this.node.setRotation(M),r&&(this.AI_jump=!1,this.action_jump_end())}}},{key:"action_jump_end",value:function(){var t=new o;if(this.node.getPosition(t),this.jumpResult.status==f.current){_("跳跃结果","原地跳"),_("修正量",this.jumpResult.offset);var e=new o;this.curBox.node.getPosition(e),e.x+=this.jumpResult.offset[0],e.z+=this.jumpResult.offset[1],e.y=this.originPosY,_("修正后的坐标",e),this.node.setPosition(e),this.node.getPosition(this.curPostion),this.onJumpComplete(!1,this.is_controler)}else if(this.jumpResult.status==f.next){_("跳跃结果","跳到下一块"),_("修正量:",this.jumpResult.offset);var i=new o;this.nextBox.node.getPosition(i),i.x+=this.jumpResult.offset[0],i.z+=this.jumpResult.offset[1],i.y=this.originPosY,_("修正后的坐标",i),this.node.setPosition(i),this.node.getPosition(this.curPostion),this.onJumpComplete(!0,this.is_controler)}else if(this.jumpResult.status==f.dead){_("跳跃结果","跳跃失败");var s=new o;this.nextBox.node.getPosition(s),s.x+=this.jumpResult.offset[0],s.z+=this.jumpResult.offset[1],s.y=this.originPosY,_("修正后的坐标",s),this.node.setPosition(s);var n=s;n.y=-.5,m(this.node).to(.6,{position:n},{onComplete:this.jumpDead.bind(this)}).start()}}},{key:"jumpDead",value:function(){this.onJumpDead(),this.node.setPosition(this.curPostion)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(_("重置角色数据",t),t){var e=new o;this.curBox.node.getPosition(e),e.x+=t.pos[0],e.z+=t.pos[1],e.y=this.originPosY,this.node.setPosition(e);var i=new o;this.node.getPosition(i),_("角色重置后的位置",e,i),this.modelTire&&this.modelTire.setPosition(new o(0,0,0)),this.modelHead&&this.modelHead.setPosition(this.modelHeadPos),this.modelBody&&this.modelBody.setScale(new o(1,1,1))}else this.node.setPosition(this.curPostion);this.node.setRotation(this.originRotation),this.node.getPosition(this.curPostion),_("设置power","reset"),this._stat_power=!1,this._stat_jump=!1,this.AI_power=!1,this.AI_jump=!1,this.curBox.node.setScale(new o(1,1,1))}},{key:"update",value:function(t){this.isRunning&&(this.AI&&this.control&&(0!=this._stat_power||0!=this._stat_jump||this.AI_jump||this.AI_power||(this.onPowerDown(),this.AI_power=!0,this._stat_power=!0,this.jumpResult.time=0,this._control=!1)),this.action_power(t),this.action_jump(t))}},{key:"setFace",value:function(){var t=this;if(this.nextBox){var e=m(this.node),i=new n;this.node.getRotation(i);var s=this.gameManager.Util.getRotaionQuat(this.node,this.nextBox.node),o=new n;e.to(.2,{},{onUpdate:function(e,n){o.set(i).slerp(s,n),t.node.setRotation(o)}}),e.start()}}},{key:"getFace",value:function(t){new u;var e=new o,i=new o;this.node.getPosition(e),this.nextBox.node.getPosition(i),t.set(i.x-e.x,i.z-e.z)}},{key:"setModel",value:(s=b(regeneratorRuntime.mark((function t(e){var i,s,o,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=1===t.t0?3:2===t.t0?5:3===t.t0?7:4===t.t0?9:11;break;case 3:return i="red_1",t.abrupt("break",12);case 5:return i="red_2",t.abrupt("break",12);case 7:return i="blue_1",t.abrupt("break",12);case 9:return i="blue_2",t.abrupt("break",12);case 11:return t.abrupt("return",!1);case 12:return(s=this.node.getChildByName("Node"))&&this.node.removeChild(s),o="Model/qizi/"+i+"/Node",new Promise((function(t){d.loadRes(o,r,(function(e,i){var s=c(i);s.setParent(n.node),n.modelHead=s.getChildByName("head"),n.modelBody=s.getChildByName("body"),n.modelHead.getPosition(n.modelHeadPos),t(s)}))})),t.abrupt("return",!0);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"setTire",value:(i=b(regeneratorRuntime.mark((function t(e){var i,s,o,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=1===t.t0?3:5;break;case 3:return i="vip",t.abrupt("break",6);case 5:return t.abrupt("return",!1);case 6:return(s=this.node.getChildByName("Tire").getChildByName("Node"))&&this.node.getChildByName("Tire").removeChild(s),o="Model/Tire/"+i+"/Node",new Promise((function(t){d.loadRes(o,r,(function(e,i){var s=c(i);s.setParent(n.node.getChildByName("Tire")),n.modelTire=s,t(s)}))})),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"control",set:function(t){_("设置Player控制:",t),this._control=t,this.is_controler=t},get:function(){return this._control}},{key:"isRunning",set:function(t){this._isRunning=t},get:function(){return this._isRunning}}]),e}(p)).prototype,"playerPrfb",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=g(I.prototype,"jumpHeight",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),Y=g(I.prototype,"jumpDuration",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.7}}),F=g(I.prototype,"max_time",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),C=I))||C)),i._RF.pop()}}}));

System.register("chunks:///Util.js",["cc","./Const.js","./_virtual/_rollupPluginBabelHelpers.js"],(function(e,t){var r,n,a,o,s,i,u,c,l,g,m,p,v,f,h,y,d;return{setters:[function(e){r=e.cclegacy,n=e._decorator,a=e.Vec2,o=e.Rect,s=e.Vec3,i=e.Quat,u=e.Texture2D,c=e.ImageAsset,l=e.SpriteFrame,g=e.Sprite,m=e.loader},function(e){p=e.BoxShape,v=e.log,f=e.BoxSize},function(e){h=e.createClass,y=e.classCallCheck,d=e.asyncToGenerator}],execute:function(){r._RF.push({},"ce5d5zghdhNhJ8k219NUh+H","Util",void 0),n.ccclass,n.property,e("Util",function(){function e(t){y(this,e),this.SDK=t}var t,r;return h(e,[{key:"posInBox",value:function(e,t,r,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=f[r]/2;if(s&&(s.x=a.distance(e,t)),n==p.cube){var u=new o,c=new a(t.x-i,t.y+i),l=new a(t.x+i,t.y-i);return o.fromMinMax(u,c,l),u.contains(e)}return a.distance(e,t)<i}},{key:"getJumpAxis",value:function(e,t){var r=new s,n=new s,a=new s(0,0,0);e.getPosition(r),t.getPosition(n);var o=r.z-n.z,i=n.x-r.x;return a.set(-o,0,-i),a.normalize(),a}},{key:"getRotaionQuat",value:function(e,t){var r=new s,n=new s,o=new a(0,1),u=new a,c=new i;c.lengthSqr(),e.getPosition(r),t.getPosition(n),u.set(n.x-r.x,n.z-r.z);var l=u.signAngle(o);return l<0&&(l+=6.2831852),i.rotateY(c,c,l),c}},{key:"getPosWithVec",value:function(e,t,r){return t.normalize(),t.multiplyScalar(r),new s(e.x+t.x,0,e.z+t.y)}},{key:"getScore",value:function(e){if(e<=0)return 1;if(1==e)return 2;if(2==e)return 4;var t=4+4*(e-2);return t>32&&(t=32),t}},{key:"isControler",value:function(e,t){for(var r=!1,n=0;n<e.length;n++){if(e[n].id==t.id){r=!0;break}}return r}},{key:"getPara",value:function(e,t){var r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=t.substr(1).match(r);return null!=n?decodeURI(n[2]):null}},{key:"teammaterIsLover",value:(r=d(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.SDK.gameManager.teammaterIsLover){e.next=2;break}return e.abrupt("return",this.SDK.gameManager.teammaterIsLover);case 2:return e.next=4,this.SDK.getTeammate();case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:return r=JSON.parse(t.customProfile),this.SDK.gameManager.teammaterIsLover=r.lover_id==this.SDK.gameManager.PlayerData.lover_id,e.abrupt("return",this.SDK.gameManager.teammaterIsLover);case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"enemyIsLover",value:(t=d(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.SDK.gameManager.enemyIsLover){e.next=2;break}return e.abrupt("return",this.SDK.gameManager.enemyIsLover);case 2:return e.next=4,this.SDK.getRoomInfo();case 4:return t=e.sent,e.next=7,this.SDK.getPlayerInfo();case 7:if(r=e.sent,t){e.next=10;break}return e.abrupt("return",!1);case 10:o=t.playerList,s=0;case 12:if(!(s<o.length)){e.next=24;break}if((i=o[s]).teamId==r.teamId){e.next=21;break}if(!n){e.next=20;break}return a=JSON.parse(i.customProfile),e.abrupt("break",24);case 20:n=JSON.parse(i.customProfile);case 21:s++,e.next=12;break;case 24:return this.SDK.gameManager.enemyIsLover=n.lover_id==a.lover_id,e.abrupt("return",this.SDK.gameManager.enemyIsLover);case 26:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"loadRemoteImg",value:function(e,t){v("图片数据",e);var r=new Image;r.crossOrigin="Anonymous",r.src=e,r.onload=function(){v("img onload");var e=new u;e.image=new c(r);var n=new l;n.texture=e,t.getComponent(g).spriteFrame=n}}},{key:"loadImg",value:function(e,t){v("path: ",e),v("spriteNode: ",t),m.loadRes(e,l,(function(e,r){if(e)throw e;t.getComponent(g).spriteFrame=r}))}},{key:"http",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new Promise((function(o,s){v("发送http",e);var i=new XMLHttpRequest;i.open(t,e,!0),n&&(i.responseType="blob"),i.onreadystatechange=function(){if(v("request",i),4==i.readyState&&i.status>=200&&i.status<300){var e=i.responseText;o(JSON.parse(e))}},i.setRequestHeader("Content-type","application/json"),i.setRequestHeader("Access-Control-Allow-Origin","*"),a&&i.setRequestHeader("access_token",a),i.send(r)}))}}]),e}()),r._RF.pop()}}}));

System.register("chunks:///SDK.js",["cc","./Config.js","./Const.js","./_virtual/_rollupPluginBabelHelpers.js"],(function(e,r){var t,n,a,u,o,i,s,c,p;return{setters:[function(e){t=e.cclegacy},function(e){n=e.config},function(e){a=e.log,u=e.ClientDataType,o=e.PlayerState,i=e.RoomDataType},function(e){s=e.createClass,c=e.classCallCheck,p=e.asyncToGenerator}],execute:function(){t._RF.push({},"33e872liaNCrpH3cX9cDkX4","SDK",void 0),e("SDK",function(){function e(){c(this,e),this.Listener=MGOBE.Listener,this.Room=MGOBE.Room,this.curRoom=null,this.curGroup=null,this.curBoard=null,this.curDialog=null,this.gameManager=null,this.errorCode=MGOBE.ErrCode,this.curRoom=new MGOBE.Room,this.curGroup=new MGOBE.Group}var r,t,f,m,l,h,y,g,d,v,k,R,P,G,x,b,w,I,M,E,S,O,C,L;return s(e,[{key:"init",value:function(e,r){var t=this;return new Promise((function(u){var o={openId:e,gameId:n.gameId,secretKey:n.secretKey};t.Listener.init(o,n.initConfig,(function(e){e.code===MGOBE.ErrCode.EC_OK?(t.Listener.add(t.curRoom),t.gameManager=r,a("测试环境初始化成功"),u(!0)):(a("测试环境初始化失败",e.code),u(!1))}))}))}},{key:"matchingSingle",value:(L=p(regeneratorRuntime.mark((function e(){var r,t,a,u,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return r=e.sent,t={name:r.name,customPlayerStatus:r.stateRoom,customProfile:r.profile,matchAttributes:[]},a={playerInfo:t,matchCode:n.matchCode},u=new Promise((function(e){o.curRoom.matchPlayers(a,(function(r){e(r.code)}))})),e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"matchingLover",value:(C=p(regeneratorRuntime.mark((function e(){var r,t,u,o,i,s,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:if(e.sent){e.next=6;break}return a("没有处于足够人数的队组中"),e.abrupt("return");case 6:return e.next=8,this.getPlayerInfo();case 8:return r=e.sent,e.next=11,this.getLoverInfo();case 11:if(t=e.sent){e.next=15;break}return a("情侣未在队组中,进入匹配失败"),e.abrupt("return");case 15:return u={id:r.id,name:r.name,customProfile:r.profile,customPlayerStatus:r.stateGroup,matchAttributes:[]},o={id:t.id,name:t.name,customProfile:t.profile,customPlayerStatus:t.stateGroup,matchAttributes:[]},i={playerInfoList:[u,o],matchCode:n.matchCode},s=new Promise((function(e){c.curRoom.matchGroup(i,(function(r){e(r.code)}))})),e.abrupt("return",s);case 20:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"cancelMatchinig",value:(O=p(regeneratorRuntime.mark((function e(){var r,t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={matchType:MGOBE.ENUM.MatchType.PLAYER_COMPLEX},t=new Promise((function(e){n.curRoom.cancelPlayerMatch(r,(function(r){e(r.code)}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))),function(){return O.apply(this,arguments)})},{key:"getRoomInfo",value:(S=p(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){MGOBE.Room.getMyRoom((function(r){e(r.data.roomInfo)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)})},{key:"leaveRoom",value:(E=p(regeneratorRuntime.mark((function e(){var r,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){t.curRoom.leaveRoom({},(function(r){r.code==t.errorCode.EC_OK&&t.curRoom.initRoom(),e(r.code)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return E.apply(this,arguments)})},{key:"getTeamId",value:(M=p(regeneratorRuntime.mark((function e(){var r,t,n,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gameManager.serverTeam){e.next=4;break}return e.abrupt("return",this.gameManager.serverTeam.id);case 4:return e.next=6,this.getRoomInfo();case 6:return r=e.sent,t=r.playerList,e.next=10,this.getPlayerInfo();case 10:n=e.sent,a=0;case 12:if(!(a<t.length)){e.next=19;break}if((u=t[a]).id!=n.id){e.next=16;break}return e.abrupt("return",u.teamId);case 16:a++,e.next=12;break;case 19:return e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"sendToServer",value:(I=p(regeneratorRuntime.mark((function e(r){var t,n,o,i,s,c,p=this,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>1&&void 0!==f[1]?f[1]:null,n=t,r!=u.ChangeControler){e.next=10;break}return e.next=5,this.getPlayerInfo();case 5:return o=e.sent,e.next=8,this.getTeamId();case 8:i=e.sent,n={teamId:i,playerId:o.id};case 10:return s={type:r,data:n},r!=u.Heart&&a("发送数据到实时服务器:",s),c=new Promise((function(e){var r={data:s};p.curRoom.sendToGameSvr(r,(function(r){e(r.code)}))})),e.abrupt("return",c);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"sendToRoom",value:(w=p(regeneratorRuntime.mark((function e(r,t){var n,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(){var e=p(regeneratorRuntime.mark((function e(n){var o,s,c,p,f,m,l,h,y,g,d,v,k,R,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={type:r,data:t},s=[],c=MGOBE.ENUM.RecvType.ROOM_SOME,r!=i.Power&&r!=i.PowerEnd&&r!=i.SyncComplete&&r!=i.MatchedJoinGroup){e.next=10;break}return e.next=6,u.getTeammate();case 6:(p=e.sent)&&s.push(p.id),e.next=29;break;case 10:if(r!=i.EnemyPowerEnd){e.next=23;break}return e.next=13,u.getRoomInfo();case 13:if(!(f=e.sent)){e.next=21;break}return e.next=17,u.getPlayerInfo();case 17:for(m=e.sent,l=f.playerList,h=m.teamId,y=0;y<l.length;y++)(g=l[y]).teamId!=h&&s.push(g.id);case 21:e.next=29;break;case 23:if(r!=i.emoji){e.next=29;break}return e.next=26,u.getRoomInfo();case 26:for(d=e.sent,v=d.playerList,k=0;k<v.length;k++)R=v[k],s.push(R.id);case 29:P={recvType:c,recvPlayerList:s,msg:JSON.stringify(o)},a("发送房间消息数据给用户:",P),u.curRoom.sendToClient(P,(function(e){n(e.code)}));case 32:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)}))),function(e,r){return w.apply(this,arguments)})},{key:"getTeammate",value:(b=p(regeneratorRuntime.mark((function e(){var r,t,n,a,u,o,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return r=e.sent,e.next=5,this.getRoomInfo();case 5:if(t=e.sent,n=!1,a=null,t){e.next=15;break}return e.next=11,this.getGroupInfo();case 11:(u=e.sent)?(n=!0,a=u.groupPlayerList):a=null,e.next=16;break;case 15:a=t.playerList;case 16:if(a){e.next=18;break}return e.abrupt("return",null);case 18:o={id:"",name:"",teamId:"",customPlayerStatus:0,customProfile:"",commonNetworkState:0,relayNetworkState:0,isRobot:!1,matchAttributes:[]},i=null,s=0;case 21:if(!(s<a.length)){e.next=41;break}if(c=a[s],!n){e.next=34;break}if(c.id==r.id){e.next=32;break}return(o=c).id=c.id,o.customPlayerStatus=c.customGroupPlayerStatus,o.commonNetworkState=c.commonGroupNetworkState,o.customProfile=c.customGroupPlayerProfile,i=o,e.abrupt("break",41);case 32:e.next=38;break;case 34:if(c.teamId!=r.teamId||c.id==r.id){e.next=38;break}return i=o=c,e.abrupt("break",41);case 38:s++,e.next=21;break;case 41:return e.abrupt("return",i);case 42:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"inRunningRoom",value:(x=p(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRoomInfo();case 2:if(!(r=e.sent)){e.next=7;break}if(a("房间状态:",r),"ing"!=r.customProperties){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"reconnect",value:(G=p(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRoomInfo();case 2:r=e.sent,this.curRoom.initRoom(r),this.Listener.add(this.curRoom);case 5:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"getPlayerIndex",value:(P=p(regeneratorRuntime.mark((function e(r){var t,n,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRoomInfo();case 2:if(n=e.sent,a=n.playerList,r){e.next=10;break}return e.next=7,this.getPlayerInfo();case 7:t=e.sent,e.next=11;break;case 10:a.map((function(e){e.id===r&&(t=e)}));case 11:return u=1,a.filter((function(e,r){return e.teamId===t.teamId})).map((function(e,r){e.id===t.id&&(u=r+1)})),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"createGroup",value:(R=p(regeneratorRuntime.mark((function e(){var r,t,n,u,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return r=e.sent,t={name:r.name,customGroupPlayerStatus:r.stateGroup,customGroupPlayerProfile:r.profile},n={groupName:"",groupType:MGOBE.ENUM.GroupType.GROUP_LIMITED,maxPlayers:2,isForbidJoin:!1,isPersistent:!1,customProperties:"",playerInfo:t},u=new Promise((function(e){o.curGroup.createGroup(n,(function(r){0===r.code&&(o.Listener.add(o.curGroup),o.curGroup.initGroup(r.data.groupInfo),a("队组创建成功",r.data.groupInfo)),e(r.code)}))})),e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"joinGroup",value:(k=p(regeneratorRuntime.mark((function e(r){var t,n,a,u,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return t=e.sent,n={name:t.name,customGroupPlayerStatus:o.NotReady,customGroupPlayerProfile:t.profile},a={playerInfo:n},this.curGroup.initGroup({id:r}),u=new Promise((function(e){i.curGroup.joinGroup(a,(function(r){0===r.code&&(i.Listener.add(i.curGroup),i.curGroup.initGroup(r.data.groupInfo)),e(r.code)}))})),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"leaveGroup",value:(v=p(regeneratorRuntime.mark((function e(){var r,t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:if(!(r=e.sent)){e.next=7;break}this.curGroup.initGroup(r),e.next=8;break;case 7:return e.abrupt("return",this.errorCode.EC_OK);case 8:return t=new Promise((function(e){n.curGroup.leaveGroup({},(function(r){0===r.code&&n.curGroup.initGroup(),e(r.code)}))})),e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"getGroupInfo",value:(d=p(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){MGOBE.Group.getMyGroups((function(r){if(r.code===MGOBE.ErrCode.EC_OK&&r.data.groupInfoList.length>0)for(var t=0;t<r.data.groupInfoList.length;t++){var n=r.data.groupInfoList[t];if(n.type===MGOBE.ENUM.GroupType.GROUP_LIMITED){e(n);break}}else e(null)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"setGroupPlayerStatus",value:(g=p(regeneratorRuntime.mark((function e(r){var t,n,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={customGroupPlayerStatus:r},n=new Promise((function(e){u.curGroup.changeCustomGroupPlayerStatus(t,(function(r){a("修改用户队组状态",r),e(r)}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"removePlayerInGroup",value:(y=p(regeneratorRuntime.mark((function e(r){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={removePlayerId:r},n=new Promise((function(e){a.curGroup.removeGroupPlayer(t,(function(r){e(r.code)}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"dismissGroup",value:(h=p(regeneratorRuntime.mark((function e(){var r,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){t.curGroup.dismissGroup({},(function(r){e(r.code)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"sendToGroup",value:(l=p(regeneratorRuntime.mark((function e(r,t){var n,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={type:r,content:t},new Promise(function(){var e=p(regeneratorRuntime.mark((function e(r){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getLoverInfo();case 2:(t=e.sent)?(o={recvType:MGOBE.ENUM.GroupRecvType.GROUP_SOME,recvPlayerList:[t.id],msg:JSON.stringify(n)},u.curGroup.sendToGroupClient(o,(function(e){a("消息发送完成:",e),r(!0)}))):r(!1);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),function(e,r){return l.apply(this,arguments)})},{key:"isCaptain",value:(m=p(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:return r=e.sent,e.next=5,this.getPlayerInfo();case 5:return t=e.sent,e.abrupt("return",r.owner==t.id);case 7:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"setPlayerStatus",value:(f=p(regeneratorRuntime.mark((function e(r){var t,n,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={customPlayerStatus:r},n=new Promise((function(e){u.curRoom.changeCustomPlayerStatus(t,(function(r){a("修改用户房间状态",r),e(r)}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"getPlayerInfo",value:(t=p(regeneratorRuntime.mark((function e(){var r,t,n,a,u,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:r=e.sent,t=[],r&&(t=r.groupPlayerList),n=o.NotReady,a=0;case 7:if(!(a<t.length)){e.next=15;break}if((u=t[a]).id!==MGOBE.Player.id){e.next=12;break}return n=u.customGroupPlayerStatus,e.abrupt("break",15);case 12:a++,e.next=7;break;case 15:return i={id:MGOBE.Player.id,name:this.gameManager.PlayerData.nickname,openId:MGOBE.Player.openId,netState:MGOBE.Player.commonNetworkState,stateRoom:MGOBE.Player.customPlayerStatus,stateGroup:n,teamId:MGOBE.Player.teamId,profile:null!=MGOBE.Player.customProfile?MGOBE.Player.customProfile:JSON.stringify(this.gameManager.PlayerData)},e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getLoverInfo",value:(r=p(regeneratorRuntime.mark((function e(){var r,t,n,u,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:if(r=e.sent,t=null,r){e.next=7;break}return a("暂未建立队组,无法获得另一半信息"),e.abrupt("return");case 7:n=r.groupPlayerList,u=0;case 9:if(!(u<n.length)){e.next=17;break}if((o=n[u]).id==MGOBE.Player.id){e.next=14;break}return t=o,e.abrupt("break",17);case 14:u++,e.next=9;break;case 17:if(t){e.next=20;break}return a("另一半不在队组中"),e.abrupt("return");case 20:return i={id:t.id,name:null!=t.name?t.name:t.id,netState:t.commonGroupNetworkState,stateGroup:t.customGroupPlayerStatus,profile:t.customGroupPlayerProfile},e.abrupt("return",i);case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),e}()),t._RF.pop()}}}));

System.register("chunks:///UI/Dialog/Dialog.js",["cc","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js"],(function(e,t){var n,i,s,o,r,a,l,u,h,c,d,g,p;return{setters:[function(e){n=e.cclegacy,i=e.tween,s=e.Vec3,o=e.loader,r=e.Prefab,a=e.instantiate,l=e.Label,u=e.SystemEventType},function(e){h=e.log,c=e.DialogButtonType},function(e){d=e.createClass,g=e.classCallCheck,p=e.asyncToGenerator}],execute:function(){n._RF.push({},"15867PII/lA6aXbZL4Ddkcx","Dialog",void 0),e("Dialog",function(){function e(t,n,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"确认",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"取消";g(this,e),this.scene=null,this.node=null,this.result=null,this.SDK=null,this.text=null,this.buttonType=null,this.yesTip=null,this.noTip=null,this.dead=!1,this.scene=t,this.SDK=n,this.text=i,this.buttonType=s,this.yesTip=o,this.noTip=r}var t,n;return d(e,[{key:"InitBoard",value:(n=p(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h("弹窗预制件实例化:"),t=new Promise((function(e){o.loadRes("Prefab/Dialog/Dialog",r,(function(t,i){t?(h("弹框实例化失败",t),e(!1)):(h("弹框实例化成功"),n.node=a(i),n.scene.getChildByName("UI").addChild(n.node),n.node.setSiblingIndex(100),e(!0))}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){if(!this.dead){if(!this.node)return void(this.SDK=null);this.dead=!0,this.scene=null,i(this.node).to(.3,{scale:new s(0,0,0)},{onComplete:function(){this.SDK.curDialog=null,this.SDK=null,this.node.destroy(),this.node=null}.bind(this)}).start()}}},{key:"show",value:(t=p(regeneratorRuntime.mark((function e(t,n){var o,r,a,h,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=d.length>2&&void 0!==d[2]?d[2]:null,null!=this.SDK.curDialog){e.next=20;break}return e.next=4,this.InitBoard();case 4:if(e.sent){e.next=8;break}return this.destroy(),e.abrupt("return");case 8:this.SDK.curDialog=this,r=this.node.getChildByName("background").getChildByName("yes"),a=this.node.getChildByName("background").getChildByName("no"),this.node.getChildByName("background").getChildByName("content").getComponent(l).string=this.text,r.getChildByName("Label").getComponent(l).string=this.yesTip,a.getChildByName("Label").getComponent(l).string=this.noTip,this.buttonType==c.single&&(a.active=!1,h=new s,r.getPosition(h),h.x=0,r.setPosition(h)),this.node.setScale(new s(0,0,0)),this.node.active=!0,i(this.node).to(.3,{scale:new s(1,1,1)}).start(),r.on(u.TOUCH_START,n,t),o&&a.on(u.TOUCH_START,o,t);case 20:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}()),n._RF.pop()}}}));

System.register("chunks:///UI/Board/BaseBoard.js",["cc","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js","../Dialog/Dialog.js"],(function(e,t){var n,r,a,o,i,u,s,l,c,h,d;return{setters:[function(e){n=e.cclegacy,r=e._decorator,a=e.loader,o=e.Prefab,i=e.instantiate},function(e){u=e.log,s=e.DialogButtonType},function(e){l=e.createClass,c=e.classCallCheck,h=e.asyncToGenerator},function(e){d=e.Dialog}],execute:function(){n._RF.push({},"72680Q0ztVKyaWXTajENF2V","BaseBoard",void 0),r.ccclass,r.property,e("BaseBoard",function(){function e(t,n){c(this,e),this.board=null,this.SDK=null,this.scene=null,this.name=null,this.uiControl=null,this.dead=!1,this.sleep=function(e){return new Promise((function(t){return setTimeout(t,e)}))},u("创建UI对象:",this.name),this.SDK=n,this.scene=t}var t,n,r;return l(e,[{key:"Init",value:(r=h(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u("初始化界面:",this.name),!this.board){e.next=5;break}return this.InitEvent(),e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"destroy",value:function(){u("销毁界面:",this.name),this.board&&(this.board.active=!1),this.dead=!0}},{key:"setListener",value:function(){u("绑定监听:",this.name)}},{key:"InitBoard",value:(n=h(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("界面预制件实例化:",this.name),t=new Promise((function(e){a.loadRes("Prefab/Board/"+n.name,o,(function(t,r){t?(u("界面预制件实例化失败",t),n.board=null,e(!1)):(n.board=i(r),n.board.active=!1,n.scene.getChildByName("UI").addChild(n.board),n.board.setSiblingIndex(0),e(!0))}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"InitEvent",value:function(){u("初始化UI事件:",this.name)}},{key:"initData",value:function(){u("重置界面基础数据"),this.dead=!1,this.uiControl&&this.uiControl.initData()}},{key:"ChangeBoard",value:(t=h(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.SDK.curBoard)&&"ResultBoard"==n.name&&(this.SDK.gameManager.teammaterIsLover=void 0,this.SDK.gameManager.enemyIsLover=void 0),n!=t&&(n||(n=t)),u("界面切换",n.name,"--\x3e",t.name),this.SDK.curBoard=t,t.dead=!1,e.next=8,t.Init();case 8:if(!e.sent){e.next=32;break}if(this.SDK.Room.onCancelMatch=null,this.SDK.Room.onMatch=null,this.SDK.curRoom.onChangePlayerNetworkState=null,this.SDK.curRoom.onLeaveRoom=null,this.SDK.curRoom.onRecvFromGameSvr=null,this.SDK.curRoom.onRecvFromClient=null,this.SDK.curGroup.onChangeCustomGroupPlayerStatus=null,this.SDK.curGroup.onChangeGroupPlayerNetworkState=null,this.SDK.curGroup.onRecvFromGroupClient=null,this.SDK.curGroup.onJoinGroup=null,this.SDK.curGroup.onLeaveGroup=null,this.SDK.curGroup.onDismissGroup=null,t.setListener(),null==t.uiControl){e.next=26;break}return e.next=26,t.uiControl.initUI(t.board);case 26:t.initData(),t.scene.getChildByName("UI").getChildByName("loading").active=!1,t.board.active=!0,n!=t&&n.destroy(),e.next=39;break;case 32:return u("销毁新界面"),e.next=35,t.destroy();case 35:return u("弹框"),r=new d(n.scene,this.SDK,"网络出现问题,无法正常游戏",s.single,"确定"),e.next=39,r.show(this,(function(){this.SDK.curDialog.destroy()}));case 39:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}()),n._RF.pop()}}}));

System.register("chunks:///UI/Board/WaitLoverBoard.js",["cc","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js","./BaseBoard.js"],(function(e,t){var a,r,n,i,o,s,u,h,l,c,d,g,y,m,p,C,B,N;return{setters:[function(e){a=e.cclegacy,r=e.SystemEventType,n=e.Label},function(e){i=e.log,o=e.NetState,s=e.GroupMessageType,u=e.GroupSysMessageType,h=e.PlayerState,l=e.LabelColor},function(e){c=e.inherits,d=e.createClass,g=e.classCallCheck,y=e.possibleConstructorReturn,m=e.getPrototypeOf,p=e.get,C=e.asyncToGenerator},function(e){B=e.BaseBoard}],execute:function(){a._RF.push({},"638a0cfbatPTK9EkM3XiINe","WaitLoverBoard",void 0),N=function(){function e(t,a){g(this,e),this.board=null,this.SDK=null,this.team1=null,this.team2=null,this.board=t,this.SDK=a}var t,a;return d(e,[{key:"initUI",value:(a=C(regeneratorRuntime.mark((function e(t){var a,r,o,s,u,c,d,g,y,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.board=t,e.next=3,this.SDK.getPlayerInfo();case 3:return a=e.sent,e.next=6,this.SDK.getGroupInfo();case 6:if(r=e.sent,o=null,s=null,u=this.board.getChildByName("team1"),c=u.getChildByName("user1"),d=u.getChildByName("user2"),c.getChildByName("nickName").getComponent(n).string=a.name,this.SDK.gameManager.Util.loadRemoteImg(JSON.parse(a.profile).avatar_url,c.getChildByName("avatarBg").getChildByName("avatar")),c.getChildByName("state").getComponent(n).string=a.stateGroup==h.NotReady?"未准备":"已准备",c.getChildByName("state").getComponent(n).color=a.stateGroup==h.NotReady?l.NotReady:l.Ready,this.board.getChildByName("ready").getChildByName("Button-ready").getChildByName("Label").getComponent(n).string=a.stateGroup==h.NotReady?"准备":"取消准备",!r){e.next=31;break}s=r.owner,g=r.groupPlayerList,y=0;case 21:if(!(y<g.length)){e.next=29;break}if((m=g[y]).id==a.id){e.next=26;break}return o=m,e.abrupt("break",29);case 26:y++,e.next=21;break;case 29:i("加入的队组内其他玩家:",o),null!=o?(u.getChildByName("wait").active=!1,d.getChildByName("nickName").getComponent(n).string=o.name,d.getChildByName("state").getComponent(n).string=o.customGroupPlayerStatus==h.NotReady?"未准备":"已准备",d.getChildByName("state").getComponent(n).color=o.customGroupPlayerStatus==h.NotReady?l.NotReady:l.Ready,this.SDK.gameManager.Util.loadRemoteImg(JSON.parse(o.customGroupPlayerProfile).avatar_url,d.getChildByName("avatarBg").getChildByName("avatar")),d.active=!0):(u.getChildByName("wait").active=!0,d.active=!1);case 31:i("capId: ",s,a.id),s==a.id?(this.board.getChildByName("ready").getChildByName("Button-match").active=!0,this.board.getChildByName("ready").getChildByName("Button-ready").active=!1,c.getChildByName("state").getComponent(n).string="队长",d.getChildByName("state").getComponent(n).string="未准备",d.getChildByName("state").getComponent(n).color=l.NotReady,c.getChildByName("state").getComponent(n).color=l.Captain):(this.board.getChildByName("ready").getChildByName("Button-match").active=!1,this.board.getChildByName("ready").getChildByName("Button-ready").active=!0,d.getChildByName("state").getComponent(n).string="队长",c.getChildByName("state").getComponent(n).string="未准备",c.getChildByName("state").getComponent(n).color=l.NotReady,d.getChildByName("state").getComponent(n).color=l.Captain);case 33:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"playerReady",value:(t=C(regeneratorRuntime.mark((function e(t,a){var r,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getPlayerInfo();case 2:return r=e.sent,e.next=5,this.SDK.getGroupInfo();case 5:o=e.sent,s=null,i("UI:修改玩家准备状态:",t,a),s=t==r.id?this.board.getChildByName("team1").getChildByName("user1"):this.board.getChildByName("team1").getChildByName("user2"),t!=o.owner&&(u=a===h.NotReady?{tip:"未准备",color:l.NotReady}:{tip:"已准备",color:l.Ready},s.getChildByName("state").getComponent(n).string=u.tip,s.getChildByName("state").getComponent(n).color=u.color);case 10:case"end":return e.stop()}}),e,this)}))),function(e,a){return t.apply(this,arguments)})},{key:"playerJoin",value:function(e,t){for(var a=null,r=0;r<t.length;r++){var o=t[r];if(o.id==e){a=o;break}}i("joinPlayerInfo: ",a);var s=a.customGroupPlayerProfile?JSON.parse(a.customGroupPlayerProfile):JSON.parse(a.profile);this.SDK.gameManager.Util.loadRemoteImg(s.avatar_url,this.board.getChildByName("team1").getChildByName("user2").getChildByName("avatarBg").getChildByName("avatar")),this.board.getChildByName("team1").getChildByName("wait").active=!1,this.board.getChildByName("team1").getChildByName("user2").active=!0,this.board.getChildByName("team1").getChildByName("user2").getChildByName("nickName").getComponent(n).string=a.name}},{key:"playerLeave",value:function(){this.board.getChildByName("team1").getChildByName("wait").active=!0,this.board.getChildByName("team1").getChildByName("user2").active=!1}}]),e}(),e("WaitLoverBoard",function(e){function t(e,a){var r;return g(this,t),(r=y(this,m(t).call(this,e,a))).uiControl=null,r.name="WaitLoverBoard",r.uiControl=new N(r.board,r.SDK),r}var a,l,B,f,v,S,k;return c(t,e),d(t,[{key:"setListener",value:function(){p(m(t.prototype),"setListener",this).call(this),this.SDK.curGroup.onChangeCustomGroupPlayerStatus=this.onChangeCustomGroupPlayerStatus.bind(this),this.SDK.curGroup.onChangeGroupPlayerNetworkState=this.onChangeGroupPlayerNetworkState.bind(this),this.SDK.curGroup.onRecvFromGroupClient=this.onRecvFromGroupClient.bind(this),this.SDK.curGroup.onJoinGroup=this.onJoinGroup.bind(this),this.SDK.curGroup.onLeaveGroup=this.onLeaveGroup.bind(this),this.SDK.curGroup.onDismissGroup=this.onDismissGroup.bind(this),this.SDK.gameManager.timerSingal&&(this.SDK.gameManager.timerSingal=null)}},{key:"onDismissGroup",value:(k=C(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("监听到队长解散了队组"),this.SDK.curGroup.initGroup(),a=this.SDK.gameManager.MainBoard,e.next=5,this.ChangeBoard(a);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"onChangeCustomGroupPlayerStatus",value:(S=C(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("玩家[",t.data.changePlayerId,"]准备状态有变化",t.data.customGroupPlayerStatus),e.next=3,this.uiControl.playerReady(t.data.changePlayerId,t.data.customGroupPlayerStatus);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"onChangeGroupPlayerNetworkState",value:(v=C(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("玩家[",t.data.changePlayerId,"]在线状态有变化",t.data.networkState),e.next=3,this.SDK.isCaptain();case 3:if(e.sent){e.next=15;break}if(t.data.networkState!=o.Offline){e.next=13;break}return e.next=8,this.SDK.leaveGroup();case 8:if(e.sent!=this.SDK.errorCode.EC_OK){e.next=13;break}return a=this.SDK.gameManager.MainBoard,e.next=13,this.ChangeBoard(a);case 13:e.next=19;break;case 15:return e.next=17,this.SDK.removePlayerInGroup(t.data.changePlayerId);case 17:0===e.sent?this.uiControl.playerLeave():i("踢出玩家失败:",t.data.changePlayerId);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"onRecvFromGroupClient",value:(f=C(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i("接收到来自另一半的消息:",t),(a=JSON.parse(t.data.msg)).type!=s.Sys){e.next=7;break}if(a.content!=u.Matching){e.next=7;break}return r=this.SDK.gameManager.MatchingBoard,e.next=7,this.ChangeBoard(r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"onJoinGroup",value:function(e){i("有玩家加入队组:",e.data.joinPlayerId);var t=e.data.joinPlayerId,a=e.data.groupInfo.groupPlayerList;this.uiControl.playerJoin(t,a)}},{key:"onLeaveGroup",value:function(e){i("有人离开队组",e.data.leavePlayerId),this.uiControl.playerLeave()}},{key:"InitEvent",value:function(){p(m(t.prototype),"InitEvent",this).call(this);var e=this.board.getChildByName("ready").getChildByName("Button-ready"),a=this.board.getChildByName("ready").getChildByName("Button-match"),n=this.board.getChildByName("Cancel").getChildByName("Button");e.on(r.TOUCH_START,this.clickReady,this),n.on(r.TOUCH_START,this.clickLeave,this),a.on(r.TOUCH_START,this.clickMatch,this)}},{key:"clickReady",value:(B=C(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getPlayerInfo();case 2:return t=e.sent,a=h.NotReady,r="准备",t.stateGroup===h.NotReady&&(a=h.Ready,r="取消准备"),e.next=8,this.SDK.setGroupPlayerStatus(a);case 8:e.sent,this.board.getChildByName("ready").getChildByName("Button-ready").getChildByName("Label").getComponent(n).string=r;case 10:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"clickLeave",value:(l=C(regeneratorRuntime.mark((function e(){var t,a,r,n,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getGroupInfo();case 2:return t=e.sent,e.next=5,this.SDK.getPlayerInfo();case 5:if(a=e.sent,!t){e.next=33;break}if(r=t.owner,a.id!=r){e.next=20;break}return e.next=11,this.SDK.dismissGroup();case 11:if(e.sent!==this.SDK.errorCode.EC_OK){e.next=18;break}return i("作为队长解散队组成功"),this.SDK.curGroup.initGroup(),n=this.SDK.gameManager.MainBoard,e.next=18,this.ChangeBoard(n);case 18:e.next=31;break;case 20:return e.next=22,this.SDK.leaveGroup();case 22:if((o=e.sent)!==this.SDK.errorCode.EC_OK&&o!=this.SDK.errorCode.EC_GROUP_NOT_EXIST){e.next=30;break}return i("离开队组成功",o),s=this.SDK.gameManager.MainBoard,e.next=28,this.ChangeBoard(s);case 28:e.next=31;break;case 30:i("离开队组失败",o);case 31:e.next=36;break;case 33:return u=this.SDK.gameManager.MainBoard,e.next=36,this.ChangeBoard(u);case 36:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"clickMatch",value:(a=C(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getLoverInfo();case 2:if(!(t=e.sent)){e.next=21;break}if(t.stateGroup!==h.Ready){e.next=20;break}return e.next=7,this.SDK.matchingLover();case 7:if((a=e.sent)!=this.SDK.errorCode.EC_OK){e.next=17;break}return i("进入匹配成功"),e.next=12,this.SDK.sendToGroup(s.Sys,u.Matching);case 12:return r=this.SDK.gameManager.MatchingBoard,e.next=15,this.ChangeBoard(r);case 15:e.next=18;break;case 17:i("进入匹配失败-",a);case 18:e.next=21;break;case 20:i("另一半未准备好");case 21:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}]),t}(B)),a._RF.pop()}}}));

System.register("chunks:///OtherPlayer.js",["cc","./Const.js","./_virtual/_rollupPluginBabelHelpers.js"],(function(t,i){var e,s,n,o,u,a,r,h,p,c,l,m,_,d,f,g,j,x,v,y,R,P,w,B,k,D,b,z,C,F;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(t){e=t.cclegacy,s=t._decorator,n=t.Vec3,o=t.Quat,u=t.CCFloat,a=t.Vec2,r=t.tween,h=t.Component},function(t){p=t.log,c=t.JumpStatus},function(t){l=t.applyDecoratedDescriptor,m=t.inherits,_=t.classCallCheck,d=t.possibleConstructorReturn,f=t.getPrototypeOf,g=t.initializerDefineProperty,j=t.assertThisInitialized,x=t.createClass}],execute:function(){e._RF.push({},"f514fFBUXpDva7Z4+Bu/z5l","OtherPlayer",void 0),z=s.ccclass,C=s.property,new n,new n,F=new o,new o,t("OtherPlayer",(v=z("OtherPlayer"),y=C({type:u}),R=C({type:u}),P=C({type:u}),v((k=l((B=function(t){function i(){var t,e;_(this,i);for(var s=arguments.length,u=new Array(s),r=0;r<s;r++)u[r]=arguments[r];return e=d(this,(t=f(i)).call.apply(t,[this].concat(u))),g(e,"jumpHeight",k,j(e)),g(e,"jumpDuration",D,j(e)),g(e,"max_time",b,j(e)),e.originPosY=0,e.originRotation=new o(0,1,0,0),e._isRunning=!1,e.curRotation=new o,e._cur_position=new n,e._jump_time=0,e.jumpResult={time:null,distance:null,offset:null,status:null},e._face=new a,e._axis=new n,e._stat_power=!1,e._stat_jump=!1,e.curBox=null,e.nextBox=null,e.control=!1,e.map=null,e.index=0,e}return m(i,t),x(i,[{key:"onLoad",value:function(){}},{key:"start",value:function(){this.originPosY=this.node.position.y,this.node.getRotation(this.curRotation)}},{key:"initPlayer",value:function(){var t=new n(0,this.originPosY,0);new o;this.node.setPosition(t),this.node.setRotation(this.originRotation),this._jump_time=0,this._stat_power=!1,this._stat_jump=!1}},{key:"PowerEnd",value:function(t){if(0==this.control){this._stat_power=!1;var i=new n;this.node.getPosition(i),i.y=this.originPosY,this.node.setPosition(i),this.start_jump(t)}}},{key:"start_jump",value:function(t){this._stat_power||(p("[敌人]跳跃相关信息:",t),p("地图长度:",this.map.length),this._stat_jump=!0,this._jump_time=0,this.getFace(this._face),this._axis=this.gameManager.Util.getJumpAxis(this.node,this.nextBox.node),this.node.getRotation(this.curRotation),this.node.getPosition(this._cur_position),this.jumpResult.distance=t.distance,this.jumpResult.offset=t.pos,this.jumpResult.status=t.status,this.jumpResult.time=t.time,this.index=t.index,this.curBox=this.map[this.index],this.nextBox=this.map[this.index+1])}},{key:"action_jump",value:function(t){if(this._stat_jump){this._jump_time+=t;var i=0,e=0,s=0,u=!1;if(this._jump_time<this.jumpDuration){var a=-4*this.jumpHeight/(this.jumpDuration*this.jumpDuration),r=this.jumpDuration/2,h=this.jumpHeight;i=a*(this._jump_time-r)*(this._jump_time-r)+h+this.originPosY,e=t/this.jumpDuration*this.jumpResult.distance,s=this._jump_time/this.jumpDuration*360}else i=this.originPosY,s=0,this._stat_jump=!1,u=!0;var p=new n;this.node.getPosition(p);var c=this.gameManager.Util.getPosWithVec(p,this._face,e);c.y=i,o.rotateAround(F,this.curRotation,this._axis,3.1415*s/180),this.node.setPosition(c),this.node.setRotation(F),u&&this.action_jump_end()}}},{key:"action_jump_end",value:function(){var t=new n;if(this.node.getPosition(t),this.jumpResult.status==c.current){p("[敌人]原地跳,修改正量:",this.jumpResult.offset);var i=new n;this.curBox.node.getPosition(i),i.x+=this.jumpResult.offset[0],i.z+=this.jumpResult.offset[1],i.y=this.originPosY,p("[敌人]修正后的坐标:",i),this.node.setPosition(i),this.node.getPosition(this._cur_position),this.setFace()}else if(this.jumpResult.status==c.next){p("[敌人]跳到下一块,修改正量:",this.jumpResult.offset);var e=new n;this.nextBox.node.getPosition(e),e.x+=this.jumpResult.offset[0],e.z+=this.jumpResult.offset[1],e.y=this.originPosY,p("[敌人]修正后的坐标:",e),this.node.setPosition(e),this.node.getPosition(this._cur_position),this.index+=1,this.curBox=this.map[this.index],this.nextBox=this.map[this.index+1],this.setFace()}else if(this.jumpResult.status==c.dead){p("[敌人]跳死了");var s=new n;s.set(t),s.y=-.5,r(this.node).to(1,{position:s},{onComplete:this.jumpDead.bind(this)}).start()}}},{key:"jumpDead",value:function(){this.reset()}},{key:"reset",value:function(){this.node.setPosition(this._cur_position),this.curBox.node.setScale(new n(1,1,1))}},{key:"update",value:function(t){this.isRunning&&this.action_jump(t)}},{key:"setFace",value:function(){var t=this;if(this.nextBox){var i=r(this.node),e=new o;this.node.getRotation(e);var s=this.gameManager.Util.getRotaionQuat(this.node,this.nextBox.node),n=new o;i.to(.2,{},{onUpdate:function(i,o){n.set(e).slerp(s,o),t.node.setRotation(n)}}),i.start()}}},{key:"getFace",value:function(t){if(this.nextBox){new a;var i=new n,e=new n;this.node.getPosition(i),this.nextBox.node.getPosition(e),t.set(e.x-i.x,e.z-i.z)}else t.set(this._face.x,this._face.y)}},{key:"isRunning",set:function(t){this._isRunning=t},get:function(){return this._isRunning}}]),i}(h)).prototype,"jumpHeight",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),D=l(B.prototype,"jumpDuration",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.7}}),b=l(B.prototype,"max_time",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),w=B))||w)),e._RF.pop()}}}));

System.register("chunks:///UI/avatar.js",["cc","../_virtual/_rollupPluginBabelHelpers.js"],(function(t,e){var n,i,r,s,a,o,c,u,l,p,h,v;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.cclegacy,i=t._decorator,r=t.Sprite,s=t.Component},function(t){a=t.inherits,o=t.classCallCheck,c=t.possibleConstructorReturn,u=t.getPrototypeOf,l=t.createClass}],execute:function(){n._RF.push({},"62231BivyRLC6qStdnthPWc","avatar",void 0),v=i.ccclass,i.property,t("Avatar",(p=v("Avatar"),p(h=function(t){function e(){var t,n;o(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return(n=c(this,(t=u(e)).call.apply(t,[this].concat(r)))).run=!1,n.time=0,n.loopTime=5,n}return a(e,t),l(e,[{key:"start",value:function(){}},{key:"timeStart",value:function(){this.run=!0}},{key:"reset",value:function(){this.run=!1,this.time=0;var t=this.node.getComponent(r).material.passes[0];t.setUniform(t.getHandle("precent"),100)}},{key:"update",value:function(t){if(this.run){var e=this.node.getComponent(r).material.passes[0];e.setUniform(e.getHandle("precent"),20*this.time),this.time+=t,this.time>=this.loopTime&&this.reset()}}}]),e}(s))||h)),n._RF.pop()}}}));

System.register("chunks:///UI/Board/GamingBoard.js",["cc","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js","./BaseBoard.js","../avatar.js"],(function(e,t){var a,r,n,i,o,s,m,h,l,u,c,g,d,y,p,v,C,f,S,D,N,B,R,K;return{setters:[function(e){a=e.cclegacy,r=e.Label,n=e.SystemEventType,i=e.Vec3,o=e.loader,s=e.Prefab,m=e.instantiate},function(e){h=e.ClientDataType,l=e.RoomDataType,u=e.EmojiType,c=e.LabelColor,g=e.log,d=e.ServerDataType,y=e.PlayerState},function(e){p=e.inherits,v=e.createClass,C=e.classCallCheck,f=e.possibleConstructorReturn,S=e.getPrototypeOf,D=e.get,N=e.asyncToGenerator},function(e){B=e.BaseBoard},function(e){R=e.Avatar}],execute:function(){a._RF.push({},"5a91dy6sIFJ+IdMqEEFo6I0","GamingBoard",void 0),K=function(){function e(t,a){C(this,e),this.board=null,this.SDK=null,this.end=!1,this.emojiList=[],this.curAvatar=null,this.selfAvatar=null,this.teammaterAvatar=null,g("初始化UI控制",t,a),this.board=t,this.SDK=a}var t,a,n,h;return v(e,[{key:"initUI",value:(h=N(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board=t,this.refreshState();case 2:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"setTime",value:function(e){this.board&&(this.board.getChildByName("Header").getChildByName("time").getComponent(r).string=e)}},{key:"ControlStart",value:(n=N(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeamId();case 2:r=e.sent,n="0"==r?this.board.getChildByName("Header").getChildByName("team0"):this.board.getChildByName("Header").getChildByName("team1"),(a=t?n.getChildByName("avatar-1"):n.getChildByName("avatar-2")).getComponent(R).timeStart(),this.curAvatar=a;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"ControlReset",value:(a=N(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.curAvatar.getComponent(R).reset();case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"ControlTimeRefresh",value:function(e){this.board.getChildByName("Header").getChildByName("control_time").getComponent(r).string=e}},{key:"refreshState",value:function(){if(!this.end){var e=this.board.getChildByName("Header").getChildByName("tip");this.SDK.gameManager.isControler?(e.getComponent(r).string="该你跳了",e.getComponent(r).color=c.Ready,e.active=!0):(e.getComponent(r).string="等另一半跳",e.getComponent(r).color=c.NotReady,e.active=!0)}}},{key:"refreshEmoji",value:function(){for(var e=this.emojiList.length-1;e>=0;e--){var t=this.emojiList[e];t.time-=.5,t.time<=0&&(t.node.destroy(),this.emojiList.splice(e,1))}}},{key:"gameEnd",value:function(){if(!this.end){this.end=!0;var e=this.board.getChildByName("Header").getChildByName("tip");e.getComponent(r).string="游戏结束,等待结算",e.getComponent(r).color=c.Ready}}},{key:"showEmoji",value:(t=N(regeneratorRuntime.mark((function e(t,a){var r,n,h,l,u,c,d,y=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new i(0,-80,0),new i,e.next=4,this.SDK.getRoomInfo();case 4:return h=e.sent,l=h.playerList,u=h.teamList,d=new Promise((function(e){var i="Prefab/Emoji/emoji_"+(t+1);g("预制件路径",i),o.loadRes(i,s,function(){var t=N(regeneratorRuntime.mark((function t(i,o){var s,h,d,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=3;break}return g("表情预制件实例化失败",i),t.abrupt("return");case 3:return n=m(o),l.map((function(e){e.id===a&&(c=e)})),s=u.findIndex((function(e){return e.id===c.teamId})),t.next=8,y.SDK.getPlayerIndex(a);case 8:h=t.sent,0===s?(d=y.board.getChildByName("Header").getChildByName("team0"),r.x=1===h?d.getChildByName("avatar-1").getPosition().x:d.getChildByName("avatar-2").getPosition().x,n.setPosition(r),n.setParent(d)):(p=y.board.getChildByName("Header").getChildByName("team1"),r.x=1===h?p.getChildByName("avatar-1").getPosition().x:p.getChildByName("avatar-2").getPosition().x,n.setPosition(r),n.setParent(p)),y.emojiList.push({node:n,time:2}),e(!0);case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())})),e.abrupt("return",d);case 9:case"end":return e.stop()}}),e,this)}))),function(e,a){return t.apply(this,arguments)})}]),e}(),e("GamingBoard",function(e){function t(e,a){var r;return C(this,t),(r=f(this,S(t).call(this,e,a))).uiControl=null,r.controlTime=-100,r.name="GamingBoard",r.uiControl=new K(r.board,r.SDK),r}var a,i,o,s;return p(t,e),v(t,[{key:"initData",value:function(){D(S(t.prototype),"initData",this).call(this),this.controlTime=-100,this.uiControl.end=!1,this.uiControl.initUI(this.board)}},{key:"setListener",value:function(){D(S(t.prototype),"setListener",this).call(this),this.SDK.curRoom.onRecvFromGameSvr=this.onRecvFromGameSvr.bind(this),this.SDK.curRoom.onRecvFromClient=this.onRecvFromClient.bind(this),this.SDK.gameManager.timerSingal=this.onTimerSingal.bind(this),this.SDK.gameManager.uiRefresh=this.onUIRefresh.bind(this),this.SDK.gameManager.avatarSingal=this.onAvatarSingal.bind(this)}},{key:"destroy",value:function(){D(S(t.prototype),"destroy",this).call(this)}},{key:"onLeaveRoom",value:(s=N(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.leavePlayerId,e.next=3,this.SDK.getLoverInfo();case 3:e.sent,g("玩家离开房间",a);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onRecvFromGameSvr",value:(o=N(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=null,r=-1;try{a=t.data.data,r=a.type}catch(e){g("接收到错误的信息-error",e)}if(r!=d.Sync){e.next=9;break}return g("接收到数据同步信息",a.data),e.next=7,this.SDK.gameManager.syncData(a.data);case 7:e.next=10;break;case 9:r==d.ChangeControler?(g("接收到控制权转移信息",a.data),this.SDK.gameManager.changeControler(a.data.gameState.curActionPlayer),this.SDK.gameManager.Player.reset()):r==d.Map?(g("接收到地图同步信息",a.data),this.SDK.gameManager.syncMap(a.data)):r==d.Result?(g("接收到结算结果信息",a.data),g("结算界面取消控制权"),this.SDK.gameManager.isControler=!1,this.SDK.gameManager.isRunning=!1,this.SDK.leaveRoom(),this.SDK.setGroupPlayerStatus(y.NotReady),(n=this.SDK.gameManager.ResultBoard).setResult(a.data),this.ChangeBoard(n)):r==d.NetState?g("接收到在线状态变更信息",a.data):g("接收到错误的信息-data",t);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onRecvFromClient",value:(i=N(regeneratorRuntime.mark((function e(t){var a,r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(t.data.msg),r=a.type,n=a.data,i=t.data.sendPlayerId,o=null,r==l.Power?(o="队友",this.SDK.gameManager.Player.teammatePower()):r==l.PowerEnd?(o="队友",this.SDK.gameManager.Player.teammatePowerEnd(n)):r==l.EnemyPowerEnd?(o="敌人",this.SDK.gameManager.OtherTeam.PowerEnd(n)):r==l.emoji?(o=i,this.uiControl.showEmoji(n,i)):r==l.SyncComplete&&(o="队友同步完成",this.SDK.sendToServer(h.RequestSyncData,{team:this.SDK.gameManager.serverTeam})),g("接收到来自其他客户端的消息["+o+"]","类型序号:",r," 数据:",n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onTimerSingal",value:function(){if(!this.dead){this.SDK.sendToServer(h.Heart,this.SDK.gameManager.serverTeam.id);var e=this.SDK.gameManager.gameTime-(Date.parse((new Date).toString())/1e3-this.SDK.gameManager.startTime);this.SDK.gameManager.startTime,this.uiControl.setTime(e),e<=0&&(this.SDK.gameManager.isRunning=!1,this.SDK.gameManager.isControler=!1,this.SDK.gameManager.timerSingal=null,this.uiControl.gameEnd(),this.SDK.sendToServer(h.End,1)),this.uiControl.refreshEmoji(),this.controlTime>0&&!this.SDK.gameManager.Player._stat_power&&!this.SDK.gameManager.Player._stat_jump?this.controlTime-=.5:this.controlTime<=0&&this.controlTime>=-10&&(this.controlTime=-100,this.SDK.gameManager.isControler=!1,this.onAvatarSingal(!0,!1),this.onUIRefresh(),this.SDK.sendToServer(h.ChangeControler))}}},{key:"refreshScore",value:function(){if("0"==this.SDK.gameManager.serverTeam.id){var e=0,t=0;this.SDK.gameManager.serverTeam.playerList.map((function(t){e+=t.score})),this.SDK.gameManager.otherTeam.playerList.map((function(e){t+=e.score})),this.team1Node.getChildByName("score").getChildByName("num").getComponent(r).string="".concat(e),this.team2Node.getChildByName("score").getChildByName("num").getComponent(r).string="".concat(t)}else{var a=0,n=0;this.SDK.gameManager.serverTeam.playerList.map((function(e){a+=e.score})),this.SDK.gameManager.otherTeam.playerList.map((function(e){n+=e.score})),this.team2Node.getChildByName("score").getChildByName("num").getComponent(r).string="".concat(a),this.team1Node.getChildByName("score").getChildByName("num").getComponent(r).string="".concat(n)}}},{key:"onUIRefresh",value:function(){this.uiControl.refreshState(),this.refreshScore()}},{key:"onAvatarSingal",value:function(e,t){e?t?(this.controlTime=5,this.uiControl.selfAvatar.getComponent(R).timeStart()):(this.controlTime=-100,this.uiControl.selfAvatar.getComponent(R).reset()):t?this.uiControl.teammaterAvatar.getComponent(R).timeStart():this.uiControl.teammaterAvatar.getComponent(R).reset()}},{key:"InitEvent",value:(a=N(regeneratorRuntime.mark((function e(){var a,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(S(t.prototype),"InitEvent",this).call(this),a=this.board.getChildByName("Interaction-ex"),this.team1Node=this.board.getChildByName("Header").getChildByName("team0"),this.team2Node=this.board.getChildByName("Header").getChildByName("team1"),this.comp1=this.team1Node.getChildByName("avatar-1"),this.comp2=this.team1Node.getChildByName("avatar-2"),this.comp3=this.team2Node.getChildByName("avatar-1"),this.comp4=this.team2Node.getChildByName("avatar-2"),a.getChildByName("emoji_1").on(n.TOUCH_END,this.sendEmoji_1,this),a.getChildByName("emoji_2").on(n.TOUCH_END,this.sendEmoji_2,this),a.getChildByName("emoji_3").on(n.TOUCH_END,this.sendEmoji_3,this),a.getChildByName("emoji_4").on(n.TOUCH_END,this.sendEmoji_4,this),e.next=14,this.SDK.getTeamId();case 14:return r=e.sent,e.next=17,this.SDK.getPlayerIndex();case 17:i=e.sent,"0"==r?1==i?(this.uiControl.selfAvatar=this.comp1,this.uiControl.teammaterAvatar=this.comp2):(this.uiControl.selfAvatar=this.comp2,this.uiControl.teammaterAvatar=this.comp1):1==i?(this.uiControl.selfAvatar=this.comp3,this.uiControl.teammaterAvatar=this.comp4):(this.uiControl.selfAvatar=this.comp4,this.uiControl.teammaterAvatar=this.comp3);case 19:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"sendEmoji_1",value:function(){this.SDK.sendToRoom(l.emoji,u.Angry)}},{key:"sendEmoji_2",value:function(){this.SDK.sendToRoom(l.emoji,u.Worship)}},{key:"sendEmoji_3",value:function(){this.SDK.sendToRoom(l.emoji,u.Unfortunately)}},{key:"sendEmoji_4",value:function(){this.SDK.sendToRoom(l.emoji,u.Applause)}}]),t}(B)),a._RF.pop()}}}));

System.register("chunks:///UI/Board/MainBoard.js",["cc","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js","./BaseBoard.js"],(function(e,t){var a,r,n,i,o,s,h,c,l,g,u,m,d,v;return{setters:[function(e){a=e.cclegacy,r=e._decorator,n=e.SystemEventType,i=e.Label},function(e){o=e.log},function(e){s=e.inherits,h=e.createClass,c=e.classCallCheck,l=e.possibleConstructorReturn,g=e.getPrototypeOf,u=e.asyncToGenerator,m=e.get},function(e){d=e.BaseBoard}],execute:function(){a._RF.push({},"253a4372BVD94kGBxFcROCR","MainBoard",void 0),r.ccclass,r.property,v=function(){function e(t,a){c(this,e),this.board=t,this.SDK=a}var t;return h(e,[{key:"initUI",value:(t=u(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board=t,a=this.board.getChildByName("Header"),this.weekDataNode=a.getChildByName("career").getChildByName("weekData"),this.loverDataNode=a.getChildByName("top").getChildByName("bgHistory"),this.selfAvatarNode=a.getChildByName("top").getChildByName("Avatar").getChildByName("Sprite"),this.otherAvatarNode=a.getChildByName("top").getChildByName("Avatar2").getChildByName("Sprite"),this.SDK.gameManager.Util.loadRemoteImg(this.SDK.gameManager.PlayerData.avatar_url,this.selfAvatarNode),this.SDK.gameManager.loverData&&this.SDK.gameManager.loverData.avatar&&(r="https://".concat(this.SDK.gameManager.loverData.avatar.host,"/").concat(this.SDK.gameManager.loverData.avatar.path),this.SDK.gameManager.Util.loadRemoteImg(r,this.otherAvatarNode)),this.weekDataNode.getChildByName("num").getChildByName("value").getComponent(i).string="".concat(this.SDK.gameManager.PlayerData.playCountWeek),this.weekDataNode.getChildByName("rate").getChildByName("value").getComponent(i).string="".concat(this.SDK.gameManager.PlayerData.winCountWeek),this.weekDataNode.getChildByName("mvp").getChildByName("value").getComponent(i).string="".concat(this.SDK.gameManager.PlayerData.mvpCountWeek),this.loverDataNode.getChildByName("total").getComponent(i).string="".concat(this.SDK.gameManager.PlayerData.loverCount),this.loverDataNode.getChildByName("victory").getComponent(i).string="".concat(this.SDK.gameManager.PlayerData.loverWinCount);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"initData",value:function(){}}]),e}(),e("MainBoard",function(e){function t(e,a){var r;return c(this,t),(r=l(this,g(t).call(this,e,a))).name="MainBoard",r.uiControl=new v(r.board,r.SDK),r}var a,r,i;return s(t,e),h(t,[{key:"InitEvent",value:(i=u(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m(g(t.prototype),"InitEvent",this).call(this),a=this.board.getChildByName("MatchButton").getChildByName("single"),r=this.board.getChildByName("MatchButton").getChildByName("lover"),a.on(n.TOUCH_START,this.clickSingleMatch,this),r.on(n.TOUCH_START,this.clickLoverMatch,this);case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"clickSingleMatch",value:(r=u(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("尝试单人匹配"),t=this.SDK.gameManager.MatchingBoard,a=this.SDK,e.next=5,this.ChangeBoard(t);case 5:a.matchingSingle();case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"clickLoverMatch",value:(a=u(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.createGroup();case 2:if(0!==(t=e.sent)){e.next=9;break}return a=this.SDK.gameManager.WaitLoverBoard,e.next=7,this.ChangeBoard(a);case 7:e.next=10;break;case 9:o("队组创建失败",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}]),t}(d)),a._RF.pop()}}}));

System.register("chunks:///UI/Board/MatchingBoard.js",["cc","../../Config.js","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js","./BaseBoard.js"],(function(e,t){var a,r,n,i,s,o,h,c,u,l,m,d,g,y,v,p,f,C,S,B,D,K;return{setters:[function(e){a=e.cclegacy,r=e.SystemEventType,n=e.Label,i=e.Animation,s=e.Vec3},function(e){o=e.Env,h=e.EnvType,c=e.DebugGameTime},function(e){u=e.log,l=e.ClientDataType,m=e.RoomDataType,d=e.NetState,g=e.ServerDataType},function(e){y=e.inherits,v=e.createClass,p=e.classCallCheck,f=e.possibleConstructorReturn,C=e.getPrototypeOf,S=e.get,B=e.asyncToGenerator},function(e){D=e.BaseBoard}],execute:function(){a._RF.push({},"b8dbbjBDbxP+YYY37doxtEY","MatchingBoard",void 0),K=function(){function e(t,a){p(this,e),this.board=null,this.SDK=null,this.team1=null,this.team2=null,this.circle=null,this.board=t,this.SDK=a}var t,a,r,o;return v(e,[{key:"initUI",value:(o=B(regeneratorRuntime.mark((function e(t){var a,r,n,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.board=t,this.team1=this.board.getChildByName("team1"),this.team2=this.board.getChildByName("team2"),this.circle=this.board.getChildByName("circle"),e.next=6,this.SDK.getGroupInfo();case 6:return a=e.sent,e.next=9,this.SDK.getPlayerInfo();case 9:if(r=e.sent,n=null,this.circle.getComponent(i).onLoad(),this.circle.setRotationFromEuler(0,0,0),this.circle.setScale(1,1,1),this.circle.getChildByName("red").active=!0,this.circle.getChildByName("blue").active=!0,this.team1.getChildByName("card").getChildByName("user2").active=!1,this.team1.getChildByName("card").getChildByName("user2_wait").active=!0,this.team2.getChildByName("card").getChildByName("user1").active=!1,this.team2.getChildByName("card").getChildByName("user2").active=!1,this.team2.getChildByName("card").getChildByName("user1_wait").active=!0,this.team2.getChildByName("card").getChildByName("user2_wait").active=!0,this.team1.getChildByName("card").getChildByName("Lover").active=!1,this.team2.getChildByName("card").getChildByName("Lover").active=!1,this.board.getChildByName("CancelMatchButton").active=!0,a)for(this.showLoverUI(),n=a.groupPlayerList,s=0;s<n.length;s++)(o=n[s]).id==r.id?this.setPlayer(1,1,o):this.setPlayer(1,2,o);else this.setPlayer(1,1,r);case 26:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"matchSuccess",value:(r=B(regeneratorRuntime.mark((function e(){var t,a,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoverUI(),e.next=3,this.SDK.getRoomInfo();case 3:return t=e.sent,e.next=6,this.SDK.getPlayerInfo();case 6:for(a=e.sent,r=t.playerList,i=1,s=0;s<r.length;s++)(o=r[s]).teamId==a.teamId?o.id==a.id?this.setPlayer(1,1,o):this.setPlayer(1,2,o):(this.setPlayer(2,i,o),i+=1);this.board.getChildByName("guide").getComponent(n).string="匹配成功,等待进入游戏";case 11:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setTime",value:function(e){this.board&&(this.board.getChildByName("guide").getComponent(n).string="正在匹配("+Math.floor(e)+"s)")}},{key:"setPlayer",value:function(e,t,a){u("playerNum: ",t);var r=null,i=null,s=null;if(r=this.team1,2==e&&(r=this.team2),i=r.getChildByName("card").getChildByName("user1"),s=r.getChildByName("card").getChildByName("user1_wait"),2==t&&(i=r.getChildByName("card").getChildByName("user2"),s=r.getChildByName("card").getChildByName("user2_wait")),a){i.getChildByName("nickName").getComponent(n).string=a.name;var o=i.getChildByName("avatarBg").getChildByName("avatar"),h=a.profile?JSON.parse(a.profile):a.customProfile?JSON.parse(a.customProfile):JSON.parse(a.customGroupPlayerProfile);this.SDK.gameManager.Util.loadRemoteImg(h.avatar_url,o),i.active=!0,s&&(s.active=!1)}else i.active=!1,s&&(s.active=!0)}},{key:"showLoverUI",value:(a=B(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.gameManager.Util.teammaterIsLover();case 2:return t=e.sent,e.next=5,this.SDK.gameManager.Util.enemyIsLover();case 5:a=e.sent,this.team1.getChildByName("card").getChildByName("Lover").active=!!t,this.team2.getChildByName("card").getChildByName("Lover").active=!!a;case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"changeMatchStatus",value:(t=B(regeneratorRuntime.mark((function e(){var t,a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeamId();case 2:t=e.sent,a=this.board.getChildByName("circle").getComponent(i).clips[0],"1"==t&&(a.curves[0].data.values[1]=new s(0,0,90)),"0"==t&&(a.curves[0].data.values[1]=new s(0,0,-90)),this.board.getChildByName("circle").getChildByName("red").active=!1,this.board.getChildByName("circle").getChildByName("blue").active=!1,this.board.getChildByName("CancelMatchButton").active=!1,this.board.getChildByName("circle").getComponent(i).play(),this.board.getChildByName("circle").getComponent(i).once(i.EventType.FINISHED,(function(){r.board.getChildByName("circle").getComponent(i).onDestroy()}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),e("MatchingBoard",function(e){function t(e,a){var r;return p(this,t),(r=f(this,C(t).call(this,e,a))).uiControl=null,r.matchingTime=0,r.initTime=0,r.waitInit=!1,r.name="MatchingBoard",r.uiControl=new K(r.board,r.SDK),r}var a,n,i,s,D,x,N;return y(t,e),v(t,[{key:"setListener",value:function(){S(C(t.prototype),"setListener",this).call(this),this.SDK.Room.onCancelMatch=this.onCancelMatch.bind(this),this.SDK.Room.onMatch=this.onMatch.bind(this),this.SDK.curRoom.onRecvFromClient=this.onRecvFromClient.bind(this),this.SDK.curRoom.onChangePlayerNetworkState=this.onChangePlayerNetworkState.bind(this),this.SDK.curRoom.onLeaveRoom=this.onLeaveRoom.bind(this),this.SDK.curRoom.onRecvFromGameSvr=this.onRecvFromGameSvr.bind(this),this.SDK.gameManager.timerSingal=this.onTimerSingal.bind(this)}},{key:"destroy",value:function(){S(C(t.prototype),"destroy",this).call(this)}},{key:"initData",value:function(){S(C(t.prototype),"initData",this).call(this),this.matchingTime=0,this.initTime=0,this.waitInit=!1}},{key:"onTimerSingal",value:function(){this.dead||(this.waitInit?(this.initTime+=.5,this.initTime>2&&this.initTime<100&&(u("未正常接收到初始化数据,发送请求初始化数据请求"),this.SDK.sendToServer(l.RequestInitData,1),this.initTime=1e7)):(this.uiControl.setTime(this.matchingTime),this.matchingTime+=.5))}},{key:"onCancelMatch",value:(N=B(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("接收到取消匹配的信号",t),e.next=3,this.SDK.getGroupInfo();case 3:return a=e.sent,u("接收到取消匹配信号时的队组信息",a),r=null,r=a?this.SDK.gameManager.WaitLoverBoard:this.SDK.gameManager.MainBoard,e.next=9,this.ChangeBoard(r);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"onMatch",value:(x=B(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.data.errCode!==this.SDK.errorCode.EC_OK){e.next=25;break}return u("匹配成功",t.data),this.SDK.curRoom.initRoom(t.data.roomInfo),this.SDK.Listener.add(this.SDK.curRoom),this.waitInit=!0,this.uiControl.matchSuccess(),this.uiControl.changeMatchStatus(),e.next=9,this.SDK.getGroupInfo();case 9:if(e.sent){e.next=24;break}return e.next=13,this.SDK.getPlayerIndex();case 13:if(1!=e.sent){e.next=24;break}return e.next=17,this.SDK.createGroup();case 17:if(e.sent!=MGOBE.ErrCode.EC_OK){e.next=24;break}return e.next=21,this.SDK.getGroupInfo();case 21:return a=e.sent,e.next=24,this.SDK.sendToRoom(m.MatchedJoinGroup,a.id);case 24:return e.abrupt("return");case 25:return u("匹配超时"),e.next=28,this.SDK.getGroupInfo();case 28:return r=e.sent,n=null,n=r?this.SDK.gameManager.WaitLoverBoard:this.SDK.gameManager.MainBoard,e.next=33,this.ChangeBoard(n);case 33:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"onLeaveRoom",value:(D=B(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dead){e.next=16;break}return this.dead=!0,a=t.data.leavePlayerId,e.next=5,this.SDK.getLoverInfo();case 5:return e.sent,e.next=8,this.SDK.getGroupInfo();case 8:return r=e.sent,u("离开房间",a,"离开了准备房间"),e.next=12,this.SDK.leaveRoom();case 12:return n=null,n=r?this.SDK.gameManager.WaitLoverBoard:this.SDK.gameManager.MainBoard,e.next=16,this.ChangeBoard(n);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"onChangePlayerNetworkState",value:(s=B(regeneratorRuntime.mark((function e(t){var a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dead){e.next=21;break}return this.dead=!0,a=t.data.changePlayerId,e.next=5,this.SDK.getLoverInfo();case 5:if(r=e.sent,n=t.data.networkState,u("[Matching]在线状态变化",a,":",n),n!=d.Offline){e.next=21;break}return e.next=11,this.SDK.leaveRoom();case 11:if(!r||r.netState!=d.Online){e.next=18;break}return this.SDK.leaveGroup(),i=this.SDK.gameManager.WaitLoverBoard,e.next=16,this.ChangeBoard(i);case 16:e.next=21;break;case 18:return s=this.SDK.gameManager.MainBoard,e.next=21,this.ChangeBoard(s);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onRecvFromGameSvr",value:(i=B(regeneratorRuntime.mark((function e(t){var a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u("接收到实时服务器的数据:",t.data),a=t.data.data,(r=a.type)!=g.Init){e.next=10;break}this.SDK.gameManager.timerSingal=null,n=a.data,u("初始化参数:",n),this.SDK.gameManager.node.emit("GameInit",n),e.next=20;break;case 10:if(r!=g.Start){e.next=20;break}return this.SDK.gameManager.isRunning=!0,i=a.data,this.SDK.gameManager.startTime=i.startTime,o==h.develop?this.SDK.gameManager.gameTime=c:this.SDK.gameManager.gameTime=a.gameTime,u("[游戏开始数据]",i),s=this.SDK.gameManager.GamingBoard,e.next=19,this.ChangeBoard(s);case 19:s.SDK.gameManager.uiRefresh();case 20:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onRecvFromClient",value:(n=B(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data.msg),r=a.type,n=a.data,t.data.sendPlayerId,r!=m.MatchedJoinGroup){e.next=8;break}return u("接收到路人组队的队组ID",n),e.next=8,this.SDK.joinGroup(n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"InitEvent",value:function(){S(C(t.prototype),"InitEvent",this).call(this),this.board.getChildByName("CancelMatchButton").getChildByName("Button").on(r.TOUCH_START,this.clickCancelMatch,this)}},{key:"clickCancelMatch",value:(a=B(regeneratorRuntime.mark((function e(){var t,a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dead){e.next=3;break}return u("点击取消,但是dead",this.name),e.abrupt("return");case 3:return this.dead=!0,e.next=6,this.SDK.getRoomInfo();case 6:return t=e.sent,e.next=9,this.SDK.getGroupInfo();case 9:return a=e.sent,e.next=12,this.SDK.getPlayerInfo();case 12:if(e.sent,r=!1,!t){e.next=20;break}return e.next=17,this.SDK.leaveRoom();case 17:(n=e.sent)===this.SDK.errorCode.EC_OK?u("匹配成功后退出房间","成功"):u("匹配成功后退出房间","失败",n),r=!0;case 20:if(r){e.next=28;break}return u("11111"),e.next=24,this.SDK.cancelMatchinig();case 24:(i=e.sent)===this.SDK.errorCode.EC_OK?u("取消匹配","成功"):u("取消匹配:","失败",i),e.next=32;break;case 28:return s=null,s=a?this.SDK.gameManager.WaitLoverBoard:this.SDK.gameManager.MainBoard,e.next=32,this.ChangeBoard(s);case 32:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}]),t}(D)),a._RF.pop()}}}));

System.register("chunks:///UI/Board/ResultBoard.js",["cc","../../Const.js","../../_virtual/_rollupPluginBabelHelpers.js","./BaseBoard.js"],(function(e,t){var a,r,n,i,o,s,u,c,l,h,m,g,d,y,p,C,v,B;return{setters:[function(e){a=e.cclegacy,r=e.Animation,n=e.Label,i=e.Vec3,o=e.SystemEventType},function(e){s=e.log,u=e.PlayerState,c=e.GroupMessageType,l=e.GroupSysMessageType},function(e){h=e.inherits,m=e.createClass,g=e.classCallCheck,d=e.possibleConstructorReturn,y=e.getPrototypeOf,p=e.get,C=e.asyncToGenerator},function(e){v=e.BaseBoard}],execute:function(){a._RF.push({},"8a67cE5ERBGL6NMmCPaURz2","ResultBoard",void 0),B=function(){function e(t,a){g(this,e),this.board=null,this.SDK=null,s("初始化UI控制"),this.board=t,this.SDK=a}var t,a;return m(e,[{key:"initData",value:(a=C(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeammate();case 2:e.sent?this.setOnceMore(0):this.setOnceMore(4);case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"initUI",value:(t=C(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board=t,this.onceMore=this.board.getChildByName("onceMore"),this.changeTeammater=this.board.getChildByName("other"),this.homepage=this.board.getChildByName("back"),s("INITUI",this.onceMore);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setResult",value:function(e){}},{key:"setOnceMore",value:function(e){switch(e){case 1:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(n).string="等待队友准备";break;case 2:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(n).string="队友已准备好,立即开始";break;case 3:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(n).string="再来一局";break;case 4:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_3/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(n).string="队友已离开";break;default:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(n).string="再来一局"}}}]),e}(),e("ResultBoard",function(e){function t(e,a){var r;return g(this,t),(r=d(this,y(t).call(this,e,a))).uiControl=null,r.result=null,r.name="ResultBoard",r.uiControl=new B(r.board,r.SDK),r}var a,v,f,S,M,N,k;return h(t,e),m(t,[{key:"setResult",value:function(e){e&&(this.result=e)}},{key:"initData",value:function(){p(y(t.prototype),"initData",this).call(this)}},{key:"setListener",value:function(){p(y(t.prototype),"setListener",this).call(this),this.SDK.curGroup.onChangeCustomGroupPlayerStatus=this.onChangeCustomGroupPlayerStatus.bind(this),this.SDK.curGroup.onRecvFromGroupClient=this.onRecvFromGroupClient.bind(this),this.SDK.curGroup.onLeaveGroup=this.onLeaveGroup.bind(this),this.SDK.gameManager.timerSingal&&(this.SDK.gameManager.timerSingal=null)}},{key:"onChangeCustomGroupPlayerStatus",value:(k=C(regeneratorRuntime.mark((function e(t){var a,r,n,i,o,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeammate();case 2:return a=e.sent,e.next=5,this.SDK.getPlayerInfo();case 5:if(r=e.sent,n=r.stateGroup,i=u.NotReady,a&&(i=a.customPlayerStatus,t.data.changePlayerId==a.id&&(i=t.data.customGroupPlayerStatus,n==u.Ready?i==u.Ready||this.uiControl.setOnceMore(1):i==u.Ready?this.uiControl.setOnceMore(2):this.uiControl.setOnceMore(3))),n!=u.Ready||i!=u.Ready){e.next=28;break}return e.next=12,this.SDK.getGroupInfo();case 12:return o=e.sent,e.next=15,this.SDK.getPlayerInfo();case 15:if(h=e.sent,s("都准备完毕,进入匹配",o.owner,h.id),o.owner!=h.id){e.next=28;break}return e.next=20,this.SDK.matchingLover();case 20:if((m=e.sent)!=MGOBE.ErrCode.EC_OK){e.next=27;break}return e.next=24,this.SDK.sendToGroup(c.Sys,l.Matching);case 24:this.ChangeBoard(this.SDK.gameManager.MatchingBoard),e.next=28;break;case 27:s("进入匹配失败",m);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"onRecvFromGroupClient",value:(N=C(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s("接收到来自另一半的消息:",t),(a=JSON.parse(t.data.msg)).type!=c.Sys){e.next=7;break}if(a.content!=l.Matching){e.next=7;break}return r=this.SDK.gameManager.MatchingBoard,e.next=7,this.ChangeBoard(r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"onChangeGroupPlayerNetworkState",value:(M=C(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s("玩家[",t.data.changePlayerId,"]在线状态有变化",t.data.networkState);case 1:case"end":return e.stop()}}),e)}))),function(e){return M.apply(this,arguments)})},{key:"onJoinGroup",value:function(e){s("有玩家加入队组:",e.data.joinPlayerId)}},{key:"onLeaveGroup",value:function(e){s("有人离开队组",e.data.leavePlayerId),this.uiControl.setOnceMore(4)}},{key:"InitEvent",value:function(){var e=this;p(y(t.prototype),"InitEvent",this).call(this);var a=this.board.getChildByName("back"),s=this.board.getChildByName("onceMore"),u=this.board.getChildByName("other"),c=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard"),l=this.board.getChildByName("scoreBoard").getChildByName("mvp").getComponent(r);l.onLoad(),Object.keys(this.result.teamList).map((function(t){"0"==e.result.teamList[t].id&&e.result.teamList[t].playerList.map((function(t,a){var r=c.getChildByName("teamRed").getChildByName("avatars").getChildByName("avatar".concat(a+1));r.getChildByName("nickName").getComponent(n).string=t.name,r.getChildByName("score").getComponent(n).string="+".concat(t.score),t.score,e.SDK.gameManager.Util.loadRemoteImg(t.avatar,r),t.id===e.result.mvp&&(l.clips[0].curves[1].data.values[1]=new i(r.getPosition().x-40,r.getPosition().y-170,0))})),"1"==e.result.teamList[t].id&&e.result.teamList[t].playerList.map((function(t,a){var r=c.getChildByName("teamBlue").getChildByName("avatars").getChildByName("avatar".concat(a+1));r.getChildByName("nickName").getComponent(n).string=t.name,r.getChildByName("score").getComponent(n).string="+".concat(t.score),t.score,e.SDK.gameManager.Util.loadRemoteImg(t.avatar,r),t.id===e.result.mvp&&(l.clips[0].curves[1].data.values[1]=new i(r.getPosition().x-40,150+r.getPosition().y,0))})),e.result.mvp&&setTimeout((function(){e.board.getChildByName("scoreBoard").getChildByName("mvp").active=!0,l.play()}),500);var a=e.board.getChildByName("scoreBoard").getChildByName("cup");e.result.winnerTeam||(a.getChildByName("draw").active=!0),"0"==e.SDK.gameManager.serverPlayer.teamId&&"0"==e.result.winnerTeam&&(e.SDK.gameManager.Util.loadImg("Texture/UI/result/ying/spriteFrame",e.board.getChildByName("scoreBoard")),a.getChildByName("win").active=!0),"0"==e.SDK.gameManager.serverPlayer.teamId&&"1"==e.result.winnerTeam&&(e.SDK.gameManager.Util.loadImg("Texture/UI/result/shu/spriteFrame",e.board.getChildByName("scoreBoard")),a.getChildByName("default").active=!0),"1"==e.SDK.gameManager.serverPlayer.teamId&&"0"==e.result.winnerTeam&&(e.SDK.gameManager.Util.loadImg("Texture/UI/result/shu/spriteFrame",e.board.getChildByName("scoreBoard")),a.getChildByName("default").active=!0),"1"==e.SDK.gameManager.serverPlayer.teamId&&"1"==e.result.winnerTeam&&(e.SDK.gameManager.Util.loadImg("Texture/UI/result/ying/spriteFrame",e.board.getChildByName("scoreBoard")),a.getChildByName("win").active=!0)})),a.on(o.TOUCH_START,this.clickHomepage,this),s.on(o.TOUCH_START,this.clickOnceMore,this),u.on(o.TOUCH_START,this.clickOther,this)}},{key:"clickHomepage",value:(S=C(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveRoom();case 2:return t=e.sent,e.next=5,this.SDK.leaveGroup();case 5:return s("回到首页","离开队组结果:",t),a=this.SDK.gameManager.MainBoard,e.next=9,this.ChangeBoard(a);case 9:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"clickOnceMore",value:(f=C(regeneratorRuntime.mark((function e(){var t,a,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeammate();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.SDK.getPlayerInfo();case 7:a=e.sent,r=a.stateGroup,n=t.customPlayerStatus,(i=r==u.Ready?u.NotReady:u.Ready)==u.Ready?n==u.Ready||this.uiControl.setOnceMore(1):n==u.Ready?this.uiControl.setOnceMore(2):this.uiControl.setOnceMore(3),this.SDK.setGroupPlayerStatus(i);case 13:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"clickDialogButton",value:(v=C(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.SDK.curDialog.destroy(),this.SDK.leaveGroup(),t=this.SDK.gameManager.MainBoard,e.next=5,this.ChangeBoard(t);case 5:this.initBoardElements();case 6:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"clickOther",value:(a=C(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveGroup();case 2:return t=this.SDK.gameManager.MatchingBoard,a=this.SDK,e.next=6,this.ChangeBoard(t);case 6:this.initBoardElements(),a.matchingSingle();case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"initBoardElements",value:function(){var e=this.board.getChildByName("scoreBoard").getChildByName("cup");e.getChildByName("win").active=!1,e.getChildByName("draw").active=!1,e.getChildByName("default").active=!1,this.board.getChildByName("scoreBoard").getChildByName("mvp").getComponent(r).onDestroy(),this.board.getChildByName("scoreBoard").getChildByName("mvp").active=!1}}]),t}(v)),a._RF.pop()}}}));

System.register("chunks:///GameManager.js",["cc","./Config.js","./Const.js","./_virtual/_rollupPluginBabelHelpers.js","./Player.js","./Util.js","./SDK.js","./UI/Dialog/Dialog.js","./UI/Board/WaitLoverBoard.js","./OtherPlayer.js","./UI/Board/GamingBoard.js","./UI/Board/MainBoard.js","./UI/Board/MatchingBoard.js","./UI/Board/ResultBoard.js"],(function(e,t){var r,n,a,i,s,o,u,c,h,l,m,p,d,f,g,v,y,x,_,b,B,D,k,P,w,S,R,T,C,K,I,M,G,N,U,L,O,z,j,E,A,W,F,J,H,q,Q,X,V,Y,Z,$,ee,te,re,ne,ae,ie,se,oe,ue,ce,he,le,me,pe,de,fe,ge,ve;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_temp:void 0}),{setters:[function(e){r=e.cclegacy,n=e._decorator,a=e.Prefab,i=e.Node,s=e.Camera,o=e.Vec3,u=e.tween,c=e.UITransform,h=e.Label,l=e.Component,m=e.randomRangeInt,p=e.loader,d=e.TextureCube,f=e.director,g=e.instantiate,v=e.MeshRenderer,y=e.SystemEventType},function(e){x=e.Env,_=e.EnvType,b=e.serverURL,B=e.DebugGameTime},function(e){D=e.log,k=e.ClientDataType,P=e.RoomDataType,w=e.DialogButtonType,S=e.ServerDataType,R=e.BoxShape,T=e.BoxSizeName,C=e.BoxSize},function(e){K=e.applyDecoratedDescriptor,I=e.inherits,M=e.classCallCheck,G=e.possibleConstructorReturn,N=e.getPrototypeOf,U=e.initializerDefineProperty,L=e.assertThisInitialized,O=e.createClass,z=e.asyncToGenerator},function(e){j=e.Player},function(e){E=e.Util},function(e){A=e.SDK},function(e){W=e.Dialog},function(e){F=e.WaitLoverBoard},function(e){J=e.OtherPlayer},function(e){H=e.GamingBoard},function(e){q=e.MainBoard},function(e){Q=e.MatchingBoard},function(e){X=e.ResultBoard}],execute:function(){r._RF.push({},"1a8f1+varZBzIr09OsNwJXt","GameManager",void 0),fe=n.ccclass,ge=n.property,ve=function(){function e(t,r){M(this,e),this.SDK=null,this.node=null,this.SDK=r,this.node=t;var n=this.node.getParent().getChildByName("UI").getChildByName("Debug");n.getChildByName("LeaveGroup").on(y.TOUCH_END,this.leaveGroup,this),n.getChildByName("PlayerInfo").on(y.TOUCH_END,this.getPlayerInfo,this),n.getChildByName("GroupInfo").on(y.TOUCH_END,this.getGroupInfo,this),n.getChildByName("RoomInfo").on(y.TOUCH_END,this.getRoomInfo,this),n.getChildByName("JoinGroup").on(y.TOUCH_END,this.joinGroup,this),n.getChildByName("LeaveRoom").on(y.TOUCH_END,this.leaveRoom,this),n.getChildByName("GameEnd").on(y.TOUCH_END,this.gameEnd,this),n.getChildByName("AI").getChildByName("toggle").on("toggle",this.AI,this)}var t,r,n,a,i,s,o,u;return O(e,[{key:"getRoomInfo",value:(u=z(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getRoomInfo();case 2:t=e.sent,D("房间信息:",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"leaveRoom",value:(o=z(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveRoom();case 2:0===(t=e.sent)?D("退出成功"):D("退出失败",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getGroupInfo",value:(s=z(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getGroupInfo();case 2:t=e.sent,D("队组信息",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"leaveGroup",value:(i=z(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveGroup();case 2:0===(t=e.sent)?D("退出成功"):D("退出失败",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getPlayerInfo",value:(a=z(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getPlayerInfo();case 2:return t=e.sent,D("玩家信息",t),e.next=6,this.SDK.gameManager.Util.teammaterIsLover();case 6:return r=e.sent,e.next=9,this.SDK.gameManager.Util.enemyIsLover();case 9:n=e.sent,D("队友是另一半",r),D("敌人是情侣",n);case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"joinGroup",value:(n=z(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.node.parent.getChildByName("UI").getChildByName("Debug").getChildByName("GroupId").getChildByName("TEXT_LABEL").getComponent(h).string,D("尝试加入队组:",t),e.next=4,this.SDK.joinGroup(t);case 4:if(0!==(r=e.sent)){e.next=14;break}return D("加入队组成功"),n=this.SDK.gameManager.WaitLoverBoard,D("初始化等待界面完成,修改显示"),e.next=11,this.SDK.curBoard.ChangeBoard(n);case 11:D("修改完成"),e.next=15;break;case 14:D("加入队组失败:",r);case 15:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"AI",value:(r=z(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.SDK.gameManager.Player.AI=t.isChecked,this.SDK.gameManager.Player.AI_jump=!1,this.SDK.gameManager.Player.AI_power=!1;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"gameEnd",value:(t=z(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.SDK.sendToServer(k.End,1);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),e("GameManager",(V=fe("GameManager"),Y=ge({type:a}),Z=ge({type:a}),$=ge({type:a}),ee=ge({type:j}),te=ge({type:J}),re=ge({type:i}),ne=ge({type:s}),ae=ge({type:i}),V((oe=K((se=function(e){function t(){var e,r;M(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(r=G(this,(e=N(t)).call.apply(e,[this].concat(a)))).SDK=new A,r.Debug=null,r.Util=new E(r.SDK),U(r,"playerPrfb",oe,L(r)),U(r,"BoxCubePrfb",ue,L(r)),U(r,"BoxCirclePrfb",ce,L(r)),U(r,"Player",he,L(r)),U(r,"OtherTeam",le,L(r)),U(r,"plane",me,L(r)),U(r,"camera",pe,L(r)),U(r,"UI",de,L(r)),r._origin_camera_pos=new o,r.map=[],r.scoreNodeList=[],r.curBox=null,r.nextBox=null,r._isControler=!1,r.startTime=0,r.gameTime=0,r._isRunning=!1,r.diaDead=!1,r.AccessToken=null,r.clearTime=0,r.teammaterIsLover=void 0,r.enemyIsLover=void 0,r.BoxPrefab={f1:[],f2:[],f3:[],f4:[],f5:[],y1:[],y2:[],y3:[],y4:[],y5:[]},r}var r,n,s,l,y,K,j,J,V,Y,Z,$,ee,te,re,ne;return I(t,e),O(t,[{key:"initPrefab",value:(ne=z(regeneratorRuntime.mark((function e(){var t,r,n,i,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.node.getParent(),this.MainBoard=new q(t,this.SDK),this.WaitLoverBoard=new F(t,this.SDK),this.MatchingBoard=new Q(t,this.SDK),this.GamingBoard=new H(t,this.SDK),this.ResultBoard=new X(t,this.SDK),e.next=8,this.MainBoard.InitBoard();case 8:return e.next=10,this.GamingBoard.InitBoard();case 10:return e.next=12,this.MatchingBoard.InitBoard();case 12:return e.next=14,this.WaitLoverBoard.InitBoard();case 14:for(this.ResultBoard.board=t.getChildByName("UI").getChildByName("ResultBoard"),r=function(e){for(var t=1;t<=10;t++){var r="";r=t<10?"Model/Box/f"+e+"0"+t+"/f"+e+"0"+t:"Model/Box/f"+e+t+"/f"+e+t,p.loadRes(r,a,(function(t,r){if(!t){var n="f"+e.toString();o.BoxPrefab[n].push(r)}}))}},n=1;n<=5;n++)r(n);for(i=function(e){for(var t=1;t<=10;t++){var r="";r=t<10?"Model/Box/y"+e+"0"+t+"/y"+e+"0"+t:"Model/Box/y"+e+t+"/y"+e+t,p.loadRes(r,a,(function(t,r){if(!t){var n="y"+e.toString();o.BoxPrefab[n].push(r)}}))}},s=1;s<=5;s++)i(s);case 19:case"end":return e.stop()}}),e,this)}))),function(){return ne.apply(this,arguments)})},{key:"initData",value:(re=z(regeneratorRuntime.mark((function e(t){var r,n,a,i,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.init(t,this);case 2:if(r=e.sent,D("result",r),n=this.node.getParent(),!r){e.next=27;break}return D("初始化SDK成功",MGOBE.Player.id),e.next=9,this.SDK.inRunningRoom();case 9:if(!e.sent){e.next=16;break}return a=new W(n,this.SDK,"游戏仍在进行中,是否要进行重连?",w.multiple,"重连","不重连"),e.next=14,a.show(this,this.reconnection_yes,this.reconnection_no);case 14:e.next=25;break;case 16:return e.next=18,this.SDK.leaveGroup();case 18:return e.next=20,this.SDK.leaveRoom();case 20:return D("初始化直接切换到MainBoard"),i=this.MainBoard,e.next=24,i.ChangeBoard(i);case 24:n.getChildByName("UI").getChildByName("loading").active=!1;case 25:e.next=30;break;case 27:return s=new W(n,this.SDK,"登录失败,请重新开启游戏",w.single,"知道了"),e.next=30,s.show(this,(function(){o.SDK.curDialog.dead||o.SDK.curDialog.destroy()}));case 30:case"end":return e.stop()}}),e,this)}))),function(e){return re.apply(this,arguments)})},{key:"reconnection_yes",value:(te=z(regeneratorRuntime.mark((function e(){var t,r,n,a,i,s,o,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.diaDead){e.next=2;break}return e.abrupt("return");case 2:return this.diaDead=!0,D("进行断线重连"),this.SDK.curDialog.destroy(),e.next=7,this.SDK.reconnect();case 7:return e.next=9,this.SDK.getRoomInfo();case 9:return t=e.sent,e.next=12,this.SDK.getPlayerInfo();case 12:if(r=e.sent,!t){e.next=38;break}a=t.playerList,i=0;case 16:if(!(i<a.length)){e.next=24;break}if((s=a[i]).id!=r.id){e.next=21;break}return n=s.teamId,e.abrupt("break",24);case 21:i++,e.next=16;break;case 24:return this.SDK.curRoom.onRecvFromGameSvr=this.onRecvFromGameSvr.bind(this),e.next=27,this.SDK.sendToServer(k.Reconnect,n);case 27:if(o=e.sent,D("请求重连的回应",o),o==MGOBE.ErrCode.EC_OK){e.next=36;break}return this.SDK.leaveGroup(),this.SDK.leaveRoom(),u=this.node.getParent(),c=new W(u,this.SDK,"房间已关闭,无法重连",w.single,"回到首页"),e.next=36,c.show(this,this.backMainBoard);case 36:e.next=39;break;case 38:D("重连失败");case 39:case"end":return e.stop()}}),e,this)}))),function(){return te.apply(this,arguments)})},{key:"reconnection_no",value:(ee=z(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.SDK.curDialog.dead){e.next=2;break}return e.abrupt("return");case 2:return D("拒绝断线重连"),this.node.getParent(),this.SDK.leaveGroup(),this.SDK.leaveRoom(),this.SDK.curDialog.destroy(),D("点击拒绝重连切换到MainBoard"),t=this.MainBoard,e.next=11,t.ChangeBoard(t);case 11:case"end":return e.stop()}}),e,this)}))),function(){return ee.apply(this,arguments)})},{key:"onRecvFromGameSvr",value:($=z(regeneratorRuntime.mark((function e(t){var r,n,a,i,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D("接收到实时服务器的数据:",t.data),r=this.node.getParent(),n=t.data.data,(a=n.type)!=S.Reconnect){e.next=16;break}return this.SDK.curRoom.onRecvFromGameSvr=null,e.next=8,this.SDK.gameManager.reconnectSyncData(n.data);case 8:return this.SDK.gameManager.isRunning=!0,i=this.GamingBoard,e.next=12,i.ChangeBoard(i);case 12:this.SDK.sendToServer(k.ReconnectComplete,this.SDK.gameManager.serverTeam.id),this.SDK.sendToServer(k.ChangeControler),e.next=21;break;case 16:if(a!=S.ReconnectFailed){e.next=21;break}return D("重连失败,游戏已经结束"),s=new W(r,this.SDK,"游戏已结束",w.single,"知道了"),e.next=21,s.show(this,(function(){if(!o.SDK.curDialog.dead){var e=o.MainBoard;e.ChangeBoard(e),o.SDK.curDialog.destroy()}}));case 21:case"end":return e.stop()}}),e,this)}))),function(e){return $.apply(this,arguments)})},{key:"backMainBoard",value:(Z=z(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.SDK.curDialog.dead){e.next=2;break}return e.abrupt("return");case 2:return this.SDK.curDialog.destroy(),t=this.MainBoard,e.next=6,t.ChangeBoard(t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return Z.apply(this,arguments)})},{key:"start",value:(Y=z(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="Skymap/sky"+m(1,3),p.loadRes(t,d,(function(e,t){f.getScene().globals.skybox.envmap=t})),this.Debug=new ve(this.node,this.SDK),this.Player.gameManager=this,this.OtherTeam.gameManager=this,r=window.location.search,n=this.Util.getPara("access_token",r),a=null,this.AccessToken=n,x==_.develop&&(a=this.Util.getPara("user_id",r)),this.registerEvent(),this.Player.onJumpComplete=this.onJumpComplete.bind(this),this.Player.onJumpDead=this.onJumpDead.bind(this),this.Player.onPowerDown=this.onPowerDown.bind(this),this.Player.onPowerUp=this.onPowerUp.bind(this),this.schedule(this.timerSingalAction.bind(this),.5),e.next=18,this.initPrefab();case 18:return this.node.parent.getChildByName("UI").getChildByName("Debug").active=x===_.develop,this.camera.node.getPosition(this._origin_camera_pos),e.next=22,this.login(a);case 22:case"end":return e.stop()}}),e,this)}))),function(){return Y.apply(this,arguments)})},{key:"login",value:(V=z(regeneratorRuntime.mark((function e(){var t,r,n,a,i,s,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:null,r={nickname:"",avatar_url:"",user_id:0,lover_id:0,gender:0,playCountWeek:0,winCountWeek:0,mvpCountWeek:0,loverCount:0,loverWinCount:0,tacitScore:0},!t){e.next=17;break}return r.nickname=t,r.avatar_url="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK9xvXic6aqFUicsGcLibMcLMQyUQ9IlViaHwtpib4mePDziaeBNyYicRFiab5m8SnF7kmppAqOexqbCPB4g/132",r.user_id=t,r.lover_id=0,r.gender=1,r.playCountWeek=0,r.mvpCountWeek=0,r.winCountWeek=0,r.loverCount=0,r.loverWinCount=0,r.tacitScore=0,this.PlayerData=r,this.initData(t),e.abrupt("return");case 17:if(!this.AccessToken){e.next=45;break}return e.next=20,this.Util.http(b.gameInit,"GET",{},!1,this.AccessToken);case 20:return n=e.sent,e.next=23,this.Util.http(b.accountInit,"GET",{},!1,this.AccessToken);case 23:if(a=e.sent,D("gameInfo",n),D("userInfo",a),a.other_single_user_info&&a.other_single_user_info.avatar&&(this.loverData=a.other_single_user_info),!n||!a.kiwi_user_info){e.next=45;break}return i=a.kiwi_user_info,s=n,r.nickname=i.nickname?i.nickname:i.id.toString(),r.avatar_url=i.avatar_info?"https://"+i.avatar_info.host+"/"+i.avatar_info.path:"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK9xvXic6aqFUicsGcLibMcLMQyUQ9IlViaHwtpib4mePDziaeBNyYicRFiab5m8SnF7kmppAqOexqbCPB4g/132",r.user_id=i.id,r.lover_id=i.lovers_id,r.gender=i.gender,r.playCountWeek=s.user_match_info.game_match_count?s.user_match_info.game_match_count:0,r.mvpCountWeek=s.user_match_info.mvp_count?s.user_match_info.mvp_count:0,r.winCountWeek=s.user_match_info.win_count?s.user_match_info.win_count:0,r.loverCount=s.lover_match_info.game_match_count?s.lover_match_info.game_match_count:0,r.loverWinCount=s.lover_match_info.win_count?s.lover_match_info.win_count:0,r.tacitScore=s.lover_match_info.tacit_socre?s.lover_match_info.tacit_socre:0,this.PlayerData=r,this.initData(this.PlayerData.user_id),D("playerData",this.PlayerData),e.abrupt("return");case 45:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"registerEvent",value:function(){this.node.on("GameInit",this.gameInit,this),this.node.on("SyncData",this.syncGameData,this)}},{key:"gameInit",value:(J=z(regeneratorRuntime.mark((function e(t){var r,n,a,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D("游戏初始化:"),r=t.map,n=t.gameState,e.next=5,this.SDK.getPlayerInfo();case 5:if(a=e.sent,D("初始化地图数据:",r),D("初始化游戏数据:",n),this.map.length>0){for(i=0;i<this.map.length;i++)this.map[i].node.destroy();this.map=[]}return this.Player.initPlayer(),this.OtherTeam.initPlayer(),this.camera.node.setPosition(this._origin_camera_pos),this.plane.setPosition(new o(0,0,0)),e.next=15,this.drawMap(r,!0);case 15:return e.next=17,this.syncGameData(n.teamList,!0);case 17:if("0"!=this.serverPlayer.teamId){e.next=24;break}return e.next=20,this.Player.setModel(1);case 20:return e.next=22,this.Player.setTire(1);case 22:e.next=26;break;case 24:return e.next=26,this.Player.setModel(3);case 26:return this.OtherTeam.map=this.map,this.OtherTeam.index=0,this.Player.curBox=this.map[0],this.Player.nextBox=this.map[1],this.OtherTeam.curBox=this.map[0],this.OtherTeam.nextBox=this.map[1],this.OtherTeam.setFace(),s=this.Util.isControler(n.curActionPlayer,a),this.isControler=s,e.next=37,this.SDK.sendToServer(k.Ready,{avatar:this.PlayerData.avatar_url,user_id:this.PlayerData.user_id,gender:this.PlayerData.gender,lover_id:this.PlayerData.lover_id});case 37:(u=e.sent)==this.SDK.errorCode.EC_OK?D("发送ready信号","成功"):D("发送ready信号","失败",u);case 39:case"end":return e.stop()}}),e,this)}))),function(e){return J.apply(this,arguments)})},{key:"reconnectSyncData",value:(j=z(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D("断线重连同步数据",t),x==_.develop?this.gameTime=B:this.gameTime=t.gameTime,this.startTime=t.startTime,e.next=5,this.drawMap(t.map,!0);case 5:return e.next=7,this.syncGameData(t.gameState.teamList,!0);case 7:return e.next=9,this.SDK.getGroupInfo();case 9:if((r=e.sent)&&(this.SDK.Listener.add(this.SDK.curGroup),this.SDK.curGroup.initGroup(r)),"0"!=this.serverPlayer.teamId){e.next=16;break}return e.next=14,this.Player.setModel(1);case 14:e.next=18;break;case 16:return e.next=18,this.Player.setModel(3);case 18:return this.Player.reset(this.serverTeam),e.next=21,this.SDK.getPlayerInfo();case 21:n=e.sent,a=this.Util.isControler(t.gameState.curActionPlayer,n),this.isControler=a;case 24:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"syncData",value:(K=z(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncGameData(t);case 2:return this.uiRefresh(),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return K.apply(this,arguments)})},{key:"changeControler",value:(y=z(regeneratorRuntime.mark((function e(t){var r,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D("控制权转移数据",t),e.next=3,this.SDK.getPlayerInfo();case 3:r=e.sent,n=this.Util.isControler(t,r),setTimeout((function(){a.isControler=n,a.uiRefresh(),a.avatarSingal(n,!0)}),500);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"syncMap",value:(l=z(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D("同步地图数据",t),this.drawMap(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"onJumpComplete",value:function(e,t){if("GamingBoard"==this.SDK.curBoard.name){if(D("跳跃完成","发送完成信号"),D("是否为进入下一跳:",e),this.isControler=!1,this.Player.jumpResult.perfect?this.serverTeam.perfectJump+=1:this.serverTeam.perfectJump=0,e){D("计分时的完美跳跃次数",this.serverTeam.perfectJump);var r=this.Util.getScore(this.serverTeam.perfectJump);this.showScore(r);var n=new o,a=new o;if(this.nextBox.node.getPosition(a),t&&(this.serverPlayer.score+=r),this.serverTeam.cur_cube+=1,this.serverTeam.pos=this.Player.jumpResult.offset,D("跳跃成功到下一格,最新的下标:",this.serverTeam.cur_cube),D("地图长度:",this.map.length),this.Player.curBox=this.map[this.serverTeam.cur_cube],this.Player.nextBox=this.map[this.serverTeam.cur_cube+1],this.curBox=this.Player.curBox,this.nextBox=this.Player.nextBox,this.nextBox){var i=new o;this.nextBox.node.getPosition(i),a.x=(a.x+i.x)/2,a.z=(a.z+i.z)/2,o.add(n,a,this._origin_camera_pos),u(this.camera.node).to(.5,{position:n},{onComplete:function(){this.SDK.sendToServer(k.Action,{player:this.serverPlayer,team:this.serverTeam})}.bind(this)}).start()}else this.SDK.sendToServer(k.Action,{player:this.serverPlayer,team:this.serverTeam})}else this.serverTeam.pos=this.Player.jumpResult.offset,this.SDK.sendToServer(k.Action,{player:this.serverPlayer,team:this.serverTeam});this.uiRefresh()}}},{key:"onJumpDead",value:function(){this.serverTeam.perfectJump=0,D("跳跃失败","发送完成信号"),this.isControler=!1,this.SDK.sendToServer(k.Action,{player:this.serverPlayer,team:this.serverTeam}),this.uiRefresh()}},{key:"onPowerDown",value:function(){this.SDK.sendToRoom(P.Power,1),this.avatarSingal(!0,!1)}},{key:"onPowerUp",value:function(){var e={distance:this.Player.jumpResult.distance,pos:this.Player.jumpResult.offset,status:this.Player.jumpResult.status,time:this.Player.jumpResult.time,index:this.serverTeam.cur_cube,perfect:this.Player.jumpResult.perfect};this.SDK.sendToRoom(P.PowerEnd,e),this.SDK.sendToRoom(P.EnemyPowerEnd,e)}},{key:"timerSingalAction",value:function(){this.timerSingal&&this.timerSingal()}},{key:"drawMap",value:(s=z(regeneratorRuntime.mark((function e(t){var r,n,a,i,s,c,h,l,m,p,d,f,g,v,y,x=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(x.length>1&&void 0!==x[1]&&x[1])){e.next=25;break}return e.next=4,this.createBox(t[0]);case 4:r=e.sent,n={node:r,shape:R.cube,size:T.mini},this.map.push(n),a=null,i=n,s=1;case 10:if(!(s<t.length)){e.next=21;break}return c=t[s],e.next=14,this.createBox(c,i);case 14:a=e.sent,h={node:a,size:c[2],shape:c[3]},this.map.push(h),i=h;case 18:s++,e.next=10;break;case 21:this.nextBox=this.map[1],this.curBox=this.map[0],e.next=44;break;case 25:if(!(t.length>this.map.length)){e.next=44;break}D("检测到有新的地图数据",this.map.length,"--\x3e",t.length),l=this.map[this.map.length-1],m=null,p=this.map.length;case 30:if(!(p<t.length)){e.next=44;break}return d=t[p],D("开始生成地图节点",p,d),e.next=35,this.createBox(d,l,!0);case 35:m=e.sent,f={node:m,size:d[2],shape:d[3]},this.map.push(f),D("生成完成并push"),l=f,p==t.length-1&&(this.OtherTeam.nextBox||(this.OtherTeam.nextBox=f,this.OtherTeam.setFace()),this.nextBox||(D("新地图创建时为自己角色设置nextBox",f),this.nextBox=f,this.Player.nextBox=f,D("创建新节点时设置自己的next box时reset自己的player"),D("map reset"),this.Player.reset(),g=new o,v=new o,this.curBox.node.getPosition(g),y=new o,this.nextBox.node.getPosition(y),g.x=(g.x+y.x)/2,g.z=(g.z+y.z)/2,o.add(v,g,this._origin_camera_pos),u(this.camera.node).to(.5,{position:v},{onComplete:function(){}.bind(this)}).start()));case 41:p++,e.next=30;break;case 44:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"syncGameData",value:(n=z(regeneratorRuntime.mark((function e(t){var r,n,a,i,s,u,c,h,l,m,p,d,f,g,v,y,x=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x.length>1&&void 0!==x[1]&&x[1],e.next=3,this.SDK.getPlayerInfo();case 3:if(n=e.sent,a=null,i=null,D("同步游戏数据:",t),s="",u="",c=null,r?c=t:(c=t.data,s=t.teamId,u=t.senderId),h=n.teamId==s,l=n.id==u,"0"==n.teamId?(a=c[0],i=c[1]):(a=c[1],i=c[0]),!r){e.next=28;break}this.serverTeam=a,this.otherTeam=i,m=0;case 18:if(!(m<a.playerList.length)){e.next=26;break}if((p=a.playerList[m]).id!=n.id){e.next=23;break}return this.serverPlayer=p,e.abrupt("break",26);case 23:m++,e.next=18;break;case 26:e.next=42;break;case 28:if(!h||!l){e.next=41;break}this.serverTeam=a,d=0;case 31:if(!(d<a.playerList.length)){e.next=39;break}if((f=a.playerList[d]).id!=n.id){e.next=36;break}return this.serverPlayer=f,e.abrupt("break",39);case 36:d++,e.next=31;break;case 39:e.next=42;break;case 41:this.otherTeam=i;case 42:r?(this.OtherTeam.map=this.map,this.curBox=this.map[a.cur_cube],this.nextBox=this.map[a.cur_cube+1],this.Player.curBox=this.curBox,this.Player.nextBox=this.nextBox,this.OtherTeam.curBox=this.map[i.cur_cube],this.OtherTeam.nextBox=this.map[i.cur_cube+1],g=new o,v=new o,y=new o,this.curBox.node.getPosition(g),this.curBox.node.getPosition(y),y.y=0,o.add(v,g,this._origin_camera_pos),v.y=this._origin_camera_pos.y,this.camera.node.setPosition(v)):h&&l&&(t.sign||this.SDK.sendToRoom(P.SyncComplete,1),this.SDK.sendToServer(k.SyncComplete,this.SDK.gameManager.serverTeam.id),D("同步角色数据的时候,map长度",this.map.length),D("当前角色下标",this.serverTeam.cur_cube),this.curBox=this.map[this.serverTeam.cur_cube],this.nextBox=this.map[this.serverTeam.cur_cube+1],this.Player.curBox=this.curBox,this.Player.nextBox=this.nextBox,this.curBox&&(D("同步自己的数据时reset自己player"),this.Player.reset(this.serverTeam))),D("数据同步完成",this.serverPlayer,this.serverTeam);case 44:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"createBox",value:(r=z(regeneratorRuntime.mark((function e(){var t,r,n,a,i,s,c,h,l,p,d,f,y,x,_,b,B=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=B.length>0&&void 0!==B[0]?B[0]:null,r=B.length>1&&void 0!==B[1]?B[1]:null,n=B.length>2&&void 0!==B[2]&&B[2],a=new o,i=new o,s=t[0],c=t[1],h=t[2],l=t[3],p="",p=l==R.circle?"y":"f",p+=(h+1).toString(),d=this.BoxPrefab[p][m(0,this.BoxPrefab[p].length)],f=g(d),y=f.getChildByName("RootNode"),x=0;x<y.children.length;x++)_=y.children[x],(b=_.getComponent(v))&&(D("开启阴影"),b.shadowCastingMode=1);if(!r){e.next=32;break}if(r.node.getPosition(a),(i=a.clone()).y=0,c+=(C[r.size]+C[h])/2,1==s?i.z-=c:i.x+=c,n?f.setPosition(new o(i.x,5,i.z)):f.setPosition(new o(i.x,0,i.z)),f.setParent(this.Player.node.parent),!n){e.next=29;break}return u(f).to(.4,{position:i}).to(.15,{position:new o(i.x,1.5,i.z)}).to(.1,{position:i}).start(),e.abrupt("return",f);case 29:return e.abrupt("return",f);case 30:e.next=35;break;case 32:return f.setPosition(new o(0,0,0)),f.setParent(this.Player.node.parent),e.abrupt("return",f);case 35:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"clearMap",value:function(){var e=(this.serverTeam.cur_cube>this.otherTeam.cur_cube?this.otherTeam.cur_cube:this.serverTeam.cur_cube)-4;if(D("地图定时清除",e),e>0)for(var t=e;t>=0;t--){var r=this.map[t];if(!r.node)break;D("地图定时清除",t,r.node),r.node.destroy(),r.node=null}}},{key:"showScore",value:function(e){var t=this.node.parent.getChildByName("UI"),r=new o;this.Player.node.getPosition(r),r.y+=.5;var n=new o;this.camera.convertToUINode(r,t,n);var a=new i,s=a.addComponent(c),u=a.addComponent(h);s.setContentSize(35,25),u.string="+"+e,u.fontSize=15,a.setPosition(n),a.setParent(t),a.active=!0;var l={node:a,owner:this.Player.node,time:0};this.scoreNodeList.push(l)}},{key:"updateScoreNode",value:function(e){for(var t=new o,r=new o,n=this.node.parent.getChildByName("UI"),a=this.scoreNodeList.length-1;a>=0;a--){var i=this.scoreNodeList[a];i.owner.getPosition(t),t.y+=2*i.time+.5,this.camera.convertToUINode(t,n,r),i.node.setPosition(r),i.time+=e,i.time>1&&(i.node.destroy(),this.scoreNodeList.splice(a,1))}}},{key:"update",value:function(e){this.updateScoreNode(e),this.isRunning&&(this.clearTime+=e,this.clearTime>=60&&(this.clearTime=0,this.clearMap()))}},{key:"isControler",set:function(e){this._isControler=e,this.Player.control=e},get:function(){return this._isControler}},{key:"isRunning",set:function(e){this._isRunning=e,this.Player.isRunning=e,this.OtherTeam.isRunning=e},get:function(){return this._isRunning}}]),t}(l)).prototype,"playerPrfb",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=K(se.prototype,"BoxCubePrfb",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=K(se.prototype,"BoxCirclePrfb",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=K(se.prototype,"Player",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=K(se.prototype,"OtherTeam",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=K(se.prototype,"plane",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=K(se.prototype,"camera",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=K(se.prototype,"UI",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=se))||ie)),r._RF.pop()}}}));

System.register("chunks:///Interface.js",["cc"],(function(e,c){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"894b2eWkr1IfbbtaCcBLs2k","Interface",void 0),t._RF.pop()}}}));

System.register("chunks:///UI/Board/GamingUI.js",["cc","../../_virtual/_rollupPluginBabelHelpers.js"],(function(t,e){var i,n,o,a,s,c,r,h,l,d,u,y,g;return t({_dec:void 0,_class:void 0}),{setters:[function(t){i=t.cclegacy,n=t._decorator,o=t.Vec3,a=t.tween,s=t.Component},function(t){c=t.inherits,r=t.createClass,h=t.classCallCheck,l=t.possibleConstructorReturn,d=t.getPrototypeOf}],execute:function(){i._RF.push({},"b7379HiLIFODaP71KwyPtxD","GamingUI",void 0),g=n.ccclass,n.property,t("GamingUI",(u=g("GamingUI"),u(y=function(t){function e(){return h(this,e),l(this,d(e).apply(this,arguments))}return c(e,t),r(e,[{key:"start",value:function(){}},{key:"showEmoji",value:function(){var t=this.node.getChildByName("Interaction").getPosition().y;this.node.getChildByName("Interaction").active=!1,this.node.getChildByName("Interaction-ex").active=!0,this.node.getChildByName("Interaction-ex").setPosition(new o(250,t,0)),a(this.node.getChildByName("Interaction-ex")).to(.3,{position:{x:57,y:t,z:0}},{onComplete:function(){}.bind(this)}).start()}},{key:"hideEmoji",value:function(){var t=this.node.getChildByName("Interaction-ex").getPosition().y;a(this.node.getChildByName("Interaction-ex")).to(.3,{position:{x:250,y:t,z:0}},{onComplete:function(){this.node.getChildByName("Interaction-ex").active=!1,this.node.getChildByName("Interaction").active=!0}.bind(this)}).start()}}]),e}(s))||y)),i._RF.pop()}}}));

System.register("chunks:///UI/resultUI.js",["cc","../Const.js","../_virtual/_rollupPluginBabelHelpers.js"],(function(t,e){var n,s,a,i,u,o,r,c,l,p,m,f,h;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.cclegacy,s=t._decorator,a=t.Animation,i=t.Component},function(t){u=t.log},function(t){o=t.inherits,r=t.createClass,c=t.classCallCheck,l=t.possibleConstructorReturn,p=t.getPrototypeOf}],execute:function(){n._RF.push({},"8f98aNhGdlEqY/iWb0VOzE3","resultUI",void 0),h=s.ccclass,s.property,t("ResultUI",(m=h("ResultUI"),m(f=function(t){function e(){return c(this,e),l(this,p(e).apply(this,arguments))}return o(e,t),r(e,[{key:"start",value:function(){this.anima=this.node.getComponent(a),u("anima: ",this.anima),u("parent: ",this.node.getParent()),this.anima.defaultClip.events.push({frame:1,func:"test",params:[]}),this.anima.defaultClip.updateEventDatas()}},{key:"test",value:function(){var t=this;u("anima test"),this.anima.pause(),setTimeout((function(){t.anima.resume()}),1e3)}},{key:"mvpAnimaEnd",value:function(){u("mvp Anima end")}}]),e}(i))||f)),n._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../Config.js","../Const.js","../Player.js","../Util.js","../SDK.js","../UI/Dialog/Dialog.js","../UI/Board/BaseBoard.js","../UI/Board/WaitLoverBoard.js","../OtherPlayer.js","../UI/avatar.js","../UI/Board/GamingBoard.js","../UI/Board/MainBoard.js","../UI/Board/MatchingBoard.js","../UI/Board/ResultBoard.js","../GameManager.js","../Interface.js","../UI/Board/GamingUI.js","../UI/resultUI.js"],(function(n,o){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/Config.js', 'chunks:///Config.js');
  r('project:///assets/Scripts/Const.js', 'chunks:///Const.js');
  r('project:///assets/Scripts/Player.js', 'chunks:///Player.js');
  r('project:///assets/Scripts/Util.js', 'chunks:///Util.js');
  r('project:///assets/Scripts/SDK.js', 'chunks:///SDK.js');
  r('project:///assets/Scripts/UI/Dialog/Dialog.js', 'chunks:///UI/Dialog/Dialog.js');
  r('project:///assets/Scripts/UI/Board/BaseBoard.js', 'chunks:///UI/Board/BaseBoard.js');
  r('project:///assets/Scripts/UI/Board/WaitLoverBoard.js', 'chunks:///UI/Board/WaitLoverBoard.js');
  r('project:///assets/Scripts/OtherPlayer.js', 'chunks:///OtherPlayer.js');
  r('project:///assets/Scripts/UI/avatar.js', 'chunks:///UI/avatar.js');
  r('project:///assets/Scripts/UI/Board/GamingBoard.js', 'chunks:///UI/Board/GamingBoard.js');
  r('project:///assets/Scripts/UI/Board/MainBoard.js', 'chunks:///UI/Board/MainBoard.js');
  r('project:///assets/Scripts/UI/Board/MatchingBoard.js', 'chunks:///UI/Board/MatchingBoard.js');
  r('project:///assets/Scripts/UI/Board/ResultBoard.js', 'chunks:///UI/Board/ResultBoard.js');
  r('project:///assets/Scripts/GameManager.js', 'chunks:///GameManager.js');
  r('project:///assets/Scripts/Interface.js', 'chunks:///Interface.js');
  r('project:///assets/Scripts/UI/Board/GamingUI.js', 'chunks:///UI/Board/GamingUI.js');
  r('project:///assets/Scripts/UI/resultUI.js', 'chunks:///UI/resultUI.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});
} }; });