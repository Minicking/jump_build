System.register([], function(_export, _context) { return { execute: function () {
System.register("chunks:///Box.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,i){var a,e,s,l,c,o,n,h,_,r,u,f;return t({_dec:void 0,_class:void 0}),{setters:[function(t){a=t.inherits,e=t.createClass,s=t.classCallCheck,l=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){o=t.cclegacy,n=t._decorator,h=t.Vec3,_=t.Component}],execute:function(){o._RF.push({},"6643c+mADFPg59fhSVi8+Su","Box",void 0),f=n.ccclass,n.property,t("Box",(r=f("Box"),r(u=function(t){function i(){return s(this,i),l(this,c(i).apply(this,arguments))}return a(i,t),e(i,[{key:"onLoad",value:function(){this.time_elastic=0,this.time_power=0,this.time_fall=0,this.action_elastic=!1,this.action_power=!1,this.action_fall=!1,this.data_elastic={},this.data_fall={},this.cycle_elastic=10}},{key:"onTouchDown",value:function(t){this.action_power||(this.action_power=!0)}},{key:"onTouchUp",value:function(t){this.action_power&&(this.action_power=!1,this.startElastic())}},{key:"startElastic",value:function(){this.time_elastic=0,this.action_elastic=!0,this.data_elastic.origin_scale_y=this.node.getScale().y,this.data_elastic.A=this.data_elastic.origin_scale_y-1}},{key:"startFall",value:function(){this.time_fall=0,this.action_fall=!0,this.data_fall.speed=0,this.data_fall.g=20,this.data_fall.k=.4}},{key:"actionElastic",value:function(t){if(this.action_elastic){this.time_elastic+=t;var i=this.data_elastic.A*(1/(1+10*this.time_elastic)),a=i*Math.cos(this.time_elastic*this.cycle_elastic);this.node.setScale(new h(1,1+a,1)),Math.abs(i)<.03&&(this.node.setScale(new h(1,1,1)),this.action_elastic=!1)}}},{key:"actionPower",value:function(t){if(this.action_power){this.time_power+=t;var i=1-2*this.time_power;i<.1?(this.action_power=!1,this.startElastic()):this.node.setScale(new h(1,i,1))}}},{key:"actionFall",value:function(t){if(this.action_fall){this.time_fall+=t;var i=this.node.getPosition();this.data_fall.speed+=this.data_fall.g*t;var a=this.data_fall.speed*t;i.y-=a,i.y<=0&&(this.data_fall.speed*=-1*this.data_fall.k,i.y=0),Math.abs(this.data_fall.speed)<=.1&&i.y<=.1&&(i.y=0,this.action_fall=!1),this.node.setPosition(i)}}},{key:"update",value:function(t){this.actionElastic(t),this.actionFall(t)}}]),i}(_))||u)),o._RF.pop()}}}));

System.register("chunks:///Config.js",["cc"],(function(e,i){var t,n,a,o,c;return e("EnvType",void 0),{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"1c95bfLt8hDMI/mY7kSxKrA","Config",void 0),function(e){e[e.online=0]="online",e[e.develop=1]="develop"}(n||e("EnvType",n={})),e("Env",a=n.online),e("UseSign",!0),e("UseDebug",!0),e("UseLog",!0),e("DebugGameTime",5),e("config",o={matchCode:"match-auuc635m",gameId:"obg-8lfv7afz",secretKey:"",initConfig:{url:"8lfv7afz.wxlagame.com",reconnectMaxTimes:5,reconnectInterval:1e3,resendInterval:1e3,resendTimeout:1e4,isAutoRequestFrame:!0}}),e("serverURL",c={gameInit:"https://dev-api.didiapp.com/client/awesome/game/jump/info/",accountInit:"https://dev-api.didiapp.com/client/account/user/info/",vipInfo:"https://dev-api.didiapp.com/client/account/user/vip/",sign:"https://dev-api.didiapp.com/client/awesome/game/jump/sign"}),/((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/.test(location.host)||location.host.indexOf("localhost")>-1||location.host.indexOf("dev-")>-1?(c.gameInit="https://dev-api.didiapp.com/client/awesome/game/jump/info/",c.accountInit="https://dev-api.didiapp.com/client/account/user/info/",c.sign="https://dev-api.didiapp.com/client/awesome/game/jump/sign",c.vipInfo="https://dev-api.didiapp.com/client/account/user/vip/"):"xlab"===location.host.substr(0,4)?(c.gameInit="https://xlab-api.didiapp.com/client/awesome/game/jump/info/",c.accountInit="https://xlab-api.didiapp.com/client/account/user/info/",c.sign="https://xalb-api.didiapp.com/client/awesome/game/jump/sign",c.vipInfo="https://xlab-api.didiapp.com/client/account/user/vip/"):(c.gameInit="https://api.didiapp.com/client/awesome/game/jump/info/",c.accountInit="https://api.didiapp.com/client/account/user/info/",c.sign="https://api.didiapp.com/client/awesome/game/jump/sign",c.vipInfo="https://api.didiapp.com/client/account/user/vip/"),a==n.develop&&(o.gameId="obg-6hgl7n1x",o.secretKey="56b5d33b7bafe1fc5a7f8b34e7486a214dee172a",o.matchCode="match-rezk4kbg",o.initConfig.url="6hgl7n1x.wxlagame.com"),t._RF.pop()}}}));

System.register("chunks:///Const.js",["cc","./Config.js"],(function(e,t){var n,o,a,r,c,i,l,u,p,y;return e({log:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var a;n[0]="［"+n[0]+"]",n.unshift("["+((a=new Date).getHours()+":"+a.getMinutes()+":"+a.getSeconds()+":"+a.getMilliseconds())+"]:"),(e=console).log.apply(e,n)},BoxShape:void 0,JumpStatus:void 0,AIDataType:void 0,ServerDataType:void 0,ClientDataType:void 0,RoomDataType:void 0,EmojiType:void 0,DialogButtonType:void 0}),{setters:[function(e){n=e.cclegacy,o=e.Color},function(e){}],execute:function(){n._RF.push({},"286ccI0TulGCrD81NytQWoS","Const",void 0),function(e){e[e.cube=0]="cube",e[e.circle=1]="circle"}(a||e("BoxShape",a={})),e("BoxSizeName",{mini:0,small:1,middle:2,large:3,huge:4,center:5}),e("BoxSize",{0:1.3,1:1.833,2:2.249,3:2.6,4:2.24*1.3,5:.26}),function(e){e[e.next=0]="next",e[e.current=1]="current",e[e.dead=2]="dead"}(r||e("JumpStatus",r={})),function(e){e[e.StartJump=0]="StartJump"}(c||e("AIDataType",c={})),function(e){e[e.Error=-1]="Error",e[e.Init=0]="Init",e[e.Sync=1]="Sync",e[e.Result=2]="Result",e[e.Start=3]="Start",e[e.Reconnect=4]="Reconnect",e[e.Map=5]="Map",e[e.NetState=6]="NetState",e[e.ChangeControler=7]="ChangeControler",e[e.ReconnectFailed=8]="ReconnectFailed",e[e.AI=9]="AI"}(i||e("ServerDataType",i={})),function(e){e[e.Ready=0]="Ready",e[e.Action=1]="Action",e[e.End=2]="End",e[e.Reconnect=3]="Reconnect",e[e.ChangeControler=4]="ChangeControler",e[e.ReconnectComplete=5]="ReconnectComplete",e[e.Heart=6]="Heart",e[e.RequestInitData=7]="RequestInitData",e[e.RequestSyncData=8]="RequestSyncData",e[e.SyncComplete=9]="SyncComplete",e[e.JumpComplete=10]="JumpComplete"}(l||e("ClientDataType",l={})),function(e){e[e.EnemyPowerEnd=0]="EnemyPowerEnd",e[e.Power=1]="Power",e[e.PowerEnd=2]="PowerEnd",e[e.emoji=3]="emoji",e[e.SyncComplete=4]="SyncComplete",e[e.MatchedJoinGroup=5]="MatchedJoinGroup"}(u||e("RoomDataType",u={})),function(e){e[e.Angry=0]="Angry",e[e.Worship=1]="Worship",e[e.Unfortunately=2]="Unfortunately",e[e.Applause=3]="Applause"}(p||e("EmojiType",p={})),e("PlayerState",{NotReady:0,Ready:1}),e("NetState",{Offline:0,Online:1}),e("GroupMessageType",{Sys:1,Talk:2}),e("GroupSysMessageType",{Matching:1}),e("LabelColor",{Captain:new o(46,139,33),Ready:new o(46,139,33),NotReady:new o(131,123,123)}),function(e){e[e.single=0]="single",e[e.multiple=1]="multiple"}(y||e("DialogButtonType",y={})),e("TeamColor",{red:"0",blue:"1"}),n._RF.pop()}}}));

System.register("chunks:///quan.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,a,s,i,o,r,c,l,u,h,p,d,f,m,v;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,a=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf,o=t.createClass},function(t){r=t.cclegacy,c=t._decorator,l=t.Vec3,u=t.MeshRenderer,h=t.tween,p=t.Vec4,d=t.Component}],execute:function(){r._RF.push({},"88109mMvhFPC4a/ipJ0aAXk","quan",void 0),v=c.ccclass,c.property,t("Quan",(f=v("Quan"),f(m=function(t){function e(){var t,n;a(this,e);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return(n=s(this,(t=i(e)).call.apply(t,[this].concat(r)))).originState=new l(0,0,0),n.startState=new l(.5,1,.5),n.endState=new l(4,1,4),n}return n(e,t),o(e,[{key:"start",value:function(){this.material=this.node.getComponent(u).materials[0],this.pass=this.material.passes[0],this.node.setScale(this.originState)}},{key:"startAnimation",value:function(){var t=this;this.node.setScale(this.startState),h(this.node).to(.5,{scale:this.endState},{onComplete:function(){t.node.setScale(t.originState)},onUpdate:function(e,n){t.pass.setUniform(t.pass.getHandle("mainColor"),new p(1,1,1,1-n))}}).start()}}]),e}(d))||m)),r._RF.pop()}}}));

System.register("chunks:///Player.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Box.js","./Const.js","./quan.js"],(function(t,e){var i,s,o,n,a,r,h,u,l,m,p,d,c,g,_,f,y,v,P,w,j,x,R,B,T,b,C,k,M,A,z,S,H,I,N,D,U,F,J,Y,E,O,q,G;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,s=t.inherits,o=t.classCallCheck,n=t.possibleConstructorReturn,a=t.getPrototypeOf,r=t.initializerDefineProperty,h=t.assertThisInitialized,u=t.createClass,l=t.asyncToGenerator},function(t){m=t.cclegacy,p=t._decorator,d=t.Vec3,c=t.Quat,g=t.Prefab,_=t.CCFloat,f=t.Vec2,y=t.systemEvent,v=t.SystemEvent,P=t.ParticleSystem,w=t.tween,j=t.Component,x=t.instantiate,R=t.loader},function(t){B=t.Box},function(t){T=t.log,b=t.JumpStatus,C=t.ClientDataType,k=t.BoxSizeName,M=t.BoxSize},function(t){A=t.Quan}],execute:function(){m._RF.push({},"06087OdteJF9alMqGeb4DFG","Player",void 0),O=p.ccclass,q=p.property,new d,new d,G=new c,new c,t("Player",(z=O("Player"),S=q({type:g}),H=q({type:_}),I=q({type:_}),N=q({type:_}),z((F=i((U=function(t){function e(){var t,i;o(this,e);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return i=n(this,(t=a(e)).call.apply(t,[this].concat(u))),r(i,"playerPrfb",F,h(i)),r(i,"jumpHeight",J,h(i)),r(i,"jumpDuration",Y,h(i)),r(i,"max_time",E,h(i)),i.originPosY=0,i.originRotation=new c(0,1,0,0),i.curRotation=new c,i.curPostion=new d,i._jump_time=0,i.jumpResult={time:null,distance:null,offset:null,status:null,perfect:!1},i._face=new f,i._axis=new d,i._stat_power=!1,i._stat_jump=!1,i.curBox=null,i.nextBox=null,i._isRunning=!1,i._control=!1,i.is_controler=!1,i.modelBody=null,i.modelHead=null,i.modelHeadPos=new d,i.modelTire=null,i.AI=!1,i.AI_power=!1,i.AI_jump=!1,i}var i,m;return s(e,t),u(e,[{key:"onLoad",value:function(){this.node.getRotation(G)}},{key:"initEvent",value:function(){this.node.on("SetFace",this.onSetFace,this)}},{key:"initPlayer",value:function(){var t=new d(this.gameManager.serverTeam.pos[0],this.originPosY,this.gameManager.serverTeam.pos[1]);this.node.setPosition(t),this.node.setRotation(this.originRotation),this.curPostion=t,this._isRunning=!1,this._control=!1,this.is_controler=!1,this._jump_time=0,this.AI_power=!1,this.AI_jump=!1,this._stat_power=!1,this._stat_jump=!1}},{key:"onSetFace",value:function(t){}},{key:"start",value:function(){this.originPosY=this.node.position.y,this.quan=this.node.getChildByName("quan").getComponent(A),this.node.getRotation(this.curRotation),this.initEvent(),y.on(v.EventType.TOUCH_START,this.onTouchDown,this),y.on(v.EventType.TOUCH_END,this.onTouchUp,this)}},{key:"onTouchDown",value:function(t){this.control&&this.is_controler&&0==this._stat_power&&0==this._stat_jump&&(this.particleOpen(!0),this.gameManager.Util.playAudio(this.gameManager.audio_touch_down),this.onPowerDown(),this._stat_power=!0,this.jumpResult.time=0,this._control=!1)}},{key:"onTouchUp",value:function(t){if(this._stat_power&&this.is_controler){T("设置power","松开蓄力"),this._stat_power=!1,this.modelBody.setScale(new d(1,1,1)),this.modelHead.setPosition(this.modelHeadPos),this.modelTire&&this.modelTire.setPosition(new d(0,0,0));var e=new d;this.node.getPosition(e),e.y=this.originPosY,this.node.setPosition(e),this.start_jump()}}},{key:"teammatePower",value:function(){0==this.control&&(this.jumpResult.time=0,this._stat_power=!0,this.particleOpen(!0))}},{key:"teammatePowerEnd",value:function(t){if(0==this.control){T("设置power","队友松开蓄力"),this._stat_power=!1,this.modelBody.setScale(new d(1,1,1)),this.modelHead.setPosition(this.modelHeadPos),this.modelTire&&this.modelTire.setPosition(new d(0,0,0));var e=new d;this.node.getPosition(e),e.y=this.originPosY,this.node.setPosition(e),this.start_jump(t)}}},{key:"funnction_jump",value:function(t){return 7*t*t+5*t}},{key:"start_jump",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.particleOpen(!1);var e=!1;if(!this._stat_power){var i=this.node.getChildByName("Node").getChildByName("body").getComponent(P);if(i&&(i.enabled=!0),this._stat_jump=!0,this._jump_time=0,this.getFace(this._face),this._axis=this.gameManager.Util.getJumpAxis(this.node,this.nextBox.node),this.node.getRotation(this.curRotation),this.node.getPosition(this.curPostion),this.curBox.node.getComponent(B).startElastic(),null==t){e=!0,this.jumpResult.distance=this.funnction_jump(this.jumpResult.time);var s=new d,o=new d,n=new d,a=new f,r=null,h=!1,u=null;this.node.getPosition(n),this.curBox.node.getPosition(o),this.nextBox.node.getPosition(s),this.getFace(a),a.normalize(),a.multiplyScalar(this.jumpResult.distance),a.x+=n.x,a.y+=n.z;var l=new f(999,999);this.gameManager.Util.posInBox(a,new f(s.x,s.z),this.nextBox.size,this.nextBox.shape,l)?(r=[a.x-s.x,a.y-s.z],u=b.next,l.x<.325&&(h=!0)):this.gameManager.Util.posInBox(a,new f(o.x,o.z),this.curBox.size,this.curBox.shape)?(r=[a.x-o.x,a.y-o.z],u=b.current):(u=b.dead,r=[a.x-s.x,a.y-s.z]),this.jumpResult.offset=r,this.jumpResult.status=u,this.jumpResult.perfect=h,this.onPowerUp()}else T("队友此次跳跃的结果",t),this.jumpResult.distance=t.distance,this.jumpResult.offset=t.pos,this.jumpResult.status=t.status,this.jumpResult.time=t.time,this.jumpResult.perfect=t.perfect;var m={id:this.gameManager.serverTeam.id,cur_cube:this.gameManager.serverTeam.cur_cube,pos:this.gameManager.serverTeam.pos,perfectJump:this.gameManager.serverTeam.perfectJump,oneStepFinish:this.gameManager.serverTeam.oneStepFinish,playerList:this.gameManager.serverTeam.playerList},p={score:this.gameManager.serverPlayer.score,id:this.gameManager.serverPlayer.id,avatar:this.gameManager.serverPlayer.avatar,status:this.gameManager.serverPlayer.status,teamId:this.gameManager.serverPlayer.teamId,name:this.gameManager.serverPlayer.name};switch(this.jumpResult.status){case b.next:if(m.cur_cube+=1,m.pos=this.jumpResult.offset,this.jumpResult.perfect?m.perfectJump+=1:m.perfectJump=0,e){var c=this.gameManager.Util.getScore(m.perfectJump);p.score+=c}break;case b.current:m.pos=this.jumpResult.offset,m.perfectJump=0;break;default:m.perfectJump=0}this.gameManager.SDK.sendToServer(C.Action,{player:p,team:m,status:this.jumpResult.status})}}},{key:"action_power",value:function(t){if(this._stat_power){if(this.jumpResult.time+=t,this.jumpResult.time<this.max_time){var e=new d;this.node.getPosition(e),e.y=this.originPosY-this.jumpResult.time/this.max_time*.776,this.node.setPosition(e);var i=new d;if(this.modelHead.getPosition(i),i.y=this.modelHeadPos.y-this.jumpResult.time/this.max_time*.572,this.modelHead.setPosition(i),this.modelTire){var s=new d;this.modelTire.getPosition(s),s.y=this.jumpResult.time/this.max_time*-.572,this.modelTire.setPosition(s)}var o=new d;this.curBox.node.getScale(o),o.y=1-this.jumpResult.time/this.max_time*.5,this.curBox.node.setScale(o),this.modelBody.setScale(o)}else this.jumpResult.time>this.max_time+2&&(this.jumpResult.time=this.max_time,this.onTouchUp(1));if(this.AI&&this.AI_power&&!this.AI_jump&&this.nextBox){var n=this.funnction_jump(this.jumpResult.time),a=new d,r=new d,h=new f;this.getFace(h),h.normalize(),h.multiplyScalar(n),this.node.getPosition(a),this.nextBox.node.getPosition(r),h.x+=a.x,h.y+=a.z;var u=new f(h.x,h.y),l=new f(r.x,r.z),m=new f;if(this.gameManager.Util.posInBox(u,l,k.center,this.nextBox.shape,m),m.x<=M[k.center]/2||this.jumpResult.time>=this.max_time){T("设置power","AI松开蓄力"),this._stat_power=!1,this.modelBody.setScale(new d(1,1,1)),this.modelHead.setPosition(this.modelHeadPos),this.modelTire&&this.modelTire.setPosition(new d(0,0,0));var p=new d;this.node.getPosition(p),p.y=this.originPosY,this.node.setPosition(p),this.AI_jump=!0,this.AI_power=!1,this.start_jump()}}}}},{key:"action_jump",value:function(t){if(this._stat_jump){this._jump_time+=t;var e=0,i=0,s=0,o=!1;if(this._jump_time<this.jumpDuration){var n=-4*this.jumpHeight/(this.jumpDuration*this.jumpDuration),a=this.jumpDuration/2,r=this.jumpHeight;e=n*(this._jump_time-a)*(this._jump_time-a)+r+this.originPosY,i=t/this.jumpDuration*this.jumpResult.distance,s=this._jump_time/this.jumpDuration*360}else e=this.originPosY,s=0,this._stat_jump=!1,o=!0;var h=new d;this.node.getPosition(h);var u=this.gameManager.Util.getPosWithVec(h,this._face,i);u.y=e,c.rotateAround(G,this.curRotation,this._axis,3.1415*s/180),this.node.setPosition(u),this.node.setRotation(G),o&&(this.AI_jump=!1,this.action_jump_end())}}},{key:"action_jump_end",value:function(){var t=new d;this.node.getPosition(t),T("跳跃结果","基本数据:",this.jumpResult);var e=this.node.getChildByName("Node").getChildByName("body").getComponent(P);if(e&&(e.enabled=!1),this.jumpResult.status==b.current){T("跳跃结果","原地跳"),T("修正量",this.jumpResult.offset);var i=new d;this.curBox.node.getPosition(i),i.x+=this.jumpResult.offset[0],i.z+=this.jumpResult.offset[1],i.y=this.originPosY,T("修正后的坐标",i),this.node.setPosition(i),this.node.getPosition(this.curPostion),this.onJumpComplete(!1,this.is_controler)}else if(this.jumpResult.status==b.next){T("跳跃结果","跳到下一块"),T("修正量:",this.jumpResult.offset);var s=new d;this.nextBox.node.getPosition(s),s.x+=this.jumpResult.offset[0],s.z+=this.jumpResult.offset[1],s.y=this.originPosY,T("修正后的坐标",s),this.node.setPosition(s),this.node.getPosition(this.curPostion),this.onJumpComplete(!0,this.is_controler)}else if(this.jumpResult.status==b.dead){T("跳跃结果","跳跃失败");var o=new d;this.nextBox.node.getPosition(o),o.x+=this.jumpResult.offset[0],o.z+=this.jumpResult.offset[1],o.y=this.originPosY,T("修正后的坐标",o),this.node.setPosition(o);var n=o;n.y=-.5,this.gameManager.Util.playAudio(this.gameManager.audio_dead),w(this.node).to(.6,{position:n},{onComplete:this.jumpDead.bind(this)}).start()}}},{key:"jumpDead",value:function(){this.onJumpDead(),this.node.setPosition(this.curPostion),this.gameManager.Util.playAudio(this.gameManager.audio_relife)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(T("重置角色数据",t),t){var e=new d;this.curBox.node.getPosition(e),e.x+=t.pos[0],e.z+=t.pos[1],e.y=this.originPosY,this.node.setPosition(e);var i=new d;this.node.getPosition(i),T("角色重置后的位置",e,i),this.modelTire&&this.modelTire.setPosition(new d(0,0,0)),this.modelHead&&this.modelHead.setPosition(this.modelHeadPos),this.modelBody&&this.modelBody.setScale(new d(1,1,1))}else this.node.setPosition(this.curPostion);this.particleOpen(!1),this.node.setRotation(this.originRotation),this.node.getPosition(this.curPostion),T("设置power","reset"),this._stat_power=!1,this._stat_jump=!1,this.AI_power=!1,this.AI_jump=!1,this.curBox.node.setScale(new d(1,1,1))}},{key:"setFace",value:function(){var t=this;if(this.nextBox){var e=w(this.node),i=new c;this.node.getRotation(i);var s=this.gameManager.Util.getRotaionQuat(this.node,this.nextBox.node),o=new c;e.to(.2,{},{onUpdate:function(e,n){o.set(i).slerp(s,n),t.node.setRotation(o)}}),e.start()}}},{key:"particleOpen",value:function(t){this.node.getChildByName("Node").getChildByName("body").getChildByName("Particle").active=t}},{key:"getFace",value:function(t){new f;var e=new d,i=new d;this.node.getPosition(e),this.nextBox.node.getPosition(i),t.set(i.x-e.x,i.z-e.z)}},{key:"setModel",value:(m=l(regeneratorRuntime.mark((function t(e){var i,s,o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e-=1,i=this.gameManager.ChessPrefab,!(e>=i.length||e<0)){t.next=4;break}return t.abrupt("return");case 4:return(s=this.node.getChildByName("Node"))&&this.node.removeChild(s),o=this.gameManager.ChessPrefab[e],T("PREFAB",o,e),(n=x(o)).setParent(this.node),this.modelHead=n.getChildByName("head"),this.modelBody=n.getChildByName("body"),this.modelHead.getPosition(this.modelHeadPos),t.abrupt("return",!0);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"setTire",value:(i=l(regeneratorRuntime.mark((function t(e){var i,s,o,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=1===t.t0?3:5;break;case 3:return i="vip",t.abrupt("break",6);case 5:return t.abrupt("return",!1);case 6:return(s=this.node.getChildByName("Tire").getChildByName("Node"))&&this.node.getChildByName("Tire").removeChild(s),o="Model/Tire/"+i+"/Node",new Promise((function(t){R.loadRes(o,g,(function(e,i){var s=x(i);s.setParent(n.node.getChildByName("Tire")),n.modelTire=s,t(s)}))})),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"update",value:function(t){this.isRunning&&(this.AI&&this.control&&(0!=this._stat_power||0!=this._stat_jump||this.AI_jump||this.AI_power||(this.onPowerDown(),this.AI_power=!0,this._stat_power=!0,this.jumpResult.time=0,this._control=!1)),this.action_power(t),this.action_jump(t))}},{key:"control",set:function(t){T("设置Player控制:",t),this._control=t,this.is_controler=t},get:function(){return this._control}},{key:"isRunning",set:function(t){this._isRunning=t},get:function(){return this._isRunning}}]),e}(j)).prototype,"playerPrfb",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=i(U.prototype,"jumpHeight",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),Y=i(U.prototype,"jumpDuration",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.7}}),E=i(U.prototype,"max_time",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),D=U))||D)),m._RF.pop()}}}));

System.register("chunks:///Util.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Const.js"],(function(e,t){var r,n,a,i,o,s,u,c,l,m,g,p,f,h,v,d,y,x,k,b;return{setters:[function(e){r=e.createClass,n=e.classCallCheck,a=e.asyncToGenerator},function(e){i=e.cclegacy,o=e._decorator,s=e.Vec2,u=e.Rect,c=e.Vec3,l=e.Quat,m=e.Texture2D,g=e.ImageAsset,p=e.SpriteFrame,f=e.Sprite,h=e.loader,v=e.Prefab,d=e.AudioSource,y=e.Node},function(e){x=e.BoxShape,k=e.log,b=e.BoxSize}],execute:function(){i._RF.push({},"ce5d5zghdhNhJ8k219NUh+H","Util",void 0),o.ccclass,o.property,e("Util",function(){function e(t,r){n(this,e),this.SDK=t,this.gameManager=r}var t,i,o,w,S,I;return r(e,[{key:"posInBox",value:function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=b[r]/2;if(a&&(a.x=s.distance(e,t)),n==x.cube){var o=new u,c=new s(t.x-i,t.y+i),l=new s(t.x+i,t.y-i);return u.fromMinMax(o,c,l),o.contains(e)}return s.distance(e,t)<i}},{key:"getJumpAxis",value:function(e,t){var r=new c,n=new c,a=new c(0,0,0);e.getPosition(r),t.getPosition(n);var i=r.z-n.z,o=n.x-r.x;return a.set(-i,0,-o),a.normalize(),a}},{key:"getRotaionQuat",value:function(e,t){var r=new c,n=new c,a=new s(0,1),i=new s,o=new l;o.lengthSqr(),e.getPosition(r),t.getPosition(n),i.set(n.x-r.x,n.z-r.z);var u=i.signAngle(a);return u<0&&(u+=6.2831852),l.rotateY(o,o,u),o}},{key:"getPosWithVec",value:function(e,t,r){return t.normalize(),t.multiplyScalar(r),new c(e.x+t.x,0,e.z+t.y)}},{key:"getScore",value:function(e){if(e<=0)return 1;if(1==e)return 2;if(2==e)return 4;var t=4+4*(e-2);return t>32&&(t=32),t}},{key:"getLocalTime",value:function(){return Math.floor(Date.parse((new Date).toString())/1e3)}},{key:"isControler",value:function(e,t){for(var r=!1,n=0;n<e.length;n++){if(e[n].id==t.id){r=!0;break}}return r}},{key:"getPara",value:function(e,t){var r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=t.substr(1).match(r);return null!=n?decodeURI(n[2]):null}},{key:"teammaterIsLover",value:(I=a(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.SDK.gameManager.teammaterIsLover){e.next=2;break}return e.abrupt("return",this.SDK.gameManager.teammaterIsLover);case 2:return e.next=4,this.SDK.getTeammate();case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:return r=JSON.parse(t.customProfile),this.SDK.gameManager.teammaterIsLover=r.lover_id==this.SDK.gameManager.PlayerData.lover_id,e.abrupt("return",this.SDK.gameManager.teammaterIsLover);case 10:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"enemyIsLover",value:(S=a(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.SDK.gameManager.enemyIsLover){e.next=2;break}return e.abrupt("return",this.SDK.gameManager.enemyIsLover);case 2:return e.next=4,this.SDK.getRoomInfo();case 4:return t=e.sent,e.next=7,this.SDK.getPlayerInfo();case 7:if(r=e.sent,t){e.next=10;break}return e.abrupt("return",!1);case 10:i=t.playerList,o=0;case 12:if(!(o<i.length)){e.next=24;break}if((s=i[o]).teamId==r.teamId){e.next=21;break}if(!n){e.next=20;break}return a=JSON.parse(s.customProfile),e.abrupt("break",24);case 20:n=JSON.parse(s.customProfile);case 21:o++,e.next=12;break;case 24:return this.SDK.gameManager.enemyIsLover=n.lover_id==a.lover_id,e.abrupt("return",this.SDK.gameManager.enemyIsLover);case 26:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"enemyIsVip",value:(w=a(regeneratorRuntime.mark((function e(){var t,r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getRoomInfo();case 2:return t=e.sent,r=t.playerList,e.next=6,this.SDK.getPlayerInfo();case 6:n=e.sent,a=0;case 8:if(!(a<r.length)){e.next=17;break}if((i=r[a]).teamId==n.teamId){e.next=14;break}if(!JSON.parse(i.customProfile).isVip){e.next=14;break}return e.abrupt("return",!0);case 14:a++,e.next=8;break;case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"loadRemoteImg",value:function(e,t){var r=this,n=new Image;n.crossOrigin="Anonymous",n.src=e,n.onload=function(){k("加载远程图片",n);var e=new m;e.image=new g(n);var r=new p;r.texture=e,t.getComponent(f).spriteFrame=r},n.onerror=function(e){k("加载远程图片失败: ",e),r.loadImg("/Texture/UI/main/bg/spriteFrame",t)}}},{key:"loadImg",value:(o=a(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k("加载本地图片",t),e.abrupt("return",new Promise((function(e){h.loadRes(t,p,(function(t,n){if(t)throw e(!1),t;r.getComponent(f).spriteFrame=n,e(!0)}))})));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"http",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new Promise((function(i,o){k("发送http",e);var s=new XMLHttpRequest;s.open(t,e,!0),n&&(s.responseType="blob"),s.onreadystatechange=function(){if(4==s.readyState)if(k("request",s),s.status>=200&&s.status<300){var e=s.responseText;i(JSON.parse(e))}else i(null)},s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("Access-Control-Allow-Origin","*"),a&&s.setRequestHeader("access_token",a),s.send(r)}))}},{key:"loadPrefab",value:(i=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){h.loadRes(t,v,(function(r,n){r?e(null):(k("加载预制件",t,n),e(n))}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"loadBoxPrefab",value:function(e,t,r){var n=this;h.loadRes(e,v,(function(a,i){a||(k("加载盒子预制件",e,i),n.gameManager.BoxPrefab[t][r]=i)}))}},{key:"setAvatar",value:(t=a(regeneratorRuntime.mark((function e(t,r,n){var a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.profile?JSON.parse(r.profile):JSON.parse(r.customProfile),this.loadRemoteImg(a.avatar_url,t),t.getChildByName("isVip")&&(!a.isVip&&(t.getChildByName("isVip").active=!1),a.isVip&&(t.getChildByName("isVip").active=!0)),t.getChildByName("gender")&&(1===a.gender&&this.loadImg("/Texture/UI/result/boy/spriteFrame",t.getChildByName("gender")),2===a.gender&&this.loadImg("/Texture/UI/result/girl/spriteFrame",t.getChildByName("gender"))),e.next=6,this.SDK.getPlayerInfo();case 6:if(i=e.sent,!n){e.next=20;break}if(r.id!==i.id){e.next=19;break}if(!t.getChildByName("me")){e.next=11;break}return e.abrupt("return",t.getChildByName("me").active=!0);case 11:o=new y("me"),s=new c(0,74,0),o.addComponent(f),this.loadImg("/Texture/UI/gaming/me/spriteFrame",o),t.addChild(o),o.setPosition(s),e.next=20;break;case 19:t.getChildByName("me")&&(t.getChildByName("me").active=!1);case 20:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"loverLevel",value:function(e){for(var t=[50,100,200,500,1e3,2e3,3e3,5e3,7e3,1e4],r=0;r<t.length;r++){if((e-=t[r])<0)return r}return 10}},{key:"playAudio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.gameManager.Setting.switch_audio&&this.gameManager.getComponent(d).playOneShot(e,t)}}]),e}()),i._RF.pop()}}}));

System.register("chunks:///SDK.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Config.js","./Const.js"],(function(e,r){var t,n,a,u,o,i,s,c,p,f;return{setters:[function(e){t=e.createClass,n=e.classCallCheck,a=e.asyncToGenerator},function(e){u=e.cclegacy},function(e){o=e.config,i=e.serverURL},function(e){s=e.log,c=e.ClientDataType,p=e.PlayerState,f=e.RoomDataType}],execute:function(){u._RF.push({},"33e872liaNCrpH3cX9cDkX4","SDK",void 0),e("SDK",function(){function e(){n(this,e),this.Listener=MGOBE.Listener,this.Room=MGOBE.Room,this.curRoom=null,this.curGroup=null,this.curBoard=null,this.curDialog=null,this.gameManager=null,this.errorCode=MGOBE.ErrCode,this.curRoom=new MGOBE.Room,this.curGroup=new MGOBE.Group}var r,u,m,l,h,g,d,y,v,k,R,P,G,x,b,w,I,M,E,S,O,C,L,T;return t(e,[{key:"init",value:function(e,r){var t=this;return new Promise((function(n){var a=i.sign+"/?game_id="+o.gameId+"&open_id="+e,u={gameId:o.gameId,openId:e,createSignature:function(e){fetch(a).then((function(e){return e.json()})).then((function(r){var t=r.sign,n=r.nonce,a=r.timestamp;return s("sign",t,n,a),e({sign:t,nonce:n,timestamp:a})}))}};t.Listener.init(u,o.initConfig,(function(e){e.code===MGOBE.ErrCode.EC_OK?(t.Listener.add(t.curRoom),t.gameManager=r,s("正式环境初始化成功"),n(!0)):(s("正式环境初始化失败",e.code),n(!1))}))}))}},{key:"matchingSingle",value:(T=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return r=e.sent,t={name:r.name,customPlayerStatus:r.stateRoom,customProfile:r.profile,matchAttributes:[]},n={playerInfo:t,matchCode:o.matchCode},a=new Promise((function(e){u.curRoom.matchPlayers(n,(function(r){e(r.code)}))})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"matchingLover",value:(L=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u,i,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:if(e.sent){e.next=6;break}return s("没有处于足够人数的队组中"),e.abrupt("return");case 6:return e.next=8,this.getPlayerInfo();case 8:return r=e.sent,e.next=11,this.getLoverInfo();case 11:if(t=e.sent){e.next=15;break}return s("情侣未在队组中,进入匹配失败"),e.abrupt("return");case 15:return n={id:r.id,name:r.name,customProfile:r.profile,customPlayerStatus:r.stateGroup,matchAttributes:[]},a={id:t.id,name:t.name,customProfile:t.profile,customPlayerStatus:t.stateGroup,matchAttributes:[]},u={playerInfoList:[n,a],matchCode:o.matchCode},i=new Promise((function(e){c.curRoom.matchGroup(u,(function(r){e(r.code)}))})),e.abrupt("return",i);case 20:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"cancelMatchinig",value:(C=a(regeneratorRuntime.mark((function e(){var r,t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={matchType:MGOBE.ENUM.MatchType.PLAYER_COMPLEX},t=new Promise((function(e){n.curRoom.cancelPlayerMatch(r,(function(r){e(r.code)}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)})},{key:"getRoomInfo",value:(O=a(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){MGOBE.Room.getMyRoom((function(r){e(r.data.roomInfo)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return O.apply(this,arguments)})},{key:"leaveRoom",value:(S=a(regeneratorRuntime.mark((function e(){var r,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){t.curRoom.leaveRoom({},(function(r){r.code==t.errorCode.EC_OK&&t.curRoom.initRoom(),e(r.code)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)})},{key:"getTeamId",value:(E=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gameManager.serverTeam){e.next=4;break}return e.abrupt("return",this.gameManager.serverTeam.id);case 4:return e.next=6,this.getRoomInfo();case 6:return r=e.sent,t=r.playerList,e.next=10,this.getPlayerInfo();case 10:n=e.sent,a=0;case 12:if(!(a<t.length)){e.next=19;break}if((u=t[a]).id!=n.id){e.next=16;break}return e.abrupt("return",u.teamId);case 16:a++,e.next=12;break;case 19:return e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"sendToServer",value:(M=a(regeneratorRuntime.mark((function e(r){var t,n,a,u,o,i,p=this,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>1&&void 0!==f[1]?f[1]:null,n=t,r!=c.ChangeControler){e.next=10;break}return e.next=5,this.getPlayerInfo();case 5:return a=e.sent,e.next=8,this.getTeamId();case 8:u=e.sent,n={teamId:u,playerId:a.id};case 10:return o={type:r,data:n},r!=c.Heart&&s("发送数据到实时服务器:",o),i=new Promise((function(e){var r={data:o};p.curRoom.sendToGameSvr(r,(function(r){e(r.code)}))})),e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"sendToRoom",value:(I=a(regeneratorRuntime.mark((function e(r,t){var n,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(){var e=a(regeneratorRuntime.mark((function e(n){var a,o,i,c,p,m,l,h,g,d,y,v,k,R,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={type:r,data:t},o=[],i=MGOBE.ENUM.RecvType.ROOM_SOME,r!=f.Power&&r!=f.PowerEnd&&r!=f.SyncComplete&&r!=f.MatchedJoinGroup){e.next=10;break}return e.next=6,u.getTeammate();case 6:(c=e.sent)&&o.push(c.id),e.next=29;break;case 10:if(r!=f.EnemyPowerEnd){e.next=23;break}return e.next=13,u.getRoomInfo();case 13:if(!(p=e.sent)){e.next=21;break}return e.next=17,u.getPlayerInfo();case 17:for(m=e.sent,l=p.playerList,h=m.teamId,g=0;g<l.length;g++)(d=l[g]).teamId!=h&&o.push(d.id);case 21:e.next=29;break;case 23:if(r!=f.emoji){e.next=29;break}return e.next=26,u.getRoomInfo();case 26:for(y=e.sent,v=y.playerList,k=0;k<v.length;k++)R=v[k],o.push(R.id);case 29:P={recvType:i,recvPlayerList:o,msg:JSON.stringify(a)},s("发送房间消息数据给用户:",P),u.curRoom.sendToClient(P,(function(e){n(e.code)}));case 32:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)}))),function(e,r){return I.apply(this,arguments)})},{key:"getTeammate",value:(w=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u,o,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return r=e.sent,e.next=5,this.getRoomInfo();case 5:if(t=e.sent,n=!1,a=null,t){e.next=15;break}return e.next=11,this.getGroupInfo();case 11:(u=e.sent)?(n=!0,a=u.groupPlayerList):a=null,e.next=16;break;case 15:a=t.playerList;case 16:if(a){e.next=18;break}return e.abrupt("return",null);case 18:o={id:"",name:"",teamId:"",customPlayerStatus:0,customProfile:"",commonNetworkState:0,relayNetworkState:0,isRobot:!1,matchAttributes:[]},i=null,s=0;case 21:if(!(s<a.length)){e.next=41;break}if(c=a[s],!n){e.next=34;break}if(c.id==r.id){e.next=32;break}return(o=c).id=c.id,o.customPlayerStatus=c.customGroupPlayerStatus,o.commonNetworkState=c.commonGroupNetworkState,o.customProfile=c.customGroupPlayerProfile,i=o,e.abrupt("break",41);case 32:e.next=38;break;case 34:if(c.teamId!=r.teamId||c.id==r.id){e.next=38;break}return i=o=c,e.abrupt("break",41);case 38:s++,e.next=21;break;case 41:return e.abrupt("return",i);case 42:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"inRunningRoom",value:(b=a(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRoomInfo();case 2:if(!(r=e.sent)){e.next=7;break}if(s("房间状态:",r),"ing"!=r.customProperties){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"reconnect",value:(x=a(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRoomInfo();case 2:r=e.sent,this.curRoom.initRoom(r),this.Listener.add(this.curRoom);case 5:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"getPlayerIndex",value:(G=a(regeneratorRuntime.mark((function e(r){var t,n,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRoomInfo();case 2:if(n=e.sent,a=n.playerList,r){e.next=10;break}return e.next=7,this.getPlayerInfo();case 7:t=e.sent,e.next=11;break;case 10:a.map((function(e){e.id===r&&(t=e)}));case 11:return u=1,a.filter((function(e,r){return e.teamId===t.teamId})).map((function(e,r){e.id===t.id&&(u=r+1)})),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"createGroup",value:(P=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return r=e.sent,t={name:r.name,customGroupPlayerStatus:r.stateGroup,customGroupPlayerProfile:r.profile},n={groupName:"",groupType:MGOBE.ENUM.GroupType.GROUP_LIMITED,maxPlayers:2,isForbidJoin:!1,isPersistent:!1,customProperties:"",playerInfo:t},a=new Promise((function(e){u.curGroup.createGroup(n,(function(r){0===r.code&&(u.Listener.add(u.curGroup),u.curGroup.initGroup(r.data.groupInfo),s("队组创建成功",r.data.groupInfo)),e(r.code)}))})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"joinGroup",value:(R=a(regeneratorRuntime.mark((function e(r){var t,n,a,u,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlayerInfo();case 2:return t=e.sent,n={name:t.name,customGroupPlayerStatus:p.NotReady,customGroupPlayerProfile:t.profile},a={playerInfo:n},this.curGroup.initGroup({id:r}),u=new Promise((function(e){o.curGroup.joinGroup(a,(function(r){0===r.code&&(o.Listener.add(o.curGroup),o.curGroup.initGroup(r.data.groupInfo)),e(r.code)}))})),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"leaveGroup",value:(k=a(regeneratorRuntime.mark((function e(){var r,t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:if(!(r=e.sent)){e.next=7;break}this.curGroup.initGroup(r),e.next=8;break;case 7:return e.abrupt("return",this.errorCode.EC_OK);case 8:return t=new Promise((function(e){n.curGroup.leaveGroup({},(function(r){0===r.code&&n.curGroup.initGroup(),e(r.code)}))})),e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"getGroupInfo",value:(v=a(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){MGOBE.Group.getMyGroups((function(r){if(r.code===MGOBE.ErrCode.EC_OK&&r.data.groupInfoList.length>0)for(var t=0;t<r.data.groupInfoList.length;t++){var n=r.data.groupInfoList[t];if(n.type===MGOBE.ENUM.GroupType.GROUP_LIMITED){e(n);break}}else e(null)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return v.apply(this,arguments)})},{key:"setGroupPlayerStatus",value:(y=a(regeneratorRuntime.mark((function e(r){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={customGroupPlayerStatus:r},n=new Promise((function(e){a.curGroup.changeCustomGroupPlayerStatus(t,(function(r){s("修改用户队组状态",r),e(r)}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"removePlayerInGroup",value:(d=a(regeneratorRuntime.mark((function e(r){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={removePlayerId:r},n=new Promise((function(e){a.curGroup.removeGroupPlayer(t,(function(r){e(r.code)}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"dismissGroup",value:(g=a(regeneratorRuntime.mark((function e(){var r,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){t.curGroup.dismissGroup({},(function(r){e(r.code)}))})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)})},{key:"sendToGroup",value:(h=a(regeneratorRuntime.mark((function e(r,t){var n,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={type:r,content:t},new Promise(function(){var e=a(regeneratorRuntime.mark((function e(r){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getLoverInfo();case 2:(t=e.sent)?(a={recvType:MGOBE.ENUM.GroupRecvType.GROUP_SOME,recvPlayerList:[t.id],msg:JSON.stringify(n)},u.curGroup.sendToGroupClient(a,(function(e){s("消息发送完成:",e),r(!0)}))):r(!1);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),function(e,r){return h.apply(this,arguments)})},{key:"isCaptain",value:(l=a(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:return r=e.sent,e.next=5,this.getPlayerInfo();case 5:return t=e.sent,e.abrupt("return",r.owner==t.id);case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"setPlayerStatus",value:(m=a(regeneratorRuntime.mark((function e(r){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={customPlayerStatus:r},n=new Promise((function(e){a.curRoom.changeCustomPlayerStatus(t,(function(r){s("修改用户房间状态",r),e(r)}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"getPlayerInfo",value:(u=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:r=e.sent,t=[],r&&(t=r.groupPlayerList),n=p.NotReady,a=0;case 7:if(!(a<t.length)){e.next=15;break}if((u=t[a]).id!==MGOBE.Player.id){e.next=12;break}return n=u.customGroupPlayerStatus,e.abrupt("break",15);case 12:a++,e.next=7;break;case 15:return o={id:MGOBE.Player.id,name:this.gameManager.PlayerData.nickname,openId:MGOBE.Player.openId,netState:MGOBE.Player.commonNetworkState,stateRoom:MGOBE.Player.customPlayerStatus,stateGroup:n,teamId:MGOBE.Player.teamId,profile:null!=MGOBE.Player.customProfile?MGOBE.Player.customProfile:JSON.stringify(this.gameManager.PlayerData)},e.abrupt("return",o);case 17:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getLoverInfo",value:(r=a(regeneratorRuntime.mark((function e(){var r,t,n,a,u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroupInfo();case 2:if(r=e.sent,t=null,r){e.next=7;break}return s("暂未建立队组,无法获得另一半信息"),e.abrupt("return");case 7:n=r.groupPlayerList,a=0;case 9:if(!(a<n.length)){e.next=17;break}if((u=n[a]).id==MGOBE.Player.id){e.next=14;break}return t=u,e.abrupt("break",17);case 14:a++,e.next=9;break;case 17:if(t){e.next=20;break}return s("另一半不在队组中"),e.abrupt("return");case 20:return o={id:t.id,name:null!=t.name?t.name:t.id,netState:t.commonGroupNetworkState,stateGroup:t.customGroupPlayerStatus,profile:t.customGroupPlayerProfile},e.abrupt("return",o);case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),e}()),u._RF.pop()}}}));

System.register("chunks:///UI/Dialog/Dialog.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Const.js"],(function(e,t){var n,i,s,o,r,a,l,u,h,c,d,g,p;return{setters:[function(e){n=e.createClass,i=e.classCallCheck,s=e.asyncToGenerator},function(e){o=e.cclegacy,r=e.tween,a=e.Vec3,l=e.loader,u=e.Prefab,h=e.instantiate,c=e.Label,d=e.SystemEventType},function(e){g=e.log,p=e.DialogButtonType}],execute:function(){o._RF.push({},"15867PII/lA6aXbZL4Ddkcx","Dialog",void 0),e("Dialog",function(){function e(t,n,s){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"确认",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"取消";i(this,e),this.scene=null,this.node=null,this.result=null,this.SDK=null,this.text=null,this.buttonType=null,this.yesTip=null,this.noTip=null,this.dead=!1,this.scene=t,this.SDK=n,this.text=s,this.buttonType=o,this.yesTip=r,this.noTip=a}var t,o;return n(e,[{key:"InitBoard",value:(o=s(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g("弹窗预制件实例化:"),t=new Promise((function(e){l.loadRes("Prefab/Dialog/Dialog",u,(function(t,i){t?(g("弹框实例化失败",t),e(!1)):(g("弹框实例化成功"),n.node=h(i),n.scene.getChildByName("UI").addChild(n.node),n.node.setSiblingIndex(100),e(!0))}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"destroy",value:function(){if(!this.dead){if(!this.node)return void(this.SDK=null);this.dead=!0,this.scene=null,r(this.node).to(.3,{scale:new a(0,0,0)},{onComplete:function(){this.SDK.curDialog=null,this.SDK=null,this.node.destroy(),this.node=null}.bind(this)}).start()}}},{key:"show",value:(t=s(regeneratorRuntime.mark((function e(t,n){var i,s,o,l,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u.length>2&&void 0!==u[2]?u[2]:null,null!=this.SDK.curDialog){e.next=20;break}return e.next=4,this.InitBoard();case 4:if(e.sent){e.next=8;break}return this.destroy(),e.abrupt("return");case 8:this.SDK.curDialog=this,s=this.node.getChildByName("background").getChildByName("yes"),o=this.node.getChildByName("background").getChildByName("no"),this.node.getChildByName("background").getChildByName("content").getComponent(c).string=this.text,s.getChildByName("Label").getComponent(c).string=this.yesTip,o.getChildByName("Label").getComponent(c).string=this.noTip,this.buttonType==p.single&&(o.active=!1,l=new a,s.getPosition(l),l.x=0,s.setPosition(l)),this.node.setScale(new a(0,0,0)),this.node.active=!0,r(this.node).to(.3,{scale:new a(1,1,1)}).start(),s.on(d.TOUCH_START,n,t),i&&o.on(d.TOUCH_START,i,t);case 20:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}()),o._RF.pop()}}}));

System.register("chunks:///UI/Board/BaseBoard.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Const.js","../Dialog/Dialog.js"],(function(e,t){var n,r,a,o,i,u,s,l,c,h,d;return{setters:[function(e){n=e.createClass,r=e.classCallCheck,a=e.asyncToGenerator},function(e){o=e.cclegacy,i=e._decorator,u=e.loader,s=e.Prefab,l=e.instantiate},function(e){c=e.log,h=e.DialogButtonType},function(e){d=e.Dialog}],execute:function(){o._RF.push({},"72680Q0ztVKyaWXTajENF2V","BaseBoard",void 0),i.ccclass,i.property,e("BaseBoard",function(){function e(t,n){r(this,e),this.board=null,this.SDK=null,this.scene=null,this.name=null,this.uiControl=null,this.dead=!1,this.sleep=function(e){return new Promise((function(t){return setTimeout(t,e)}))},c("创建UI对象:",this.name),this.SDK=n,this.scene=t}var t,o,i;return n(e,[{key:"Init",value:(i=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c("初始化界面:",this.name),!this.board){e.next=5;break}return this.InitEvent(),e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"destroy",value:function(){c("销毁界面:",this.name),this.board&&(this.board.active=!1),this.dead=!0}},{key:"setListener",value:function(){c("绑定监听:",this.name)}},{key:"InitBoard",value:(o=a(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("界面预制件实例化:",this.name),t=new Promise((function(e){u.loadRes("Prefab/Board/"+n.name,s,(function(t,r){t?(c("界面预制件实例化失败",t),n.board=null,e(!1)):(n.board=l(r),n.board.active=!1,n.scene.getChildByName("UI").addChild(n.board),n.board.setSiblingIndex(0),e(!0))}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"InitEvent",value:function(){c("初始化UI事件:",this.name)}},{key:"initData",value:function(){c("重置界面基础数据"),this.dead=!1,this.uiControl&&this.uiControl.initData()}},{key:"ChangeBoard",value:(t=a(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.SDK.curBoard)&&"ResultBoard"==n.name&&(this.SDK.gameManager.teammaterIsLover=void 0,this.SDK.gameManager.enemyIsLover=void 0),n!=t&&(n||(n=t)),c("界面切换",n.name,"--\x3e",t.name),this.SDK.curBoard=t,t.dead=!1,e.next=8,t.Init();case 8:if(!e.sent){e.next=32;break}if(this.SDK.Room.onCancelMatch=null,this.SDK.Room.onMatch=null,this.SDK.curRoom.onChangePlayerNetworkState=null,this.SDK.curRoom.onLeaveRoom=null,this.SDK.curRoom.onRecvFromGameSvr=null,this.SDK.curRoom.onRecvFromClient=null,this.SDK.curGroup.onChangeCustomGroupPlayerStatus=null,this.SDK.curGroup.onChangeGroupPlayerNetworkState=null,this.SDK.curGroup.onRecvFromGroupClient=null,this.SDK.curGroup.onJoinGroup=null,this.SDK.curGroup.onLeaveGroup=null,this.SDK.curGroup.onDismissGroup=null,t.setListener(),null==t.uiControl){e.next=26;break}return e.next=26,t.uiControl.initUI(t.board);case 26:t.initData(),t.scene.getChildByName("UI").getChildByName("loading").active=!1,t.board.active=!0,n!=t&&n.destroy(),e.next=39;break;case 32:return c("销毁新界面"),e.next=35,t.destroy();case 35:return c("弹框"),r=new d(n.scene,this.SDK,"网络出现问题,无法正常游戏",h.single,"确定"),e.next=39,r.show(this,(function(){this.SDK.curDialog.destroy()}));case 39:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}()),o._RF.pop()}}}));

System.register("chunks:///UI/Board/WaitLoverBoard.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Const.js","./BaseBoard.js"],(function(e,t){var a,r,n,i,o,s,u,h,l,c,d,g,y,m,p,C,B,N;return{setters:[function(e){a=e.inherits,r=e.createClass,n=e.classCallCheck,i=e.possibleConstructorReturn,o=e.getPrototypeOf,s=e.get,u=e.asyncToGenerator},function(e){h=e.cclegacy,l=e.SystemEventType,c=e.Label},function(e){d=e.log,g=e.NetState,y=e.GroupMessageType,m=e.GroupSysMessageType,p=e.PlayerState,C=e.LabelColor},function(e){B=e.BaseBoard}],execute:function(){h._RF.push({},"638a0cfbatPTK9EkM3XiINe","WaitLoverBoard",void 0),N=function(){function e(t,a){n(this,e),this.board=null,this.SDK=null,this.team1=null,this.team2=null,this.board=t,this.SDK=a}var t,a;return r(e,[{key:"initUI",value:(a=u(regeneratorRuntime.mark((function e(t){var a,r,n,i,o,s,u,h,l,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.board=t,e.next=3,this.SDK.getPlayerInfo();case 3:return a=e.sent,e.next=6,this.SDK.getGroupInfo();case 6:if(r=e.sent,n=null,i=null,o=this.board.getChildByName("team1"),s=o.getChildByName("user1"),u=o.getChildByName("user2"),s.getChildByName("nickName").getComponent(c).string=a.name,this.SDK.gameManager.Util.loadRemoteImg(JSON.parse(a.profile).avatar_url,s.getChildByName("avatarBg").getChildByName("avatar")),s.getChildByName("state").getComponent(c).string=a.stateGroup==p.NotReady?"未准备":"已准备",s.getChildByName("state").getComponent(c).color=a.stateGroup==p.NotReady?C.NotReady:C.Ready,this.board.getChildByName("ready").getChildByName("Button-ready").getChildByName("Label").getComponent(c).string=a.stateGroup==p.NotReady?"准备":"取消准备",!r){e.next=31;break}i=r.owner,h=r.groupPlayerList,l=0;case 21:if(!(l<h.length)){e.next=29;break}if((g=h[l]).id==a.id){e.next=26;break}return n=g,e.abrupt("break",29);case 26:l++,e.next=21;break;case 29:d("加入的队组内其他玩家:",n),null!=n?(o.getChildByName("wait").active=!1,u.getChildByName("nickName").getComponent(c).string=n.name,u.getChildByName("state").getComponent(c).string=n.customGroupPlayerStatus==p.NotReady?"未准备":"已准备",u.getChildByName("state").getComponent(c).color=n.customGroupPlayerStatus==p.NotReady?C.NotReady:C.Ready,this.SDK.gameManager.Util.loadRemoteImg(JSON.parse(n.customGroupPlayerProfile).avatar_url,u.getChildByName("avatarBg").getChildByName("avatar")),u.active=!0):(o.getChildByName("wait").active=!0,u.active=!1);case 31:d("capId: ",i,a.id),i==a.id?(this.board.getChildByName("ready").getChildByName("Button-match").active=!0,this.board.getChildByName("ready").getChildByName("Button-ready").active=!1,s.getChildByName("state").getComponent(c).string="队长",u.getChildByName("state").getComponent(c).string="未准备",u.getChildByName("state").getComponent(c).color=C.NotReady,s.getChildByName("state").getComponent(c).color=C.Captain):(this.board.getChildByName("ready").getChildByName("Button-match").active=!1,this.board.getChildByName("ready").getChildByName("Button-ready").active=!0,u.getChildByName("state").getComponent(c).string="队长",s.getChildByName("state").getComponent(c).string="未准备",s.getChildByName("state").getComponent(c).color=C.NotReady,u.getChildByName("state").getComponent(c).color=C.Captain);case 33:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"playerReady",value:(t=u(regeneratorRuntime.mark((function e(t,a){var r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getPlayerInfo();case 2:return r=e.sent,e.next=5,this.SDK.getGroupInfo();case 5:n=e.sent,i=null,d("UI:修改玩家准备状态:",t,a),i=t==r.id?this.board.getChildByName("team1").getChildByName("user1"):this.board.getChildByName("team1").getChildByName("user2"),t!=n.owner&&(o=a===p.NotReady?{tip:"未准备",color:C.NotReady}:{tip:"已准备",color:C.Ready},i.getChildByName("state").getComponent(c).string=o.tip,i.getChildByName("state").getComponent(c).color=o.color);case 10:case"end":return e.stop()}}),e,this)}))),function(e,a){return t.apply(this,arguments)})},{key:"playerJoin",value:function(e,t){for(var a=null,r=0;r<t.length;r++){var n=t[r];if(n.id==e){a=n;break}}d("joinPlayerInfo: ",a);var i=a.customGroupPlayerProfile?JSON.parse(a.customGroupPlayerProfile):JSON.parse(a.profile);this.SDK.gameManager.Util.loadRemoteImg(i.avatar_url,this.board.getChildByName("team1").getChildByName("user2").getChildByName("avatarBg").getChildByName("avatar")),this.board.getChildByName("team1").getChildByName("wait").active=!1,this.board.getChildByName("team1").getChildByName("user2").active=!0,this.board.getChildByName("team1").getChildByName("user2").getChildByName("nickName").getComponent(c).string=a.name}},{key:"playerLeave",value:function(){this.board.getChildByName("team1").getChildByName("wait").active=!0,this.board.getChildByName("team1").getChildByName("user2").active=!1}}]),e}(),e("WaitLoverBoard",function(e){function t(e,a){var r;return n(this,t),(r=i(this,o(t).call(this,e,a))).uiControl=null,r.name="WaitLoverBoard",r.uiControl=new N(r.board,r.SDK),r}var h,C,B,f,v,S,k;return a(t,e),r(t,[{key:"setListener",value:function(){s(o(t.prototype),"setListener",this).call(this),this.SDK.curGroup.onChangeCustomGroupPlayerStatus=this.onChangeCustomGroupPlayerStatus.bind(this),this.SDK.curGroup.onChangeGroupPlayerNetworkState=this.onChangeGroupPlayerNetworkState.bind(this),this.SDK.curGroup.onRecvFromGroupClient=this.onRecvFromGroupClient.bind(this),this.SDK.curGroup.onJoinGroup=this.onJoinGroup.bind(this),this.SDK.curGroup.onLeaveGroup=this.onLeaveGroup.bind(this),this.SDK.curGroup.onDismissGroup=this.onDismissGroup.bind(this),this.SDK.gameManager.timerSingal&&(this.SDK.gameManager.timerSingal=null)}},{key:"onDismissGroup",value:(k=u(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("监听到队长解散了队组"),this.SDK.curGroup.initGroup(),a=this.SDK.gameManager.MainBoard,e.next=5,this.ChangeBoard(a);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"onChangeCustomGroupPlayerStatus",value:(S=u(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("玩家[",t.data.changePlayerId,"]准备状态有变化",t.data.customGroupPlayerStatus),e.next=3,this.uiControl.playerReady(t.data.changePlayerId,t.data.customGroupPlayerStatus);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"onChangeGroupPlayerNetworkState",value:(v=u(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("玩家[",t.data.changePlayerId,"]在线状态有变化",t.data.networkState),e.next=3,this.SDK.isCaptain();case 3:if(e.sent){e.next=15;break}if(t.data.networkState!=g.Offline){e.next=13;break}return e.next=8,this.SDK.leaveGroup();case 8:if(e.sent!=this.SDK.errorCode.EC_OK){e.next=13;break}return a=this.SDK.gameManager.MainBoard,e.next=13,this.ChangeBoard(a);case 13:e.next=19;break;case 15:return e.next=17,this.SDK.removePlayerInGroup(t.data.changePlayerId);case 17:0===e.sent?this.uiControl.playerLeave():d("踢出玩家失败:",t.data.changePlayerId);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"onRecvFromGroupClient",value:(f=u(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d("接收到来自另一半的消息:",t),(a=JSON.parse(t.data.msg)).type!=y.Sys){e.next=7;break}if(a.content!=m.Matching){e.next=7;break}return r=this.SDK.gameManager.MatchingBoard,e.next=7,this.ChangeBoard(r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"onJoinGroup",value:function(e){d("有玩家加入队组:",e.data.joinPlayerId);var t=e.data.joinPlayerId,a=e.data.groupInfo.groupPlayerList;this.uiControl.playerJoin(t,a)}},{key:"onLeaveGroup",value:function(e){d("有人离开队组",e.data.leavePlayerId),this.uiControl.playerLeave()}},{key:"InitEvent",value:function(){s(o(t.prototype),"InitEvent",this).call(this);var e=this.board.getChildByName("ready").getChildByName("Button-ready"),a=this.board.getChildByName("ready").getChildByName("Button-match"),r=this.board.getChildByName("Cancel").getChildByName("Button");e.on(l.TOUCH_START,this.clickReady,this),r.on(l.TOUCH_START,this.clickLeave,this),a.on(l.TOUCH_START,this.clickMatch,this)}},{key:"clickReady",value:(B=u(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getPlayerInfo();case 2:return t=e.sent,a=p.NotReady,r="准备",t.stateGroup===p.NotReady&&(a=p.Ready,r="取消准备"),e.next=8,this.SDK.setGroupPlayerStatus(a);case 8:e.sent,this.board.getChildByName("ready").getChildByName("Button-ready").getChildByName("Label").getComponent(c).string=r;case 10:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"clickLeave",value:(C=u(regeneratorRuntime.mark((function e(){var t,a,r,n,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getGroupInfo();case 2:return t=e.sent,e.next=5,this.SDK.getPlayerInfo();case 5:if(a=e.sent,!t){e.next=33;break}if(r=t.owner,a.id!=r){e.next=20;break}return e.next=11,this.SDK.dismissGroup();case 11:if(e.sent!==this.SDK.errorCode.EC_OK){e.next=18;break}return d("作为队长解散队组成功"),this.SDK.curGroup.initGroup(),n=this.SDK.gameManager.MainBoard,e.next=18,this.ChangeBoard(n);case 18:e.next=31;break;case 20:return e.next=22,this.SDK.leaveGroup();case 22:if((i=e.sent)!==this.SDK.errorCode.EC_OK&&i!=this.SDK.errorCode.EC_GROUP_NOT_EXIST){e.next=30;break}return d("离开队组成功",i),o=this.SDK.gameManager.MainBoard,e.next=28,this.ChangeBoard(o);case 28:e.next=31;break;case 30:d("离开队组失败",i);case 31:e.next=36;break;case 33:return s=this.SDK.gameManager.MainBoard,e.next=36,this.ChangeBoard(s);case 36:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"clickMatch",value:(h=u(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getLoverInfo();case 2:if(!(t=e.sent)){e.next=21;break}if(t.stateGroup!==p.Ready){e.next=20;break}return e.next=7,this.SDK.matchingLover();case 7:if((a=e.sent)!=this.SDK.errorCode.EC_OK){e.next=17;break}return d("进入匹配成功"),e.next=12,this.SDK.sendToGroup(y.Sys,m.Matching);case 12:return r=this.SDK.gameManager.MatchingBoard,e.next=15,this.ChangeBoard(r);case 15:e.next=18;break;case 17:d("进入匹配失败-",a);case 18:e.next=21;break;case 20:d("另一半未准备好");case 21:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})}]),t}(B)),h._RF.pop()}}}));

System.register("chunks:///OtherPlayer.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Const.js"],(function(t,e){var i,n,s,o,r,a,u,h,l,p,c,m,d,_,f,g,v,y,j,x,R,P,w,b,B,k,C,D,T,z,F,M,N,Y,H;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,s=t.classCallCheck,o=t.possibleConstructorReturn,r=t.getPrototypeOf,a=t.initializerDefineProperty,u=t.assertThisInitialized,h=t.createClass,l=t.asyncToGenerator},function(t){p=t.cclegacy,c=t._decorator,m=t.Vec3,d=t.Quat,_=t.CCFloat,f=t.Vec2,g=t.tween,v=t.Component,y=t.instantiate,j=t.loader,x=t.Prefab},function(t){R=t.log,P=t.JumpStatus,w=t.TeamColor}],execute:function(){p._RF.push({},"f514fFBUXpDva7Z4+Bu/z5l","OtherPlayer",void 0),N=c.ccclass,Y=c.property,new m,new m,H=new d,new d,t("OtherPlayer",(b=N("OtherPlayer"),B=Y({type:_}),k=Y({type:_}),C=Y({type:_}),b((z=i((T=function(t){function e(){var t,i;s(this,e);for(var n=arguments.length,h=new Array(n),l=0;l<n;l++)h[l]=arguments[l];return i=o(this,(t=r(e)).call.apply(t,[this].concat(h))),a(i,"jumpHeight",z,u(i)),a(i,"jumpDuration",F,u(i)),a(i,"max_time",M,u(i)),i.originPosY=0,i.originRotation=new d(0,1,0,0),i._isRunning=!1,i.curRotation=new d,i._cur_position=new m,i._jump_time=0,i.jumpResult={time:null,distance:null,offset:null,status:null},i._face=new f,i._axis=new m,i._stat_power=!1,i._stat_jump=!1,i.curBox=null,i.nextBox=null,i.control=!1,i.modelBody=null,i.modelHead=null,i.modelHeadPos=new m,i.modelTire=null,i.map=null,i.index=0,i}var i,p;return n(e,t),h(e,[{key:"onLoad",value:function(){}},{key:"start",value:function(){this.originPosY=this.node.position.y,this.node.getRotation(this.curRotation)}},{key:"initPlayer",value:function(){var t=new m(this.gameManager.otherTeam.pos[0],this.originPosY,this.gameManager.otherTeam.pos[1]);this._cur_position=t;new d;this.node.setPosition(t),this.node.setRotation(this.originRotation),this._jump_time=0,this._stat_power=!1,this._stat_jump=!1}},{key:"PowerEnd",value:function(t){if(0==this.control){this._stat_power=!1;var e=new m;this.node.getPosition(e),e.y=this.originPosY,this.node.setPosition(e),this.start_jump(t)}}},{key:"start_jump",value:function(t){this._stat_power||(R("[敌人]跳跃相关信息:",t),R("地图长度:",this.map.length),this._stat_jump=!0,this._jump_time=0,this.getFace(this._face),this._axis=this.gameManager.Util.getJumpAxis(this.node,this.nextBox.node),this.node.getRotation(this.curRotation),this.node.getPosition(this._cur_position),this.jumpResult.distance=t.distance,this.jumpResult.offset=t.pos,this.jumpResult.status=t.status,this.jumpResult.time=t.time,this.index=t.index,this.curBox=this.map[this.index],this.nextBox=this.map[this.index+1])}},{key:"action_jump",value:function(t){if(this._stat_jump){this._jump_time+=t;var e=0,i=0,n=0,s=!1;if(this._jump_time<this.jumpDuration){var o=-4*this.jumpHeight/(this.jumpDuration*this.jumpDuration),r=this.jumpDuration/2,a=this.jumpHeight;e=o*(this._jump_time-r)*(this._jump_time-r)+a+this.originPosY,i=t/this.jumpDuration*this.jumpResult.distance,n=this._jump_time/this.jumpDuration*360}else e=this.originPosY,n=0,this._stat_jump=!1,s=!0;var u=new m;this.node.getPosition(u);var h=this.gameManager.Util.getPosWithVec(u,this._face,i);h.y=e,d.rotateAround(H,this.curRotation,this._axis,3.1415*n/180),this.node.setPosition(h),this.node.setRotation(H),s&&this.action_jump_end()}}},{key:"action_jump_end",value:function(){var t=new m;if(this.node.getPosition(t),this.jumpResult.status==P.current){R("[敌人]原地跳,修改正量:",this.jumpResult.offset);var e=new m;this.curBox.node.getPosition(e),e.x+=this.jumpResult.offset[0],e.z+=this.jumpResult.offset[1],e.y=this.originPosY,R("[敌人]修正后的坐标:",e),this.node.setPosition(e),this.node.getPosition(this._cur_position),this.setFace()}else if(this.jumpResult.status==P.next){R("[敌人]跳到下一块,修改正量:",this.jumpResult.offset);var i=new m;this.nextBox.node.getPosition(i),i.x+=this.jumpResult.offset[0],i.z+=this.jumpResult.offset[1],i.y=this.originPosY,R("[敌人]修正后的坐标:",i),this.node.setPosition(i),this.node.getPosition(this._cur_position),this.index+=1,this.curBox=this.map[this.index],this.nextBox=this.map[this.index+1],this.setFace()}else if(this.jumpResult.status==P.dead){R("[敌人]跳死了");var n=new m;n.set(t),n.y=-.5,g(this.node).to(1,{position:n},{onComplete:this.jumpDead.bind(this)}).start()}}},{key:"jumpDead",value:function(){this.reset()}},{key:"reset",value:function(){this.node.setPosition(this._cur_position),this.node.setRotation(this.originRotation)}},{key:"update",value:function(t){this.isRunning&&this.action_jump(t)}},{key:"setFace",value:function(){var t=this;if(this.nextBox){var e=g(this.node),i=new d;this.node.getRotation(i);var n=this.gameManager.Util.getRotaionQuat(this.node,this.nextBox.node),s=new d;e.to(.2,{},{onUpdate:function(e,o){s.set(i).slerp(n,o),t.node.setRotation(s)}}),e.start()}}},{key:"getFace",value:function(t){if(this.nextBox){new f;var e=new m,i=new m;this.node.getPosition(e),this.nextBox.node.getPosition(i),t.set(i.x-e.x,i.z-e.z)}else t.set(this._face.x,this._face.y)}},{key:"setModel",value:(p=l(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e==w.blue?this.gameManager.ChessPrefabEnemy.blue:this.gameManager.ChessPrefabEnemy.red,(n=this.node.getChildByName("Node"))&&this.node.removeChild(n),y(i).setParent(this.node),t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"setTire",value:(i=l(regeneratorRuntime.mark((function t(e){var i,n,s,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=1===t.t0?3:5;break;case 3:return i="vip",t.abrupt("break",6);case 5:return t.abrupt("return",!1);case 6:return(n=this.node.getChildByName("Tire").getChildByName("Node"))&&this.node.getChildByName("Tire").removeChild(n),s="Model/Tire/"+i+"/Node_enemy",new Promise((function(t){j.loadRes(s,x,(function(e,i){var n=y(i);n.setParent(o.node.getChildByName("Tire")),o.modelTire=n,t(n)}))})),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"isRunning",set:function(t){this._isRunning=t},get:function(){return this._isRunning}}]),e}(v)).prototype,"jumpHeight",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),F=i(T.prototype,"jumpDuration",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.7}}),M=i(T.prototype,"max_time",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),D=T))||D)),p._RF.pop()}}}));

System.register("chunks:///UI/avatar.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,i,r,s,a,o,c,u,l,p,h,v;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,i=t.classCallCheck,r=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.createClass},function(t){o=t.cclegacy,c=t._decorator,u=t.Sprite,l=t.Component}],execute:function(){o._RF.push({},"62231BivyRLC6qStdnthPWc","avatar",void 0),v=c.ccclass,c.property,t("Avatar",(p=v("Avatar"),p(h=function(t){function e(){var t,n;i(this,e);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=r(this,(t=s(e)).call.apply(t,[this].concat(o)))).run=!1,n.time=0,n.loopTime=5,n}return n(e,t),a(e,[{key:"start",value:function(){}},{key:"timeStart",value:function(){this.run=!0}},{key:"reset",value:function(){this.run=!1,this.time=0;var t=this.node.getComponent(u).material.passes[0];t.setUniform(t.getHandle("precent"),100)}},{key:"update",value:function(t){if(this.run){var e=this.node.getComponent(u).material.passes[0];e.setUniform(e.getHandle("precent"),20*this.time),this.time+=t,this.time>=this.loopTime&&this.reset()}}}]),e}(l))||h)),o._RF.pop()}}}));

System.register("chunks:///UI/Board/GamingBoard.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Const.js","../Dialog/Dialog.js","./BaseBoard.js","../avatar.js"],(function(e,t){var a,r,n,i,o,s,m,h,u,l,g,d,c,y,p,v,C,f,S,D,N,B,K,R,M,k,T,b;return{setters:[function(e){a=e.inherits,r=e.createClass,n=e.classCallCheck,i=e.possibleConstructorReturn,o=e.getPrototypeOf,s=e.get,m=e.asyncToGenerator},function(e){h=e.cclegacy,u=e.Label,l=e.Vec3,g=e.tween,d=e.SystemEventType,c=e.loader,y=e.Prefab,p=e.instantiate},function(e){v=e.TeamColor,C=e.log,f=e.RoomDataType,S=e.EmojiType,D=e.ServerDataType,N=e.PlayerState,B=e.AIDataType,K=e.ClientDataType,R=e.DialogButtonType},function(e){M=e.Dialog},function(e){k=e.BaseBoard},function(e){T=e.Avatar}],execute:function(){h._RF.push({},"5a91dy6sIFJ+IdMqEEFo6I0","GamingBoard",void 0),b=function(){function e(t,a){n(this,e),this.board=null,this.SDK=null,this.end=!1,this.emojiList=[],this.curAvatar=null,this.selfAvatar=null,this.teammaterAvatar=null,C("初始化UI控制",t,a),this.board=t,this.SDK=a}var t,a,i,o;return r(e,[{key:"initUI",value:(o=m(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board=t,this.board.getChildByName("Header").getChildByName("end").active=!1,this.SDK.gameManager.isReconnect?this.board.getChildByName("Header").getChildByName("ready").active=!1:this.setReady();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"setTime",value:function(e){this.board&&(this.board.getChildByName("Header").getChildByName("time").getComponent(u).string=e)}},{key:"ControlStart",value:(i=m(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeamId();case 2:r=e.sent,n=r==v.red?this.board.getChildByName("Header").getChildByName("team0"):this.board.getChildByName("Header").getChildByName("team1"),(a=t?n.getChildByName("avatar-1").getChildByName("avatar"):n.getChildByName("avatar-2").getChildByName("avatar")).getComponent(T).timeStart(),this.curAvatar=a;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"ControlReset",value:(a=m(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.curAvatar.getComponent(T).reset();case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"ControlTimeRefresh",value:function(e){this.board.getChildByName("Header").getChildByName("control_time").getComponent(u).string=e}},{key:"refreshState",value:function(){if(!this.end){var e=this.board.getChildByName("Header").getChildByName("tip"),t=this.board.getChildByName("Header").getChildByName("wait");this.SDK.gameManager.isControler?(e.active=!0,t.active=!1):(t.active=!0,e.active=!1)}}},{key:"refreshEmoji",value:function(){for(var e=this.emojiList.length-1;e>=0;e--){var t=this.emojiList[e];t.time-=.5,t.time<=0&&(t.node.destroy(),this.emojiList.splice(e,1))}}},{key:"gameEnd",value:function(){if(!this.end){this.end=!0;var e=this.board.getChildByName("Header").getChildByName("tip"),t=this.board.getChildByName("Header").getChildByName("wait");this.board.getChildByName("Header").getChildByName("end").active=!0,e.active=!1,t.active=!1}}},{key:"showEmoji",value:(t=m(regeneratorRuntime.mark((function e(t,a){var r,n,i,o,s,h,u,g=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new l(0,-80,0),new l,e.next=4,this.SDK.getRoomInfo();case 4:return i=e.sent,o=i.playerList,s=i.teamList,u=new Promise((function(e){var i="Prefab/Emoji/emoji_"+(t+1);C("预制件路径",i),c.loadRes(i,y,function(){var t=m(regeneratorRuntime.mark((function t(i,m){var u,l,d,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=3;break}return C("表情预制件实例化失败",i),t.abrupt("return");case 3:return n=p(m),o.map((function(e){e.id===a&&(h=e)})),u=s.findIndex((function(e){return e.id===h.teamId})),t.next=8,g.SDK.getPlayerIndex(a);case 8:l=t.sent,0===u?(d=g.board.getChildByName("Header").getChildByName("team0"),r.x=1===l?d.getChildByName("avatar-1").getPosition().x:d.getChildByName("avatar-2").getPosition().x,n.setPosition(r),n.setParent(d)):(c=g.board.getChildByName("Header").getChildByName("team1"),r.x=1===l?c.getChildByName("avatar-1").getPosition().x:c.getChildByName("avatar-2").getPosition().x,n.setPosition(r),n.setParent(c)),g.emojiList.push({node:n,time:2}),e(!0);case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())})),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,a){return t.apply(this,arguments)})},{key:"setReady",value:function(){this.board.getChildByName("Header").getChildByName("ready").setPosition(new l(-300,-200,0)),this.board.getChildByName("Header").getChildByName("ready").active=!0,g(this.board.getChildByName("Header").getChildByName("ready")).to(.3,{position:{x:0,y:-200,z:0},easing:"sineIn"},{onComplete:function(){var e=this;this.SDK.gameManager.Util.playAudio(this.SDK.gameManager.audio_ready),setTimeout((function(){var t;e.SDK.gameManager.Util.playAudio(e.SDK.gameManager.audio_go),g(e.board.getChildByName("Header").getChildByName("ready")).to(.3,{position:{x:300,y:-200,z:0},easing:"sineOut"},{onComplete:(t=m(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.board.getChildByName("Header").getChildByName("ready").active=!1,t.next=3,e.SDK.gameManager.changeControler(e.SDK.gameManager.curActionPlayer);case 3:e.refreshState();case 4:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}).start()}),1500)}.bind(this)}).start()}}]),e}(),e("GamingBoard",function(e){function t(e,a){var r;return n(this,t),(r=i(this,o(t).call(this,e,a))).uiControl=null,r.controlTime=-100,r.audio_last5s_tag=!1,r.name="GamingBoard",r.uiControl=new b(r.board,r.SDK),r}var h,l,g,c,y,p;return a(t,e),r(t,[{key:"initData",value:function(){s(o(t.prototype),"initData",this).call(this),this.controlTime=-100,this.audio_last5s_tag=!1,this.uiControl.end=!1,this.uiControl.initUI(this.board),this.SDK.gameManager.updateCenterNode(!1)}},{key:"setListener",value:function(){s(o(t.prototype),"setListener",this).call(this),this.SDK.curRoom.onRecvFromGameSvr=this.onRecvFromGameSvr.bind(this),this.SDK.curRoom.onRecvFromClient=this.onRecvFromClient.bind(this),this.SDK.gameManager.timerSingal=this.onTimerSingal.bind(this),this.SDK.gameManager.uiRefresh=this.onUIRefresh.bind(this),this.SDK.gameManager.avatarSingal=this.onAvatarSingal.bind(this)}},{key:"destroy",value:function(){s(o(t.prototype),"destroy",this).call(this)}},{key:"onLeaveRoom",value:(p=m(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.leavePlayerId,e.next=3,this.SDK.getLoverInfo();case 3:e.sent,C("玩家离开房间",a);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"onRecvFromGameSvr",value:(y=m(regeneratorRuntime.mark((function e(t){var a,r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=null,r=-1;try{a=t.data.data,r=a.type}catch(e){C("接收到错误的信息-error",e)}if(r!=D.Sync){e.next=9;break}return C("接收到数据同步信息",a.data),e.next=7,this.SDK.gameManager.syncData(a.data);case 7:e.next=10;break;case 9:r==D.ChangeControler?(C("接收到控制权转移信息",a.data),this.SDK.gameManager.changeControler(a.data.gameState.curActionPlayer),this.SDK.gameManager.Player.reset()):r==D.Map?(C("接收到地图同步信息",a.data),this.SDK.gameManager.syncMap(a.data)):r==D.Result?(C("接收到结算结果信息",a.data),C("结算界面取消控制权"),this.SDK.gameManager.isControler=!1,this.SDK.gameManager.isRunning=!1,this.SDK.leaveRoom(),this.SDK.setGroupPlayerStatus(N.NotReady),(n=this.SDK.gameManager.ResultBoard).setResult(a.data),this.ChangeBoard(n)):r==D.NetState?C("接收到在线状态变更信息",a.data):r==D.AI?(C("接收到AI控制消息",a.data),i=a.data.type,o=a.data.data,i==B.StartJump&&this.SDK.gameManager.OtherTeam.PowerEnd(o)):C("接收到错误的信息-data",t);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"onRecvFromClient",value:(c=m(regeneratorRuntime.mark((function e(t){var a,r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(t.data.msg),r=a.type,n=a.data,i=t.data.sendPlayerId,o=null,r==f.Power?(o="队友",this.SDK.gameManager.Player.teammatePower()):r==f.PowerEnd?(o="队友",this.SDK.gameManager.Player.teammatePowerEnd(n)):r==f.EnemyPowerEnd?(o="敌人",this.SDK.gameManager.OtherTeam.PowerEnd(n)):r==f.emoji?(o=i,this.uiControl.showEmoji(n,i)):f.SyncComplete,C("接收到来自其他客户端的消息["+o+"]","类型序号:",r," 数据:",n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"onTimerSingal",value:(g=m(regeneratorRuntime.mark((function e(){var t,a,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dead||!this.SDK.gameManager.isRunning){e.next=24;break}return e.next=3,this.SDK.sendToServer(K.Heart,this.SDK.gameManager.serverTeam.id);case 3:if((t=e.sent)==MGOBE.ErrCode.EC_OK){e.next=10;break}return C("心跳发送失败","客户端已断开",t),this.SDK.gameManager.isRunning=!1,new M(this.scene,this.SDK,"已断开连接,请退出游戏重新进入",R.single,"知道了").show(this,(function(){n.SDK.curDialog.destroy()})),e.abrupt("return");case 10:if(a=this.SDK.gameManager.Util.getLocalTime(),r=this.SDK.gameManager.gameTime-(a-this.SDK.gameManager.startTime),this.SDK.gameManager.startTime,this.uiControl.setTime(r),!(r<=0)){e.next=21;break}return this.SDK.gameManager.isRunning=!1,this.SDK.gameManager.isControler=!1,this.SDK.gameManager.timerSingal=null,this.uiControl.gameEnd(),e.next=21,this.SDK.sendToServer(K.End,a);case 21:5!=r||this.audio_last5s_tag||(this.audio_last5s_tag=!0,this.SDK.gameManager.Util.playAudio(this.SDK.gameManager.audio_last5s)),this.uiControl.refreshEmoji(),this.controlTime>0&&!this.SDK.gameManager.Player._stat_power&&!this.SDK.gameManager.Player._stat_jump?this.controlTime-=.5:this.controlTime<=0&&this.controlTime>=-10&&(this.controlTime=-100,this.SDK.gameManager.isControler=!1,this.onAvatarSingal(!0,!1),this.onUIRefresh(),this.SDK.sendToServer(K.ChangeControler));case 24:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"refreshScore",value:function(){if(this.SDK.gameManager.serverTeam.id==v.red){var e=0,t=0;this.SDK.gameManager.serverTeam.playerList.map((function(t){e+=t.score})),this.SDK.gameManager.otherTeam.playerList.map((function(e){t+=e.score})),this.team1Node.getChildByName("score").getChildByName("num").getComponent(u).string="".concat(e),this.team2Node.getChildByName("score").getChildByName("num").getComponent(u).string="".concat(t)}else{var a=0,r=0;this.SDK.gameManager.serverTeam.playerList.map((function(e){a+=e.score})),this.SDK.gameManager.otherTeam.playerList.map((function(e){r+=e.score})),this.team2Node.getChildByName("score").getChildByName("num").getComponent(u).string="".concat(a),this.team1Node.getChildByName("score").getChildByName("num").getComponent(u).string="".concat(r)}}},{key:"onUIRefresh",value:function(){this.uiControl.refreshState(),this.refreshScore()}},{key:"onAvatarSingal",value:function(e,t){e?t?(this.controlTime=5,C(1,this.uiControl.selfAvatar),this.uiControl.selfAvatar.getComponent(T).timeStart()):(this.controlTime=-100,C(2,this.uiControl.selfAvatar),this.uiControl.selfAvatar.getComponent(T).reset()):t?(C(3,this.uiControl.teammaterAvatar),this.uiControl.teammaterAvatar.getComponent(T).timeStart()):(C(4,this.uiControl.teammaterAvatar),this.uiControl.teammaterAvatar.getComponent(T).reset())}},{key:"InitEvent",value:(l=m(regeneratorRuntime.mark((function e(){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(o(t.prototype),"InitEvent",this).call(this),a=this.board.getChildByName("Interaction-ex"),this.team1Node=this.board.getChildByName("Header").getChildByName("team0"),this.team2Node=this.board.getChildByName("Header").getChildByName("team1"),this.comp1=this.team1Node.getChildByName("avatar-1").getChildByName("avatar"),this.comp2=this.team1Node.getChildByName("avatar-2").getChildByName("avatar"),this.comp3=this.team2Node.getChildByName("avatar-1").getChildByName("avatar"),this.comp4=this.team2Node.getChildByName("avatar-2").getChildByName("avatar"),a.getChildByName("emoji_1").on(d.TOUCH_END,this.sendEmoji_1,this),a.getChildByName("emoji_2").on(d.TOUCH_END,this.sendEmoji_2,this),a.getChildByName("emoji_3").on(d.TOUCH_END,this.sendEmoji_3,this),a.getChildByName("emoji_4").on(d.TOUCH_END,this.sendEmoji_4,this),e.next=14,this.SDK.getTeamId();case 14:return r=e.sent,e.next=17,this.SDK.getPlayerIndex();case 17:n=e.sent,this.loadAvatar(),r==v.red?1==n?(this.uiControl.selfAvatar=this.comp1,this.uiControl.teammaterAvatar=this.comp2):(this.uiControl.selfAvatar=this.comp2,this.uiControl.teammaterAvatar=this.comp1):1==n?(this.uiControl.selfAvatar=this.comp3,this.uiControl.teammaterAvatar=this.comp4):(this.uiControl.selfAvatar=this.comp4,this.uiControl.teammaterAvatar=this.comp3),C("头像com设置完成");case 21:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadAvatar",value:(h=m(regeneratorRuntime.mark((function e(){var t,a,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getRoomInfo();case 2:t=e.sent,a=[],r=[],t.playerList.map((function(e){e.teamId===v.red&&a.push(e),e.teamId===v.blue&&r.push(e)})),a.map(function(){var e=m(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.SDK.getPlayerIndex(t.id);case 2:1===e.sent?n.SDK.gameManager.Util.setAvatar(n.comp1,a[0],!0):n.SDK.gameManager.Util.setAvatar(n.comp2,a[1],!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.map(function(){var e=m(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.SDK.getPlayerIndex(t.id);case 2:1===e.sent?n.SDK.gameManager.Util.setAvatar(n.comp3,r[0],!0):n.SDK.gameManager.Util.setAvatar(n.comp4,r[1],!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"sendEmoji_1",value:function(){this.SDK.sendToRoom(f.emoji,S.Angry)}},{key:"sendEmoji_2",value:function(){this.SDK.sendToRoom(f.emoji,S.Worship)}},{key:"sendEmoji_3",value:function(){this.SDK.sendToRoom(f.emoji,S.Unfortunately)}},{key:"sendEmoji_4",value:function(){this.SDK.sendToRoom(f.emoji,S.Applause)}}]),t}(k)),h._RF.pop()}}}));

System.register("chunks:///UI/Dialog/RulesDialog.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Const.js"],(function(e,t){var n,i,r,s,a,o,u,l,c,d,h;return{setters:[function(e){n=e.createClass,i=e.classCallCheck,r=e.asyncToGenerator},function(e){s=e.cclegacy,a=e.tween,o=e.Vec3,u=e.loader,l=e.Prefab,c=e.instantiate,d=e.SystemEventType},function(e){h=e.log}],execute:function(){s._RF.push({},"f1725lk6shAIZvaTtd6I/DQ","RulesDialog",void 0),e("RulesDialog",function(){function e(t,n){i(this,e),this.scene=null,this.node=null,this.SDK=null,this.dead=!1,this.scene=t,this.SDK=n}var t,s;return n(e,[{key:"InitBoard",value:(s=r(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h("弹窗预制件实例化:"),t=new Promise((function(e){u.loadRes("Prefab/Dialog/RulesDialog",l,(function(t,i){t?(h("弹框实例化失败",t),e(!1)):(h("弹框实例化成功"),n.node=c(i),n.scene.getChildByName("UI").addChild(n.node),n.node.setSiblingIndex(100),e(!0))}))})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"destroy",value:function(){if(!this.dead){if(!this.node)return void(this.SDK=null);this.dead=!0,this.scene=null,a(this.node.getChildByName("background")).to(.3,{scale:new o(0,0,0)},{onComplete:function(){this.SDK.curDialog=null,this.SDK=null,this.node.destroy(),this.node=null}.bind(this)}).start()}}},{key:"show",value:(t=r(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.SDK.curDialog){e.next=13;break}return e.next=3,this.InitBoard();case 3:if(e.sent){e.next=7;break}return this.destroy(),e.abrupt("return");case 7:this.SDK.curDialog=this,n=this.node.getChildByName("background").getChildByName("exit"),this.node.getChildByName("background").setScale(new o(0,0,0)),this.node.active=!0,a(this.node.getChildByName("background")).to(.3,{scale:new o(1,1,1)}).start(),n.on(d.TOUCH_START,(function(){i.SDK.curDialog.dead||i.SDK.curDialog.destroy()}),t);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}()),s._RF.pop()}}}));

System.register("chunks:///UI/Board/MainBoard.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Config.js","../../Const.js","./BaseBoard.js","../Dialog/RulesDialog.js"],(function(e,t){var a,r,i,n,o,s,h,l,g,c,m,u,d,y,v,C;return{setters:[function(e){a=e.inherits,r=e.createClass,i=e.classCallCheck,n=e.possibleConstructorReturn,o=e.getPrototypeOf,s=e.asyncToGenerator,h=e.get},function(e){l=e.cclegacy,g=e._decorator,c=e.SystemEventType,m=e.Label},function(e){u=e.serverURL},function(e){d=e.log},function(e){y=e.BaseBoard},function(e){v=e.RulesDialog}],execute:function(){l._RF.push({},"253a4372BVD94kGBxFcROCR","MainBoard",void 0),g.ccclass,g.property,C=function(){function e(t,a){i(this,e),this.board=t,this.SDK=a}var t,a;return r(e,[{key:"initUI",value:(a=s(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.board=t,e.next=3,this.initUserData();case 3:a=this.board.getChildByName("Header"),this.weekDataNode=a.getChildByName("career").getChildByName("weekData"),this.loverDataNode=a.getChildByName("top").getChildByName("bgHistory"),1===this.SDK.gameManager.PlayerData.gender?(this.selfAvatarNode=a.getChildByName("top").getChildByName("Avatar").getChildByName("Sprite"),this.otherAvatarNode=a.getChildByName("top").getChildByName("Avatar2").getChildByName("Sprite")):(this.selfAvatarNode=a.getChildByName("top").getChildByName("Avatar2").getChildByName("Sprite"),this.otherAvatarNode=a.getChildByName("top").getChildByName("Avatar").getChildByName("Sprite")),this.SDK.gameManager.PlayerData.isVip?(a.getChildByName("top").getChildByName("Avatar").getChildByName("isVip").active=!0,a.getChildByName("top").getChildByName("Avatar2").getChildByName("isVip").active=!0):(a.getChildByName("top").getChildByName("Avatar").getChildByName("isVip").active=!1,a.getChildByName("top").getChildByName("Avatar2").getChildByName("isVip").active=!1),this.SDK.gameManager.Util.loadRemoteImg(this.SDK.gameManager.PlayerData.avatar_url,this.selfAvatarNode),this.SDK.gameManager.loverData&&this.SDK.gameManager.loverData.avatar&&(r="https://".concat(this.SDK.gameManager.loverData.avatar.host,"/").concat(this.SDK.gameManager.loverData.avatar.path),this.SDK.gameManager.Util.loadRemoteImg(r,this.otherAvatarNode)),this.weekDataNode.getChildByName("num").getChildByName("value").getComponent(m).string="".concat(this.SDK.gameManager.PlayerData.playCountWeek),this.weekDataNode.getChildByName("rate").getChildByName("value").getComponent(m).string="".concat(this.SDK.gameManager.PlayerData.winCountWeek),this.weekDataNode.getChildByName("mvp").getChildByName("value").getComponent(m).string="".concat(this.SDK.gameManager.PlayerData.mvpCountWeek),this.loverDataNode.getChildByName("total").getComponent(m).string="".concat(this.SDK.gameManager.PlayerData.loverCount),this.loverDataNode.getChildByName("victory").getComponent(m).string="".concat(this.SDK.gameManager.PlayerData.loverWinCount);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"initUserData",value:(t=s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.gameManager.Util.http(u.gameInit,"GET",{},!1,this.SDK.gameManager.AccessToken);case 2:t=e.sent,this.SDK.gameManager.PlayerData.loverCount=t.lover_match_info.game_match_count?t.lover_match_info.game_match_count:0,this.SDK.gameManager.PlayerData.loverWinCount=t.lover_match_info.win_count?t.lover_match_info.win_count:0,this.SDK.gameManager.PlayerData.tacitScore=t.lover_match_info.tacit_score?t.lover_match_info.tacit_score:0,this.board.getChildByName("Header").getChildByName("top").getChildByName("Lv").getComponent(m).string="恋人Lv.".concat(this.SDK.gameManager.Util.loverLevel(this.SDK.gameManager.PlayerData.tacitScore)),this.board.getChildByName("Header").getChildByName("top").getChildByName("LvHeart").getChildByName("Lv").getComponent(m).string="".concat(this.SDK.gameManager.Util.loverLevel(this.SDK.gameManager.PlayerData.tacitScore));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),e("MainBoard",function(e){function t(e,a){var r;return i(this,t),(r=n(this,o(t).call(this,e,a))).name="MainBoard",r.uiControl=new C(r.board,r.SDK),r}var l,g,m;return a(t,e),r(t,[{key:"InitEvent",value:(m=s(regeneratorRuntime.mark((function e(){var a,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(o(t.prototype),"InitEvent",this).call(this),a=this.board.getChildByName("MatchButton").getChildByName("single"),r=this.board.getChildByName("MatchButton").getChildByName("lover"),i=this.board.getChildByName("Nav").getChildByName("rules"),a.on(c.TOUCH_START,this.clickSingleMatch,this),r.on(c.TOUCH_START,this.clickLoverMatch,this),i.on(c.TOUCH_START,this.clickRules,this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"clickSingleMatch",value:(g=s(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("尝试单人匹配"),t=this.SDK.gameManager.MatchingBoard,a=this.SDK,e.next=5,this.ChangeBoard(t);case 5:a.matchingSingle();case 6:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"clickLoverMatch",value:(l=s(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.createGroup();case 2:if(0!==(t=e.sent)){e.next=9;break}return a=this.SDK.gameManager.WaitLoverBoard,e.next=7,this.ChangeBoard(a);case 7:e.next=10;break;case 9:d("队组创建失败",t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"clickRules",value:function(){this.SDK.curDialog||new v(this.scene,this.SDK).show(this)}}]),t}(y)),l._RF.pop()}}}));

System.register("chunks:///UI/Board/MatchingBoard.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Config.js","../../Const.js","../Dialog/Dialog.js","./BaseBoard.js"],(function(e,t){var a,r,n,i,s,o,h,c,u,l,m,g,d,v,y,f,p,C,S,D,B,K,x,k,b;return{setters:[function(e){a=e.inherits,r=e.createClass,n=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,o=e.get,h=e.asyncToGenerator},function(e){c=e.cclegacy,u=e.SystemEventType,l=e.Label,m=e.Animation,g=e.Vec3},function(e){d=e.Env,v=e.EnvType,y=e.DebugGameTime},function(e){f=e.log,p=e.ClientDataType,C=e.RoomDataType,S=e.DialogButtonType,D=e.NetState,B=e.ServerDataType,K=e.TeamColor},function(e){x=e.Dialog},function(e){k=e.BaseBoard}],execute:function(){c._RF.push({},"b8dbbjBDbxP+YYY37doxtEY","MatchingBoard",void 0),b=function(){function e(t,a){n(this,e),this.board=null,this.SDK=null,this.team1=null,this.team2=null,this.circle=null,this.board=t,this.SDK=a}var t,a,i,s;return r(e,[{key:"initUI",value:(s=h(regeneratorRuntime.mark((function e(t){var a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.board=t,this.team1=this.board.getChildByName("team1"),this.team2=this.board.getChildByName("team2"),this.circle=this.board.getChildByName("circle"),e.next=6,this.SDK.getGroupInfo();case 6:return a=e.sent,e.next=9,this.SDK.getPlayerInfo();case 9:if(r=e.sent,n=null,this.circle.getComponent(m).onLoad(),this.circle.setRotationFromEuler(0,0,0),this.circle.setScale(1,1,1),this.circle.getChildByName("red").active=!0,this.circle.getChildByName("red1").active=!0,this.circle.getChildByName("blue").active=!0,this.circle.getChildByName("blue1").active=!0,this.team1.getChildByName("card").getChildByName("user2").active=!1,this.team1.getChildByName("card").getChildByName("user2_wait").active=!0,this.team2.getChildByName("card").getChildByName("user1").active=!1,this.team2.getChildByName("card").getChildByName("user2").active=!1,this.team2.getChildByName("card").getChildByName("user1_wait").active=!0,this.team2.getChildByName("card").getChildByName("user2_wait").active=!0,this.team1.getChildByName("card").getChildByName("Lover").active=!1,this.team2.getChildByName("card").getChildByName("Lover").active=!1,this.board.getChildByName("CancelMatchButton").active=!0,a)for(this.showLoverUI(),n=a.groupPlayerList,i=0;i<n.length;i++)(s=n[i]).id==r.id?this.setPlayer(1,1,s):this.setPlayer(1,2,s);else this.setPlayer(1,1,r);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"initData",value:function(){}},{key:"matchSuccess",value:(i=h(regeneratorRuntime.mark((function e(){var t,a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoverUI(),e.next=3,this.SDK.getRoomInfo();case 3:return t=e.sent,e.next=6,this.SDK.getPlayerInfo();case 6:for(a=e.sent,r=t.playerList,n=1,i=0;i<r.length;i++)(s=r[i]).teamId==a.teamId?s.id==a.id?this.setPlayer(1,1,s):this.setPlayer(1,2,s):(this.setPlayer(2,n,s),n+=1);this.board.getChildByName("guide").getComponent(l).string="匹配成功,等待进入游戏";case 11:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setTime",value:function(e){this.board&&(this.board.getChildByName("guide").getComponent(l).string="正在匹配("+Math.floor(e)+"s)")}},{key:"setPlayer",value:function(e,t,a){f("playerNum: ",t);var r=null,n=null,i=null;if(r=this.team1,2==e&&(r=this.team2),n=r.getChildByName("card").getChildByName("user1"),i=r.getChildByName("card").getChildByName("user1_wait"),2==t&&(n=r.getChildByName("card").getChildByName("user2"),i=r.getChildByName("card").getChildByName("user2_wait")),a){n.getChildByName("nickName").getComponent(l).string=a.name;var s=n.getChildByName("avatarBg").getChildByName("avatar");a.customProfile=a.profile?a.profile:a.customProfile?a.customProfile:a.customGroupPlayerProfile,this.SDK.gameManager.Util.setAvatar(s,a,!1),n.active=!0,i&&(i.active=!1)}else n.active=!1,i&&(i.active=!0)}},{key:"showLoverUI",value:(a=h(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.gameManager.Util.teammaterIsLover();case 2:return t=e.sent,e.next=5,this.SDK.gameManager.Util.enemyIsLover();case 5:a=e.sent,this.team1.getChildByName("card").getChildByName("Lover").active=!!t,this.team2.getChildByName("card").getChildByName("Lover").active=!!a;case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"changeMatchStatus",value:(t=h(regeneratorRuntime.mark((function e(){var t,a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeamId();case 2:t=e.sent,a=this.circle.getComponent(m).clips[0],t==K.blue&&(a.curves[0].data.values[1]=new g(0,0,90)),t==K.red&&(a.curves[0].data.values[1]=new g(0,0,-90)),this.circle.getChildByName("red").active=!1,this.circle.getChildByName("red1").active=!1,this.circle.getChildByName("blue").active=!1,this.circle.getChildByName("blue1").active=!1,this.board.getChildByName("CancelMatchButton").active=!1,this.circle.getComponent(m).play(),this.circle.getComponent(m).once(m.EventType.FINISHED,(function(){r.circle.getComponent(m).onDestroy()}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),e("MatchingBoard",function(e){function t(e,a){var r;return n(this,t),(r=i(this,s(t).call(this,e,a))).uiControl=null,r.matchingTime=0,r.initTime=0,r.waitInit=!1,r.name="MatchingBoard",r.uiControl=new b(r.board,r.SDK),r}var c,l,m,g,K,k,N;return a(t,e),r(t,[{key:"setListener",value:function(){o(s(t.prototype),"setListener",this).call(this),this.SDK.Room.onCancelMatch=this.onCancelMatch.bind(this),this.SDK.Room.onMatch=this.onMatch.bind(this),this.SDK.curRoom.onRecvFromClient=this.onRecvFromClient.bind(this),this.SDK.curRoom.onChangePlayerNetworkState=this.onChangePlayerNetworkState.bind(this),this.SDK.curRoom.onLeaveRoom=this.onLeaveRoom.bind(this),this.SDK.curRoom.onRecvFromGameSvr=this.onRecvFromGameSvr.bind(this),this.SDK.gameManager.timerSingal=this.onTimerSingal.bind(this)}},{key:"destroy",value:function(){o(s(t.prototype),"destroy",this).call(this)}},{key:"initData",value:function(){o(s(t.prototype),"initData",this).call(this),this.matchingTime=0,this.initTime=0,this.waitInit=!1}},{key:"onTimerSingal",value:function(){this.dead||(this.waitInit?(this.initTime+=.5,this.initTime>2&&this.initTime<100&&(f("未正常接收到初始化数据,发送请求初始化数据请求"),this.SDK.sendToServer(p.RequestInitData,1),this.initTime=1e7)):(this.uiControl.setTime(this.matchingTime),this.matchingTime+=.5))}},{key:"onCancelMatch",value:(N=h(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f("接收到取消匹配的信号",t),e.next=3,this.SDK.getGroupInfo();case 3:return a=e.sent,f("接收到取消匹配信号时的队组信息",a),r=null,r=a?this.SDK.gameManager.WaitLoverBoard:this.SDK.gameManager.MainBoard,e.next=9,this.ChangeBoard(r);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"onMatch",value:(k=h(regeneratorRuntime.mark((function e(t){var a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.data.errCode!==this.SDK.errorCode.EC_OK){e.next=25;break}return f("匹配成功",t.data),this.SDK.curRoom.initRoom(t.data.roomInfo),this.SDK.Listener.add(this.SDK.curRoom),this.waitInit=!0,this.uiControl.matchSuccess(),this.uiControl.changeMatchStatus(),e.next=9,this.SDK.getGroupInfo();case 9:if(e.sent){e.next=24;break}return e.next=13,this.SDK.getPlayerIndex();case 13:if(1!=e.sent){e.next=24;break}return e.next=17,this.SDK.createGroup();case 17:if(e.sent!=MGOBE.ErrCode.EC_OK){e.next=24;break}return e.next=21,this.SDK.getGroupInfo();case 21:return a=e.sent,e.next=24,this.SDK.sendToRoom(C.MatchedJoinGroup,a.id);case 24:return e.abrupt("return");case 25:f("匹配超时"),new x(this.scene,this.SDK,"未匹配到房间",S.single,"回到首页").show(this,h(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.SDK.curDialog.dead){e.next=2;break}return e.abrupt("return");case 2:return r.SDK.curDialog.destroy(),e.next=5,r.SDK.getGroupInfo();case 5:return t=e.sent,a=null,a=t?r.SDK.gameManager.WaitLoverBoard:r.SDK.gameManager.MainBoard,e.next=10,r.ChangeBoard(a);case 10:case"end":return e.stop()}}),e)}))));case 28:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"onLeaveRoom",value:(K=h(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dead){e.next=16;break}return this.dead=!0,a=t.data.leavePlayerId,e.next=5,this.SDK.getLoverInfo();case 5:return e.sent,e.next=8,this.SDK.getGroupInfo();case 8:return r=e.sent,f("离开房间",a,"离开了准备房间"),e.next=12,this.SDK.leaveRoom();case 12:return n=null,n=r?this.SDK.gameManager.WaitLoverBoard:this.SDK.gameManager.MainBoard,e.next=16,this.ChangeBoard(n);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return K.apply(this,arguments)})},{key:"onChangePlayerNetworkState",value:(g=h(regeneratorRuntime.mark((function e(t){var a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dead){e.next=21;break}return this.dead=!0,a=t.data.changePlayerId,e.next=5,this.SDK.getLoverInfo();case 5:if(r=e.sent,n=t.data.networkState,f("[Matching]在线状态变化",a,":",n),n!=D.Offline){e.next=21;break}return e.next=11,this.SDK.leaveRoom();case 11:if(!r||r.netState!=D.Online){e.next=18;break}return this.SDK.leaveGroup(),i=this.SDK.gameManager.WaitLoverBoard,e.next=16,this.ChangeBoard(i);case 16:e.next=21;break;case 18:return s=this.SDK.gameManager.MainBoard,e.next=21,this.ChangeBoard(s);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"onRecvFromGameSvr",value:(m=h(regeneratorRuntime.mark((function e(t){var a,r,n,i,s,o,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f("接收到实时服务器的数据:",t.data),a=t.data.data,(r=a.type)!=B.Init){e.next=10;break}this.SDK.gameManager.timerSingal=null,n=a.data,f("初始化参数:",n),this.SDK.gameManager.node.emit("GameInit",n),e.next=21;break;case 10:if(r!=B.Start){e.next=21;break}return this.SDK.gameManager.isRunning=!0,i=a.data,this.SDK.gameManager.startTime=i.startTime,s=this.SDK.gameManager.Util.getLocalTime(),Math.abs(s-i.startTime)>5&&new x(this.scene,this.SDK,"检测到您本地时间有误,可能导致游戏倒计时显示错误",S.single,"知道了").show(this,(function(){h.SDK.curDialog.destroy()})),d==v.develop?this.SDK.gameManager.gameTime=y:this.SDK.gameManager.gameTime=a.data.gameTime,f("[游戏开始数据]",i),o=this.SDK.gameManager.GamingBoard,e.next=21,this.ChangeBoard(o);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"onRecvFromClient",value:(l=h(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data.msg),r=a.type,n=a.data,t.data.sendPlayerId,r!=C.MatchedJoinGroup){e.next=8;break}return f("接收到路人组队的队组ID",n),e.next=8,this.SDK.joinGroup(n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"InitEvent",value:function(){o(s(t.prototype),"InitEvent",this).call(this),this.board.getChildByName("CancelMatchButton").getChildByName("Button").on(u.TOUCH_START,this.clickCancelMatch,this)}},{key:"clickCancelMatch",value:(c=h(regeneratorRuntime.mark((function e(){var t,a,r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dead){e.next=3;break}return f("点击取消,但是dead",this.name),e.abrupt("return");case 3:return this.dead=!0,e.next=6,this.SDK.getRoomInfo();case 6:return t=e.sent,e.next=9,this.SDK.getGroupInfo();case 9:return a=e.sent,e.next=12,this.SDK.getPlayerInfo();case 12:if(e.sent,r=!1,!t){e.next=20;break}return e.next=17,this.SDK.leaveRoom();case 17:(n=e.sent)===this.SDK.errorCode.EC_OK?f("匹配成功后退出房间","成功"):f("匹配成功后退出房间","失败",n),r=!0;case 20:if(r){e.next=27;break}return e.next=23,this.SDK.cancelMatchinig();case 23:(i=e.sent)===this.SDK.errorCode.EC_OK?f("取消匹配","成功"):f("取消匹配:","失败",i),e.next=44;break;case 27:if(s=null,!a){e.next=41;break}return e.next=31,this.SDK.gameManager.Util.teammaterIsLover();case 31:if(!e.sent){e.next=36;break}s=this.SDK.gameManager.WaitLoverBoard,e.next=39;break;case 36:return e.next=38,this.SDK.leaveGroup();case 38:s=this.SDK.gameManager.MainBoard;case 39:e.next=42;break;case 41:s=this.SDK.gameManager.MainBoard;case 42:return e.next=44,this.ChangeBoard(s);case 44:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})}]),t}(k)),c._RF.pop()}}}));

System.register("chunks:///UI/Board/ResultBoard.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Const.js","./BaseBoard.js"],(function(e,t){var a,i,r,n,o,l,d,s,c,m,g,h,y,u,B,C,v,N,p,f,M;return{setters:[function(e){a=e.inherits,i=e.createClass,r=e.classCallCheck,n=e.possibleConstructorReturn,o=e.getPrototypeOf,l=e.get,d=e.asyncToGenerator},function(e){s=e.cclegacy,c=e.Animation,m=e.Label,g=e.ProgressBar,h=e.SystemEventType,y=e.AudioSource,u=e.Vec3},function(e){B=e.log,C=e.TeamColor,v=e.PlayerState,N=e.GroupMessageType,p=e.GroupSysMessageType},function(e){f=e.BaseBoard}],execute:function(){s._RF.push({},"8a67cE5ERBGL6NMmCPaURz2","ResultBoard",void 0),M=function(){function e(t,a){r(this,e),this.board=null,this.SDK=null,this.isLover=!1,this.redTeam=[],this.blueTeam=[],B("初始化UI控制"),this.board=t,this.SDK=a}var t,a,n;return i(e,[{key:"initData",value:(n=d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeammate();case 2:e.sent?this.setOnceMore(0):this.setOnceMore(4);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"initUI",value:(a=d(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board=t,this.onceMore=this.board.getChildByName("onceMore"),this.changeTeammater=this.board.getChildByName("other"),this.homepage=this.board.getChildByName("back"),B("INITUI",this.onceMore);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setResult",value:function(e){}},{key:"initBoardData",value:(t=d(regeneratorRuntime.mark((function e(t){var a,i,r,n,o,l,s,h,B,v,N,p,f,M=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.board.getChildByName("scoreBoard").getChildByName("cup"),e.next=3,this.SDK.getPlayerInfo();case 3:if(i=e.sent,a.getChildByName("win").active=!1,a.getChildByName("draw").active=!1,a.getChildByName("default").active=!1,this.board.getChildByName("scoreBoard").getChildByName("mvp").active=!1,t.winnerTeam||(a.getChildByName("draw").active=!0),!(this.SDK.gameManager.serverPlayer.teamId==C.red&&t.winnerTeam==C.red||this.SDK.gameManager.serverPlayer.teamId==C.blue&&t.winnerTeam==C.blue)){e.next=16;break}return e.next=12,this.SDK.gameManager.Util.loadImg("Texture/UI/result/ying/spriteFrame",this.board.getChildByName("scoreBoard"));case 12:a.getChildByName("win").active=!0,a.getChildByName("win").getComponent(c).on(c.EventType.FINISHED,(function(){a.getChildByName("win").getComponent(c).play(a.getChildByName("win").getComponent(c).clips[1].name)})),a.getChildByName("win").getComponent(c).play(),this.SDK.gameManager.getComponent(y).playOneShot(this.SDK.gameManager.audio_win,1);case 16:if(!(this.SDK.gameManager.serverPlayer.teamId==C.red&&t.winnerTeam==C.blue||this.SDK.gameManager.serverPlayer.teamId==C.blue&&t.winnerTeam==C.red)){e.next=21;break}return e.next=19,this.SDK.gameManager.Util.loadImg("Texture/UI/result/shu/spriteFrame",this.board.getChildByName("scoreBoard"));case 19:a.getChildByName("default").active=!0,this.SDK.gameManager.Util.playAudio(this.SDK.gameManager.audio_failed);case 21:return r=null,e.next=24,this.SDK.gameManager.Util.teammaterIsLover();case 24:if(this.isLover=e.sent,!this.isLover){e.next=42;break}return this.board.getChildByName("scoreBoard").getChildByName("loverBoard").active=!0,this.board.getChildByName("scoreBoard").getChildByName("strengerBoard").active=!1,r=this.board.getChildByName("scoreBoard").getChildByName("loverBoard"),e.next=31,this.SDK.getLoverInfo();case 31:n=e.sent,o=JSON.parse(i.profile),l=JSON.parse(n.profile),s=r.getChildByName("top").getChildByName("Avatar").getChildByName("boyAvatar"),h=r.getChildByName("top").getChildByName("Avatar2").getChildByName("girlAvatar"),1===o.gender?(this.SDK.gameManager.Util.loadRemoteImg(o.avatar_url,s),this.SDK.gameManager.Util.loadRemoteImg(l.avatar_url,h)):(this.SDK.gameManager.Util.loadRemoteImg(l.avatar_url,s),this.SDK.gameManager.Util.loadRemoteImg(o.avatar_url,h)),o.isVip?(s.getChildByName("isVip").active=!0,h.getChildByName("isVip").active=!0):(s.getChildByName("isVip").active=!1,h.getChildByName("isVip").active=!1),B=r.getChildByName("top").getChildByName("ProgressBar"),t.tacit_score_info&&t.tacit_score_info.length&&(v=t.tacit_score_info.filter((function(e){return e.lover_id===JSON.parse(i.profile).lover_id}))[0],r.getChildByName("top").getChildByName("Lv").getComponent(m).string="恋人Lv.".concat(this.SDK.gameManager.Util.loverLevel(v.original_tacit_score)),r.getChildByName("top").getChildByName("LvHeart").getChildByName("Lv").getComponent(m).string="".concat(this.SDK.gameManager.Util.loverLevel(v.original_tacit_score)),r.getChildByName("top").getChildByName("desc").getChildByName("score").getComponent(m).string="+".concat(v.add_tacit_score),N=v.original_tacit_score,p=v.original_tacit_score+v.add_tacit_score,this.progressBarScore(B,N),setTimeout((function(){var e=setInterval((function(){if(N>=p)return r.getChildByName("top").getChildByName("Lv").getComponent(m).string="恋人Lv.".concat(M.SDK.gameManager.Util.loverLevel(p)),r.getChildByName("top").getChildByName("LvHeart").getChildByName("Lv").getComponent(m).string="".concat(M.SDK.gameManager.Util.loverLevel(p)),void clearInterval(e);N<p&&((50==++N||100===N||200===N||500===N||1e3===N||2e3===N||3e3===N||5e3===N||7e3===N||1e4===N)&&N<p?B.getComponent(g).progress=0:M.progressBarScore(B,N))}),10)}),3600)),e.next=45;break;case 42:this.board.getChildByName("scoreBoard").getChildByName("loverBoard").active=!1,this.board.getChildByName("scoreBoard").getChildByName("strengerBoard").active=!0,r=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard");case 45:r.getChildByName("teamRed").getChildByName("avatars").children.map((function(e){e.getChildByName("onceMore").active=!1,e.getChildByName("leave").active=!1})),r.getChildByName("teamBlue").getChildByName("avatars").children.map((function(e){e.getChildByName("onceMore").active=!1,e.getChildByName("leave").active=!1})),(f=this.board.getChildByName("scoreBoard").getChildByName("mvp").getComponent(c)).onLoad(),Object.keys(t.teamList).map((function(e){t.teamList[e].id==C.red&&t.teamList[e].playerList.map(function(){var e=d(regeneratorRuntime.mark((function e(a,i){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.getChildByName("teamRed").getChildByName("avatars").getChildByName("avatar".concat(i+1)),M.redTeam.push({player:a,node:"avatar".concat(i+1)}),M.SDK.gameManager.Util.loadRemoteImg(a.avatar,n.getChildByName("avatar")),1===a.gender&&M.SDK.gameManager.Util.loadImg("/Texture/UI/result/boy/spriteFrame",n.getChildByName("avatar").getChildByName("gender")),2===a.gender&&M.SDK.gameManager.Util.loadImg("/Texture/UI/result/girl/spriteFrame",n.getChildByName("avatar").getChildByName("gender")),a.isVip?n.getChildByName("avatar").getChildByName("isVip").active=!0:n.getChildByName("avatar").getChildByName("isVip").active=!1,n.getChildByName("nickName")&&(n.getChildByName("nickName").getComponent(m).string=a.name),n.getChildByName("score").getComponent(m).string="+".concat(a.score),a.score,a.id===t.mvp&&(!M.isLover&&(f.clips[0].curves[1].data.values[1]=new u(n.getPosition().x-40,n.getPosition().y-170,0)),M.isLover&&(f.clips[0].curves[1].data.values[1]=new u(n.getPosition().x-190,n.getPosition().y-150,0)));case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),t.teamList[e].id==C.blue&&t.teamList[e].playerList.map((function(e,a){var i=r.getChildByName("teamBlue").getChildByName("avatars").getChildByName("avatar".concat(a+1));M.blueTeam.push({player:e,node:"avatar".concat(a+1)}),M.SDK.gameManager.Util.loadRemoteImg(e.avatar,i.getChildByName("avatar")),1===e.gender&&M.SDK.gameManager.Util.loadImg("/Texture/UI/result/boy/spriteFrame",i.getChildByName("avatar").getChildByName("gender")),2===e.gender&&M.SDK.gameManager.Util.loadImg("/Texture/UI/result/girl/spriteFrame",i.getChildByName("avatar").getChildByName("gender")),e.isVip?i.getChildByName("avatar").getChildByName("isVip").active=!0:i.getChildByName("avatar").getChildByName("isVip").active=!1,i.getChildByName("nickName")&&(i.getChildByName("nickName").getComponent(m).string=e.name),i.getChildByName("score").getComponent(m).string="+".concat(e.score),e.score,e.id===t.mvp&&(!M.isLover&&(f.clips[0].curves[1].data.values[1]=new u(i.getPosition().x-40,150+i.getPosition().y,0)),M.isLover&&(f.clips[0].curves[1].data.values[1]=new u(i.getPosition().x+120,i.getPosition().y-150,0)))})),t.mvp&&setTimeout((function(){M.board.getChildByName("scoreBoard").getChildByName("mvp").active=!0,f.play()}),300)}));case 52:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setOnceMore",value:function(e){switch(e){case 1:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(m).string="等待队友准备";break;case 2:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(m).string="队友已准备好,立即开始";break;case 3:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(m).string="再来一局";break;case 4:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_3/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(m).string="队友已离开";break;default:this.SDK.gameManager.Util.loadImg("Texture/UI/result/anniu_1/spriteFrame",this.onceMore),this.onceMore.getChildByName("Label").getComponent(m).string="再来一局"}}},{key:"progressBarScore",value:function(e,t){var a;a=t<=50?t/50:t>50&&t<=100?(t-50)/50:t>100&&t<=200?(t-100)/100:t>200&&t<=500?(t-200)/300:t>500&&t<=1e3?(t-500)/500:t>1e3&&t<=2e3?(t-1e3)/1e3:t>2e3&&t<=3e3?(t-2e3)/1e3:t>3e3&&t<=5e3?(t-3e3)/2e3:t>5e3&&t<=7e3?(t-5e3)/2e3:t>7e3&&t<=1e4?(t-7e3)/3e3:0,e.getComponent(g).progress=a}}]),e}(),e("ResultBoard",function(e){function t(e,a){var i;return r(this,t),(i=n(this,o(t).call(this,e,a))).uiControl=null,i.result=null,i.name="ResultBoard",i.uiControl=new M(i.board,i.SDK),i}var s,m,g,y,u,f,S,b;return a(t,e),i(t,[{key:"setResult",value:function(e){e&&(this.result=e)}},{key:"initData",value:function(){l(o(t.prototype),"initData",this).call(this),this.uiControl.initBoardData(this.result)}},{key:"setListener",value:function(){l(o(t.prototype),"setListener",this).call(this),this.SDK.curGroup.onChangeCustomGroupPlayerStatus=this.onChangeCustomGroupPlayerStatus.bind(this),this.SDK.curGroup.onRecvFromGroupClient=this.onRecvFromGroupClient.bind(this),this.SDK.curGroup.onLeaveGroup=this.onLeaveGroup.bind(this),this.SDK.gameManager.timerSingal&&(this.SDK.gameManager.timerSingal=null)}},{key:"onChangeCustomGroupPlayerStatus",value:(b=d(regeneratorRuntime.mark((function e(t){var a,i,r,n,o,l,d,s,c,m,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeammate();case 2:return a=e.sent,e.next=5,this.SDK.getPlayerInfo();case 5:if(i=e.sent,r=i.stateGroup,n=v.NotReady,o=this.board.getChildByName("scoreBoard").getChildByName("loverBoard").getChildByName("teamRed").getChildByName("avatars"),l=this.board.getChildByName("scoreBoard").getChildByName("loverBoard").getChildByName("teamBlue").getChildByName("avatars"),d=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard").getChildByName("teamRed").getChildByName("avatars"),s=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard").getChildByName("teamBlue").getChildByName("avatars"),a&&(n=a.customPlayerStatus,t.data.changePlayerId==a.id&&(n=t.data.customGroupPlayerStatus,r==v.Ready?n==v.Ready||(this.uiControl.setOnceMore(1),i.teamId===C.red?this.uiControl.redTeam.map((function(e){e.player.id===i.id&&(o.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,d.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,o.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,d.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)})):this.uiControl.blueTeam.map((function(e){e.player.id===i.id&&(l.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,s.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,l.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,s.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)}))):n==v.Ready?(this.uiControl.setOnceMore(2),i.teamId===C.red?this.uiControl.redTeam.map((function(e){e.player.id!==i.id&&(o.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,d.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,o.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,d.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)})):this.uiControl.blueTeam.map((function(e){e.player.id!==i.id&&(l.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,s.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,l.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,s.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)}))):(this.uiControl.setOnceMore(3),i.teamId===C.red?this.uiControl.redTeam.map((function(e){o.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,d.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,o.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,d.getChildByName("".concat(e.node)).getChildByName("leave").active=!1})):this.uiControl.blueTeam.map((function(e){l.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,s.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,l.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,s.getChildByName("".concat(e.node)).getChildByName("leave").active=!1}))))),r!=v.Ready||n!=v.Ready){e.next=32;break}return e.next=16,this.SDK.getGroupInfo();case 16:return c=e.sent,e.next=19,this.SDK.getPlayerInfo();case 19:if(m=e.sent,B("都准备完毕,进入匹配",c.owner,m.id),c.owner!=m.id){e.next=32;break}return e.next=24,this.SDK.matchingLover();case 24:if((g=e.sent)!=MGOBE.ErrCode.EC_OK){e.next=31;break}return e.next=28,this.SDK.sendToGroup(N.Sys,p.Matching);case 28:this.ChangeBoard(this.SDK.gameManager.MatchingBoard),e.next=32;break;case 31:B("进入匹配失败",g);case 32:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"onRecvFromGroupClient",value:(S=d(regeneratorRuntime.mark((function e(t){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B("接收到来自另一半的消息:",t),(a=JSON.parse(t.data.msg)).type!=N.Sys){e.next=7;break}if(a.content!=p.Matching){e.next=7;break}return i=this.SDK.gameManager.MatchingBoard,e.next=7,this.ChangeBoard(i);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"onChangeGroupPlayerNetworkState",value:(f=d(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B("玩家[",t.data.changePlayerId,"]在线状态有变化",t.data.networkState);case 1:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"onJoinGroup",value:function(e){B("有玩家加入队组:",e.data.joinPlayerId)}},{key:"onLeaveGroup",value:function(e){B("有人离开队组",e.data.leavePlayerId);var t,a=this.uiControl.blueTeam.concat(this.uiControl.redTeam);this.uiControl.isLover?(t=this.board.getChildByName("scoreBoard").getChildByName("loverBoard"),a.map((function(a){a.player.id===e.data.leavePlayerId&&(a.player.teamId===C.red?t.getChildByName("teamRed").getChildByName("avatars").getChildByName("".concat(a.node)).getChildByName("leave").active=!0:t.getChildByName("teamBlue").getChildByName("avatars").getChildByName("".concat(a.node)).getChildByName("leave").active=!0)}))):(t=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard"),a.map((function(a){a.player.id===e.data.leavePlayerId&&(a.player.teamId===C.red?t.getChildByName("teamRed").getChildByName("avatars").getChildByName("".concat(a.node)).getChildByName("leave").active=!0:t.getChildByName("teamBlue").getChildByName("avatars").getChildByName("".concat(a.node)).getChildByName("leave").active=!0)}))),this.uiControl.setOnceMore(4)}},{key:"InitEvent",value:(u=d(regeneratorRuntime.mark((function e(){var a,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(o(t.prototype),"InitEvent",this).call(this),a=this.board.getChildByName("back"),i=this.board.getChildByName("onceMore"),r=this.board.getChildByName("other"),a.on(h.TOUCH_START,this.clickHomepage,this),i.on(h.TOUCH_START,this.clickOnceMore,this),r.on(h.TOUCH_START,this.clickOther,this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"clickHomepage",value:(y=d(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveRoom();case 2:return t=e.sent,e.next=5,this.SDK.leaveGroup();case 5:return B("回到首页","离开队组结果:",t),a=this.SDK.gameManager.MainBoard,e.next=9,this.ChangeBoard(a);case 9:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"clickOnceMore",value:(g=d(regeneratorRuntime.mark((function e(){var t,a,i,r,n,o,l,d,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getTeammate();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return a=this.board.getChildByName("scoreBoard").getChildByName("loverBoard").getChildByName("teamRed").getChildByName("avatars"),i=this.board.getChildByName("scoreBoard").getChildByName("loverBoard").getChildByName("teamBlue").getChildByName("avatars"),r=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard").getChildByName("teamRed").getChildByName("avatars"),n=this.board.getChildByName("scoreBoard").getChildByName("strengerBoard").getChildByName("teamBlue").getChildByName("avatars"),e.next=11,this.SDK.getPlayerInfo();case 11:o=e.sent,l=o.stateGroup,d=t.customPlayerStatus,(s=l==v.Ready?v.NotReady:v.Ready)==v.Ready?d==v.Ready||(this.uiControl.setOnceMore(1),o.teamId===C.red?this.uiControl.redTeam.map((function(e){e.player.id===o.id&&(a.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,r.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,a.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,r.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)})):this.uiControl.blueTeam.map((function(e){e.player.id===o.id&&(i.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,n.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,i.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,n.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)}))):d==v.Ready?(this.uiControl.setOnceMore(2),o.teamId===C.red?this.uiControl.redTeam.map((function(e){e.player.id!==o.id&&(a.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,r.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,a.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,r.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)})):this.uiControl.blueTeam.map((function(e){e.player.id!==o.id&&(i.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,n.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!0,i.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,n.getChildByName("".concat(e.node)).getChildByName("leave").active=!1)}))):(this.uiControl.setOnceMore(3),o.teamId===C.red?this.uiControl.redTeam.map((function(e){a.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,r.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,a.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,r.getChildByName("".concat(e.node)).getChildByName("leave").active=!1})):this.uiControl.blueTeam.map((function(e){i.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,n.getChildByName("".concat(e.node)).getChildByName("onceMore").active=!1,i.getChildByName("".concat(e.node)).getChildByName("leave").active=!1,n.getChildByName("".concat(e.node)).getChildByName("leave").active=!1}))),this.SDK.setGroupPlayerStatus(s);case 17:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"clickDialogButton",value:(m=d(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.SDK.curDialog.destroy(),this.SDK.leaveGroup(),t=this.SDK.gameManager.MainBoard,e.next=5,this.ChangeBoard(t);case 5:this.initBoardElements();case 6:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"clickOther",value:(s=d(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveGroup();case 2:return t=this.SDK.gameManager.MatchingBoard,a=this.SDK,e.next=6,this.ChangeBoard(t);case 6:this.initBoardElements(),a.matchingSingle();case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"initBoardElements",value:function(){this.board.getChildByName("scoreBoard").getChildByName("mvp").getComponent(c).onDestroy()}}]),t}(f)),s._RF.pop()}}}));

System.register("chunks:///GameManager.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Box.js","./Config.js","./Const.js","./Player.js","./Util.js","./SDK.js","./UI/Dialog/Dialog.js","./UI/Board/WaitLoverBoard.js","./OtherPlayer.js","./UI/Board/GamingBoard.js","./UI/Board/MainBoard.js","./UI/Board/MatchingBoard.js","./UI/Board/ResultBoard.js"],(function(e,t){var r,n,i,a,s,o,u,l,c,h,d,m,p,f,g,y,v,x,_,b,P,w,D,B,k,S,T,C,R,K,I,N,U,M,G,z,O,L,E,A,j,F,J,W,q,H,V,Q,X,Y,Z,$,ee,te,re,ne,ie,ae,se,oe,ue,le,ce,he,de,me,pe,fe,ge,ye,ve,xe,_e,be,Pe,we,De,Be,ke,Se,Te,Ce,Re,Ke;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_dec17:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_descriptor16:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,a=e.possibleConstructorReturn,s=e.getPrototypeOf,o=e.assertThisInitialized,u=e.initializerDefineProperty,l=e.createClass,c=e.asyncToGenerator},function(e){h=e.cclegacy,d=e._decorator,m=e.Node,p=e.Camera,f=e.AudioClip,g=e.Vec3,y=e.tween,v=e.Component,x=e.instantiate,_=e.MeshRenderer,b=e.UITransform,P=e.Label,w=e.SystemEventType},function(e){D=e.Box},function(e){B=e.Env,k=e.EnvType,S=e.serverURL,T=e.DebugGameTime},function(e){C=e.log,R=e.ClientDataType,K=e.RoomDataType,I=e.BoxSize,N=e.DialogButtonType,U=e.ServerDataType,M=e.TeamColor,G=e.BoxShape},function(e){z=e.Player},function(e){O=e.Util},function(e){L=e.SDK},function(e){E=e.Dialog},function(e){A=e.WaitLoverBoard},function(e){j=e.OtherPlayer},function(e){F=e.GamingBoard},function(e){J=e.MainBoard},function(e){W=e.MatchingBoard},function(e){q=e.ResultBoard}],execute:function(){h._RF.push({},"1a8f1+varZBzIr09OsNwJXt","GameManager",void 0),Te=d.ccclass,Ce=d.property,Re=function(){function e(t,r){i(this,e),this.SDK=null,this.node=null,this.SDK=r,this.node=t;var n=this.node.getParent().getChildByName("UI").getChildByName("Debug");n.getChildByName("LeaveGroup").on(w.TOUCH_END,this.leaveGroup,this),n.getChildByName("PlayerInfo").on(w.TOUCH_END,this.getPlayerInfo,this),n.getChildByName("GroupInfo").on(w.TOUCH_END,this.getGroupInfo,this),n.getChildByName("RoomInfo").on(w.TOUCH_END,this.getRoomInfo,this),n.getChildByName("JoinGroup").on(w.TOUCH_END,this.joinGroup,this),n.getChildByName("LeaveRoom").on(w.TOUCH_END,this.leaveRoom,this),n.getChildByName("GameEnd").on(w.TOUCH_END,this.gameEnd,this),n.getChildByName("AI").getChildByName("toggle").on("toggle",this.AI,this)}var t,r,n,a,s,o,u,h;return l(e,[{key:"getRoomInfo",value:(h=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getRoomInfo();case 2:t=e.sent,C("房间信息:",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"leaveRoom",value:(u=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveRoom();case 2:0===(t=e.sent)?C("退出成功"):C("退出失败",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getGroupInfo",value:(o=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getGroupInfo();case 2:t=e.sent,C("队组信息",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"leaveGroup",value:(s=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.leaveGroup();case 2:0===(t=e.sent)?C("退出成功"):C("退出失败",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getPlayerInfo",value:(a=c(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.getPlayerInfo();case 2:return t=e.sent,C("玩家信息",t),e.next=6,this.SDK.gameManager.Util.teammaterIsLover();case 6:return r=e.sent,e.next=9,this.SDK.gameManager.Util.enemyIsLover();case 9:n=e.sent,C("队友是另一半",r),C("敌人是情侣",n);case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"joinGroup",value:(n=c(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.node.parent.getChildByName("UI").getChildByName("Debug").getChildByName("GroupId").getChildByName("TEXT_LABEL").getComponent(P).string,C("尝试加入队组:",t),e.next=4,this.SDK.joinGroup(t);case 4:if(0!==(r=e.sent)){e.next=14;break}return C("加入队组成功"),n=this.SDK.gameManager.WaitLoverBoard,C("初始化等待界面完成,修改显示"),e.next=11,this.SDK.curBoard.ChangeBoard(n);case 11:C("修改完成"),e.next=15;break;case 14:C("加入队组失败:",r);case 15:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"AI",value:(r=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.SDK.gameManager.Player.AI=t.isChecked,this.SDK.gameManager.Player.AI_jump=!1,this.SDK.gameManager.Player.AI_power=!1;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"gameEnd",value:(t=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.SDK.sendToServer(R.End,(new Date).getTime()/1e3);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ke=function e(){i(this,e),this.switch_audio=!0},e("GameManager",(H=Te("GameManager"),V=Ce({type:z}),Q=Ce({type:j}),X=Ce({type:m}),Y=Ce({type:m}),Z=Ce({type:p}),$=Ce({type:m}),ee=Ce({type:f}),te=Ce({type:f}),re=Ce({type:f}),ne=Ce({type:f}),ie=Ce({type:f}),ae=Ce({type:f}),se=Ce({type:f}),oe=Ce({type:f}),ue=Ce({type:f}),le=Ce({type:f}),H((de=r((he=function(e){function t(){var e,r;i(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(r=a(this,(e=s(t)).call.apply(e,[this].concat(l)))).SDK=new L,r.Setting=new Ke,r.Debug=null,r.Util=new O(r.SDK,o(r)),u(r,"Player",de,o(r)),u(r,"OtherTeam",me,o(r)),u(r,"CenterNode",pe,o(r)),u(r,"plane",fe,o(r)),u(r,"camera",ge,o(r)),u(r,"UI",ye,o(r)),u(r,"audio_failed",ve,o(r)),u(r,"audio_complete",xe,o(r)),u(r,"audio_dead",_e,o(r)),u(r,"audio_perfect",be,o(r)),u(r,"audio_last5s",Pe,o(r)),u(r,"audio_ready",we,o(r)),u(r,"audio_relife",De,o(r)),u(r,"audio_touch_down",Be,o(r)),u(r,"audio_win",ke,o(r)),u(r,"audio_go",Se,o(r)),r._origin_camera_pos=new g,r.map=[],r.curActionPlayer=null,r.scoreNodeList=[],r.curBox=null,r.nextBox=null,r._isControler=!1,r.startTime=0,r.gameTime=0,r._isRunning=!1,r.diaDead=!1,r.AccessToken=null,r.clearTime=0,r.teammaterIsLover=void 0,r.enemyIsLover=void 0,r.isReconnect=!1,r.BoxPrefab={f1:[null,null,null,null,null,null,null,null,null,null],f2:[null,null,null,null,null,null,null,null,null,null],f3:[null,null,null,null,null,null,null,null,null,null],f4:[null,null,null,null,null,null,null,null,null,null],f5:[null,null,null,null,null,null,null,null,null,null],y1:[null,null,null,null,null,null,null,null,null,null],y2:[null,null,null,null,null,null,null,null,null,null],y3:[null,null,null,null,null,null,null,null,null,null],y4:[null,null,null,null,null,null,null,null,null,null],y5:[null,null,null,null,null,null,null,null,null,null]},r.ChessPrefab=[],r.ChessPrefabEnemy={red:null,blue:null},r}var r,h,d,p,f,v,w,z,j,H,V,Q,X,Y,Z,$,ee;return n(t,e),l(t,[{key:"initPrefab",value:(ee=c(regeneratorRuntime.mark((function e(){var t,r,n,i,a,s,o,u,l,c,h,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.node.getParent(),this.MainBoard=new J(t,this.SDK),this.WaitLoverBoard=new A(t,this.SDK),this.MatchingBoard=new W(t,this.SDK),this.GamingBoard=new F(t,this.SDK),this.ResultBoard=new q(t,this.SDK),this.MainBoard.InitBoard(),this.GamingBoard.InitBoard(),this.MatchingBoard.InitBoard(),this.WaitLoverBoard.InitBoard(),this.ResultBoard.board=t.getChildByName("UI").getChildByName("ResultBoard"),n=1;n<=5;n++)for(i=1;i<=10;i++)a="",a=i<10?"Model/Box/f"+n+"0"+i+"/f"+n+"0"+i:"Model/Box/f"+n+i+"/f"+n+i,s="f"+n.toString(),this.Util.loadBoxPrefab(a,s,i-1);for(o=1;o<=5;o++)for(u=1;u<=10;u++)l="",l=u<10?"Model/Box/y"+o+"0"+u+"/y"+o+"0"+u:"Model/Box/y"+o+u+"/y"+o+u,c="y"+o.toString(),this.Util.loadBoxPrefab(l,c,u-1);C("盒子预制件",this.BoxPrefab),h=["red_1","red_2","blue_1","blue_2"],d=0;case 16:if(!(d<h.length)){e.next=25;break}return m="Model/qizi/"+h[d]+"/Node",e.next=20,this.Util.loadPrefab(m);case 20:(r=e.sent)&&this.ChessPrefab.push(r);case 22:d++,e.next=16;break;case 25:return e.next=27,this.Util.loadPrefab("Model/qizi/enemy_blue/Node");case 27:return(r=e.sent)&&(this.ChessPrefabEnemy.blue=r),e.next=31,this.Util.loadPrefab("Model/qizi/enemy_red/Node");case 31:return(r=e.sent)&&(this.ChessPrefabEnemy.red=r),e.next=35,this.Util.loadPrefab("Prefab/UI/perfect");case 35:(r=e.sent)&&(this.PerfectPrefab=r);case 37:case"end":return e.stop()}}),e,this)}))),function(){return ee.apply(this,arguments)})},{key:"initData",value:($=c(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SDK.init(t,this);case 2:if(r=e.sent,n=this.node.getParent(),!r){e.next=28;break}return C("初始化SDK成功",MGOBE.Player.id),e.next=8,this.SDK.inRunningRoom();case 8:if(!e.sent){e.next=15;break}return i=new E(n,this.SDK,"游戏仍在进行中,是否要进行重连?",N.multiple,"重连","不重连"),e.next=13,i.show(this,this.reconnection_yes,this.reconnection_no);case 13:e.next=26;break;case 15:return e.next=17,this.SDK.leaveGroup();case 17:return e.next=19,this.SDK.leaveRoom();case 19:return e.next=21,this.SDK.cancelMatchinig();case 21:return C("初始化直接切换到MainBoard"),a=this.MainBoard,e.next=25,a.ChangeBoard(a);case 25:n.getChildByName("UI").getChildByName("loading").active=!1;case 26:e.next=31;break;case 28:return s=new E(n,this.SDK,"登录失败,请重新开启游戏",N.single,"知道了"),e.next=31,s.show(this,(function(){o.SDK.curDialog.dead||o.SDK.curDialog.destroy()}));case 31:case"end":return e.stop()}}),e,this)}))),function(e){return $.apply(this,arguments)})},{key:"reconnection_yes",value:(Z=c(regeneratorRuntime.mark((function e(){var t,r,n,i,a,s,o,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.diaDead){e.next=2;break}return e.abrupt("return");case 2:return this.diaDead=!0,C("进行断线重连"),this.SDK.curDialog.destroy(),e.next=7,this.SDK.reconnect();case 7:return e.next=9,this.SDK.getRoomInfo();case 9:return t=e.sent,e.next=12,this.SDK.getPlayerInfo();case 12:if(r=e.sent,!t){e.next=38;break}i=t.playerList,a=0;case 16:if(!(a<i.length)){e.next=24;break}if((s=i[a]).id!=r.id){e.next=21;break}return n=s.teamId,e.abrupt("break",24);case 21:a++,e.next=16;break;case 24:return this.SDK.curRoom.onRecvFromGameSvr=this.onRecvFromGameSvr.bind(this),e.next=27,this.SDK.sendToServer(R.Reconnect,n);case 27:if(o=e.sent,C("请求重连的回应",o),o==MGOBE.ErrCode.EC_OK){e.next=36;break}return this.SDK.leaveGroup(),this.SDK.leaveRoom(),u=this.node.getParent(),l=new E(u,this.SDK,"房间已关闭,无法重连",N.single,"回到首页"),e.next=36,l.show(this,this.backMainBoard);case 36:e.next=39;break;case 38:C("重连失败");case 39:case"end":return e.stop()}}),e,this)}))),function(){return Z.apply(this,arguments)})},{key:"reconnection_no",value:(Y=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.SDK.curDialog.dead){e.next=2;break}return e.abrupt("return");case 2:return C("拒绝断线重连"),this.node.getParent(),this.SDK.leaveGroup(),this.SDK.leaveRoom(),this.SDK.curDialog.destroy(),C("点击拒绝重连切换到MainBoard"),t=this.MainBoard,e.next=11,t.ChangeBoard(t);case 11:case"end":return e.stop()}}),e,this)}))),function(){return Y.apply(this,arguments)})},{key:"onRecvFromGameSvr",value:(X=c(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C("接收到实时服务器的数据:",t.data),r=this.node.getParent(),n=t.data.data,(i=n.type)!=U.Reconnect){e.next=18;break}return this.isReconnect=!0,this.SDK.curRoom.onRecvFromGameSvr=null,e.next=9,this.reconnectSyncData(n.data);case 9:return this.isRunning=!0,a=this.GamingBoard,e.next=13,a.ChangeBoard(a);case 13:this.SDK.sendToServer(R.ReconnectComplete,this.serverTeam.id),this.SDK.sendToServer(R.ChangeControler),this.changeControler(this.curActionPlayer),e.next=23;break;case 18:if(i!=U.ReconnectFailed){e.next=23;break}return C("重连失败,游戏已经结束"),s=new E(r,this.SDK,"游戏已结束",N.single,"知道了"),e.next=23,s.show(this,(function(){if(!o.SDK.curDialog.dead){var e=o.MainBoard;e.ChangeBoard(e),o.SDK.curDialog.destroy()}}));case 23:case"end":return e.stop()}}),e,this)}))),function(e){return X.apply(this,arguments)})},{key:"backMainBoard",value:(Q=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.SDK.curDialog.dead){e.next=2;break}return e.abrupt("return");case 2:return this.SDK.curDialog.destroy(),t=this.MainBoard,e.next=6,t.ChangeBoard(t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return Q.apply(this,arguments)})},{key:"start",value:(V=c(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Player.gameManager=this,this.OtherTeam.gameManager=this,this.camera.node.getPosition(this._origin_camera_pos),t=window.location.search,r=this.Util.getPara("access_token",t),n=null,this.AccessToken=r,B==k.develop&&(n=this.Util.getPara("user_id",t)),this.registerEvent(),this.Player.onJumpComplete=this.onJumpComplete.bind(this),this.Player.onJumpDead=this.onJumpDead.bind(this),this.Player.onPowerDown=this.onPowerDown.bind(this),this.Player.onPowerUp=this.onPowerUp.bind(this),this.schedule(this.timerSingalAction.bind(this),.5),e.next=16,this.initPrefab();case 16:return this.Debug=new Re(this.node,this.SDK),this.node.parent.getChildByName("UI").getChildByName("Debug").active=!0,e.next=19,this.login(n);case 19:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"login",value:(H=c(regeneratorRuntime.mark((function e(){var t,r,n,i,a,s,o,u,l,c,h,d=this,m=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]?m[0]:null,r={nickname:"",avatar_url:"",user_id:0,lover_id:0,gender:0,playCountWeek:0,winCountWeek:0,mvpCountWeek:0,loverCount:0,loverWinCount:0,tacitScore:0,isVip:!1},!t){e.next=19;break}return r.nickname=t,r.avatar_url="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK9xvXic6aqFUicsGcLibMcLMQyUQ9IlViaHwtpib4mePDziaeBNyYicRFiab5m8SnF7kmppAqOexqbCPB4g/132",r.user_id=t,r.lover_id=0,r.gender=1,r.playCountWeek=0,r.mvpCountWeek=0,r.winCountWeek=0,r.loverCount=0,r.loverWinCount=0,r.tacitScore=0,r.isVip=!1,this.PlayerData=r,this.initData(t),C("登录完成","user_id","玩家数据:",this.PlayerData),e.abrupt("return");case 19:if(!this.AccessToken){e.next=60;break}return e.next=22,this.Util.http(S.gameInit,"GET",{},!1,this.AccessToken);case 22:return n=e.sent,e.next=25,this.Util.http(S.accountInit,"GET",{},!1,this.AccessToken);case 25:return i=e.sent,e.next=28,this.Util.http(S.vipInfo,"GET",{},!1,this.AccessToken);case 28:if(a=e.sent,C("1",n),C("2",i),C("3",a),!(n&&i.kiwi_user_info&&a)){e.next=54;break}return s=i.kiwi_user_info,o=n,i.other_single_user_info&&i.other_single_user_info.avatar&&(this.loverData=i.other_single_user_info),r.nickname=s.nickname?s.nickname:s.id.toString(),r.avatar_url=s.avatar_info?"https://"+s.avatar_info.host+"/"+s.avatar_info.path:"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK9xvXic6aqFUicsGcLibMcLMQyUQ9IlViaHwtpib4mePDziaeBNyYicRFiab5m8SnF7kmppAqOexqbCPB4g/132",r.user_id=s.id,r.lover_id=s.lovers_id,r.gender=s.gender,r.playCountWeek=o.user_match_info.game_match_count?o.user_match_info.game_match_count:0,r.mvpCountWeek=o.user_match_info.mvp_count?o.user_match_info.mvp_count:0,r.winCountWeek=o.user_match_info.win_count?o.user_match_info.win_count:0,r.loverCount=o.lover_match_info.game_match_count?o.lover_match_info.game_match_count:0,r.loverWinCount=o.lover_match_info.win_count?o.lover_match_info.win_count:0,r.tacitScore=o.lover_match_info.tacit_socre?o.lover_match_info.tacit_socre:0,this.PlayerData=r,this.PlayerData.isVip=!!a&&1e3*a.vip_info.end_date_at>(new Date).getTime(),this.initData(this.PlayerData.user_id),C("登录完成","token","玩家数据:",this.PlayerData),e.abrupt("return");case 54:return u=this.node.getParent(),l=new E(u,this.SDK,"登录失败,未获取到玩家信息",N.single,"知道了"),e.next=58,l.show(this,(function(){d.SDK.curDialog.dead||d.SDK.curDialog.destroy()}));case 58:e.next=64;break;case 60:return c=this.node.getParent(),h=new E(c,this.SDK,"登录失败,无登录数据",N.single,"知道了"),e.next=64,h.show(this,(function(){d.SDK.curDialog.dead||d.SDK.curDialog.destroy()}));case 64:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)})},{key:"registerEvent",value:function(){this.node.on("GameInit",this.gameInit,this),this.node.on("SyncData",this.syncGameData,this)}},{key:"gameInit",value:(j=c(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o,u,l,c,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C("游戏初始化","开始"),this.isReconnect=!1,r=t.map,n=t.gameState,e.next=6,this.SDK.getPlayerInfo();case 6:if(e.sent,this.CenterNode.setParent(this.node.getParent()),C("游戏初始化","地图数据:",r),C("游戏初始化","游戏数据",n),this.map.length>0){for(i=0;i<this.map.length;i++)(a=this.map[i].node)&&a.destroy();this.map=[]}return this.camera.node.setPosition(this._origin_camera_pos),this.plane.setPosition(new g(0,0,0)),e.next=15,this.drawMap(r,!0);case 15:return e.next=17,this.syncGameData(n.teamList,!0);case 17:return this.Player.initPlayer(),this.OtherTeam.initPlayer(),e.next=21,this.SDK.getPlayerInfo();case 21:return s=e.sent,e.next=24,this.SDK.getPlayerIndex();case 24:return u=e.sent,o=this.Util.isControler(n.curActionPlayer,s)?u:1==u?2:1,this.serverPlayer.teamId==M.red?(l=1,c=M.blue):(l=3,c=M.red),l+=o-1,e.next=30,this.Player.setModel(l);case 30:return e.next=32,this.OtherTeam.setModel(c);case 32:if(!this.PlayerData.isVip){e.next=35;break}return e.next=35,this.Player.setTire(1);case 35:return e.next=37,this.Util.enemyIsVip();case 37:if(!e.sent){e.next=41;break}return e.next=41,this.OtherTeam.setTire(1);case 41:return this.OtherTeam.map=this.map,this.OtherTeam.index=0,this.Player.curBox=this.map[0],this.Player.nextBox=this.map[1],this.OtherTeam.curBox=this.map[0],this.OtherTeam.nextBox=this.map[1],this.curActionPlayer=n.curActionPlayer,e.next=50,this.SDK.sendToServer(R.Ready,{avatar:this.PlayerData.avatar_url,user_id:this.PlayerData.user_id,gender:this.PlayerData.gender,lover_id:this.PlayerData.lover_id});case 50:(h=e.sent)==this.SDK.errorCode.EC_OK?C("游戏初始化","完成","发送ready信号","成功"):C("游戏初始化","完成","发送ready信号","失败",h);case 52:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"reconnectSyncData",value:(z=c(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C("断线重连同步数据",t),B==k.develop?this.gameTime=T:this.gameTime=t.gameTime,this.startTime=t.startTime,e.next=5,this.drawMap(t.map,!0);case 5:return e.next=7,this.syncGameData(t.gameState.teamList,!0);case 7:return e.next=9,this.SDK.getGroupInfo();case 9:return(r=e.sent)&&(this.SDK.Listener.add(this.SDK.curGroup),this.SDK.curGroup.initGroup(r)),e.next=13,this.SDK.getPlayerInfo();case 13:return n=e.sent,e.next=16,this.SDK.getPlayerIndex();case 16:return a=e.sent,i=this.Util.isControler(t.gameState.curActionPlayer,n)?a:1==a?2:1,this.serverPlayer.teamId==M.red?(s=1,o=M.blue):(s=3,o=M.red),s+=i-1,e.next=22,this.Player.setModel(s);case 22:return e.next=24,this.OtherTeam.setModel(o);case 24:if(!this.PlayerData.isVip){e.next=27;break}return e.next=27,this.Player.setTire(1);case 27:return e.next=29,this.Util.enemyIsVip();case 29:if(!e.sent){e.next=33;break}return e.next=33,this.OtherTeam.setTire(1);case 33:this.Player.reset(this.serverTeam),this.OtherTeam.reset(),this.curActionPlayer=t.gameState.curActionPlayer;case 36:case"end":return e.stop()}}),e,this)}))),function(e){return z.apply(this,arguments)})},{key:"syncData",value:(w=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncGameData(t);case 2:return this.uiRefresh(),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"changeControler",value:(v=c(regeneratorRuntime.mark((function e(t){var r,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C("控制权转移数据",t),e.next=3,this.SDK.getPlayerInfo();case 3:r=e.sent,n=this.Util.isControler(t,r),setTimeout(c(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.SDK.getPlayerIndex();case 2:return r=e.sent,t=n?r:1==r?2:1,a=i.serverPlayer.teamId==M.red?1:3,a+=t-1,e.next=8,i.Player.setModel(a);case 8:i.isControler=n,i.uiRefresh(),i.avatarSingal(n,!0);case 11:case"end":return e.stop()}}),e)}))),500);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"syncMap",value:(f=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C("同步地图数据",t),this.drawMap(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"onJumpComplete",value:function(e,t){if("GamingBoard"==this.SDK.curBoard.name){if(C("跳跃完成","发送完成信号"),C("跳跃完成","是否为进入下一跳:",e),this.isControler=!1,this.Player.jumpResult.perfect?(this.serverTeam.perfectJump+=1,this.Util.playAudio(this.audio_perfect)):(this.serverTeam.perfectJump=0,this.Util.playAudio(this.audio_complete)),this.avatarSingal(!1,!1),e){C("跳跃完成","完美跳跃次数:",this.serverTeam.perfectJump);var r=this.Util.getScore(this.serverTeam.perfectJump);this.showScore(r,this.serverTeam.perfectJump);var n=new g,i=new g,a=new g;if(this.nextBox.node.getPosition(i),this.nextBox.node.getPosition(a),a.y=0,t&&(this.serverPlayer.score+=r),this.serverTeam.cur_cube+=1,this.serverTeam.pos=this.Player.jumpResult.offset,C("跳跃完成","最新的下标:",this.serverTeam.cur_cube),C("跳跃完成","地图长度:",this.map.length),this.Player.curBox=this.map[this.serverTeam.cur_cube],this.Player.nextBox=this.map[this.serverTeam.cur_cube+1],this.curBox=this.Player.curBox,this.nextBox=this.Player.nextBox,this.updateCenterNode(this.serverTeam.perfectJump>0),this.nextBox){var s=new g;this.nextBox.node.getPosition(s),i.x=(i.x+s.x)/2,i.z=(i.z+s.z)/2,g.add(n,i,this._origin_camera_pos),C("跳跃完成","移动镜头:",n),y(this.camera.node).to(.5,{position:n},{}).start(),y(this.plane).to(.5,{position:a},{}).start()}}else this.updateCenterNode(!1),this.serverTeam.pos=this.Player.jumpResult.offset;t?(C("跳跃完成","作为控制者发送跳跃完成信号"),this.SDK.sendToServer(R.JumpComplete,{team:this.serverTeam})):(C("跳跃完成","作为观看者发送请求同步数据信号"),this.SDK.sendToServer(R.RequestSyncData,{team:this.SDK.gameManager.serverTeam}))}}},{key:"onJumpDead",value:function(){this.serverTeam.perfectJump=0,this.updateCenterNode(!1),this.avatarSingal(!1,!1),this.isControler?(C("跳跃失败","作为控制者发送跳跃完成信号"),this.SDK.sendToServer(R.JumpComplete,{team:this.serverTeam})):(C("跳跃失败","作为观看者发送请求同步数据信号"),this.SDK.sendToServer(R.RequestSyncData,{team:this.SDK.gameManager.serverTeam})),this.isControler=!1}},{key:"onPowerDown",value:function(){this.SDK.sendToRoom(K.Power,1),this.avatarSingal(!0,!1)}},{key:"onPowerUp",value:function(){var e={distance:this.Player.jumpResult.distance,pos:this.Player.jumpResult.offset,status:this.Player.jumpResult.status,time:this.Player.jumpResult.time,index:this.serverTeam.cur_cube,perfect:this.Player.jumpResult.perfect};this.SDK.sendToRoom(K.PowerEnd,e),this.SDK.sendToRoom(K.EnemyPowerEnd,e)}},{key:"timerSingalAction",value:function(){this.timerSingal&&this.timerSingal()}},{key:"drawMap",value:(p=c(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o,u,l,c,h,d,m,p,f,v,x,_=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(_.length>1&&void 0!==_[1]&&_[1])){e.next=25;break}return e.next=4,this.createBox(t[0]);case 4:r=e.sent,n={node:r,shape:t[0][2],size:t[0][3],index:t[0][4]},this.map.push(n),i=null,a=n,s=1;case 10:if(!(s<t.length)){e.next=21;break}return o=t[s],e.next=14,this.createBox(o,a);case 14:i=e.sent,u={node:i,size:o[2],shape:o[3],index:o[4]},this.map.push(u),a=u;case 18:s++,e.next=10;break;case 21:this.nextBox=this.map[1],this.curBox=this.map[0],e.next=43;break;case 25:if(!(t.length>this.map.length)){e.next=43;break}C("绘制地图","检测到有新的地图数据",this.map.length,"--\x3e",t.length),l=this.map[this.map.length-1],c=null,h=this.map.length;case 30:if(!(h<t.length)){e.next=43;break}return d=t[h],C("绘制地图","开始生成地图节点",h,d),e.next=35,this.createBox(d,l,!0);case 35:c=e.sent,m={node:c,size:d[2],shape:d[3],index:d[4]},this.map.push(m),l=m,h==t.length-1&&(this.OtherTeam.nextBox||(this.OtherTeam.nextBox=m,this.OtherTeam.setFace()),this.nextBox||(C("绘制地图","新地图创建时为自己角色设置nextBox",m),this.nextBox=m,this.Player.nextBox=m,C("绘制地图","创建新节点时设置自己的next box时reset自己的player"),this.Player.reset(),p=new g,f=new g,this.curBox.node.getPosition(p),v=new g,x=new g,this.nextBox.node.getPosition(v),this.nextBox.node.getPosition(x),x.y=0,p.x=(p.x+v.x)/2,p.z=(p.z+v.z)/2,g.add(f,p,this._origin_camera_pos),C("绘制地图","移动镜头",f),y(this.camera.node).to(.5,{position:f}).start(),y(this.plane).to(.5,{position:x},{}).start()));case 40:h++,e.next=30;break;case 43:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"syncGameData",value:(d=c(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o,u,l,c,h,d,m,p,f,y,v,x=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x.length>1&&void 0!==x[1]&&x[1],e.next=3,this.SDK.getPlayerInfo();case 3:if(n=e.sent,i=null,a=null,C("同步游戏数据","开始",t),s="",o="",u=null,r?u=t:(u=t.data,s=t.teamId,o=t.senderId),l=n.teamId==s,c=n.id==o,n.teamId==M.red?(i=u[0],a=u[1]):(i=u[1],a=u[0]),!r){e.next=28;break}this.serverTeam=i,this.otherTeam=a,h=0;case 18:if(!(h<i.playerList.length)){e.next=26;break}if((d=i.playerList[h]).id!=n.id){e.next=23;break}return this.serverPlayer=d,e.abrupt("break",26);case 23:h++,e.next=18;break;case 26:e.next=42;break;case 28:if(!l||!c){e.next=41;break}this.serverTeam=i,m=0;case 31:if(!(m<i.playerList.length)){e.next=39;break}if((p=i.playerList[m]).id!=n.id){e.next=36;break}return this.serverPlayer=p,e.abrupt("break",39);case 36:m++,e.next=31;break;case 39:e.next=42;break;case 41:this.otherTeam=a;case 42:r?(this.OtherTeam.map=this.map,this.curBox=this.map[i.cur_cube],this.nextBox=this.map[i.cur_cube+1],this.Player.curBox=this.curBox,this.Player.nextBox=this.nextBox,this.OtherTeam.curBox=this.map[a.cur_cube],this.OtherTeam.nextBox=this.map[a.cur_cube+1],f=new g,y=new g,v=new g,this.curBox.node.getPosition(f),this.curBox.node.getPosition(v),v.y=0,g.add(y,f,this._origin_camera_pos),y.y=this._origin_camera_pos.y,this.camera.node.setPosition(y),this.plane.setPosition(v)):l&&c&&(this.SDK.sendToServer(R.SyncComplete,this.serverTeam.id),C("同步游戏数据","当前Map长度:",this.map.length),C("同步游戏数据","当前位置下标:",this.serverTeam.cur_cube),this.curBox=this.map[this.serverTeam.cur_cube],this.nextBox=this.map[this.serverTeam.cur_cube+1],this.Player.curBox=this.curBox,this.Player.nextBox=this.nextBox,this.curBox&&(C("同步游戏数据","数据源为自己,重置自己棋子"),this.Player.reset(this.serverTeam))),C("同步游戏数据","完成","ServerPlayer:",this.serverPlayer,"ServerTeam:",this.serverTeam);case 44:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"createBox",value:(h=c(regeneratorRuntime.mark((function e(){var t,r,n,i,a,s,o,u,l,c,h,d,m,p,f,y,v,b=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=b.length>0&&void 0!==b[0]?b[0]:null,r=b.length>1&&void 0!==b[1]?b[1]:null,n=b.length>2&&void 0!==b[2]&&b[2],i=new g,a=new g,s=t[0],o=t[1],u=t[2],l=t[3],c="",c=l==G.circle?"y":"f",c+=(u+1).toString(),(h=this.BoxPrefab[c][t[4]])||(h=this.BoxPrefab[c][0]),d=x(h),m=d.getChildByName("RootNode"),p=0;p<m.children.length;p++)f=m.children[p],(y=f.getComponent(_))&&(y.shadowCastingMode=1);if(v=d.addComponent(D),!r){e.next=34;break}if(r.node.getPosition(i),(a=i.clone()).y=0,o+=(I[r.size]+I[u])/2,1==s?a.z-=o:a.x+=o,n?d.setPosition(new g(a.x,7,a.z)):d.setPosition(new g(a.x,0,a.z)),d.setParent(this.Player.node.parent),!n){e.next=31;break}return v.startFall(),e.abrupt("return",d);case 31:return e.abrupt("return",d);case 32:e.next=37;break;case 34:return d.setPosition(new g(0,0,0)),d.setParent(this.Player.node.parent),e.abrupt("return",d);case 37:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"clearMap",value:function(){var e=(this.serverTeam.cur_cube>this.otherTeam.cur_cube?this.otherTeam.cur_cube:this.serverTeam.cur_cube)-4;if(C("地图定时清除",e),e>0)for(var t=e;t>=0;t--){var r=this.map[t];if(!r.node)break;C("地图定时清除",t,r.node),r.node.destroy(),r.node=null}}},{key:"showScore",value:(r=c(regeneratorRuntime.mark((function e(t,r){var n,i,a,s,o,u,l,c,h,d,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.node.parent.getChildByName("UI"),i=new m,s=new g,this.Player.node.getPosition(s),s.y+=1,o=new g,this.camera.convertToUINode(s,n,o),u=i.addComponent(b),l=i.addComponent(P),u.setContentSize(35,25),l.string="+"+t,l.fontSize=20,i.setPosition(o),i.setParent(n),i.active=!0,!(r>0)){e.next=39;break}if(C("白圈"),this.Player.quan.startAnimation(),(a=x(this.PerfectPrefab)).active=!1,c=a.getChildByName("number_1"),h=a.getChildByName("number_2"),!(r<10)){e.next=27;break}return e.next=25,this.Util.loadImg("Texture/number/"+r+"/spriteFrame",c);case 25:e.next=35;break;case 27:return d=Math.floor(r/10),C("COUNT",d,p=r%10,r),e.next=32,this.Util.loadImg("Texture/number/"+d+"/spriteFrame",c);case 32:return e.next=34,this.Util.loadImg("Texture/number/"+p+"/spriteFrame",h);case 34:h.active=!0;case 35:o.y+=1,a.setPosition(o),a.setParent(n),a.active=!0;case 39:f={node:i,perfect:a,owner:this.Player.node,time:0},this.scoreNodeList.push(f);case 41:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"updateCenterNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.CenterNode.active=!1,void this.CenterNode.setParent(this.node.getParent());if(!this.nextBox)return this.CenterNode.active=!1,void this.CenterNode.setParent(this.node.getParent());this.CenterNode.setParent(this.nextBox.node);var t=I[this.nextBox.size]/10;this.CenterNode.setScale(new g(t,.001,t)),this.CenterNode.active=!0}},{key:"updateScoreNode",value:function(e){for(var t=new g,r=new g,n=new g,i=this.node.parent.getChildByName("UI"),a=this.scoreNodeList.length-1;a>=0;a--){var s=this.scoreNodeList[a];s.owner.getPosition(t),t.y+=2*s.time+1,this.camera.convertToUINode(t,i,r),s.node.setPosition(r),null!=s.perfect&&(s.owner.getPosition(n),n.y+=2,this.camera.convertToUINode(n,i,n),s.perfect.setPosition(n)),s.time+=e,s.time>1&&(s.node.destroy(),s.perfect&&s.perfect.destroy(),this.scoreNodeList.splice(a,1))}}},{key:"update",value:function(e){this.updateScoreNode(e),this.isRunning&&(this.clearTime+=e,this.clearTime>=60&&(this.clearTime=0,this.clearMap()))}},{key:"isControler",set:function(e){this._isControler=e,this.Player.control=e},get:function(){return this._isControler}},{key:"isRunning",set:function(e){this._isRunning=e,this.Player.isRunning=e,this.OtherTeam.isRunning=e},get:function(){return this._isRunning}}]),t}(v)).prototype,"Player",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=r(he.prototype,"OtherTeam",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=r(he.prototype,"CenterNode",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=r(he.prototype,"plane",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=r(he.prototype,"camera",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=r(he.prototype,"UI",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=r(he.prototype,"audio_failed",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=r(he.prototype,"audio_complete",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=r(he.prototype,"audio_dead",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=r(he.prototype,"audio_perfect",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=r(he.prototype,"audio_last5s",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=r(he.prototype,"audio_ready",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=r(he.prototype,"audio_relife",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=r(he.prototype,"audio_touch_down",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=r(he.prototype,"audio_win",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=r(he.prototype,"audio_go",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=he))||ce)),h._RF.pop()}}}));

System.register("chunks:///Interface.js",["cc"],(function(e,c){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"894b2eWkr1IfbbtaCcBLs2k","Interface",void 0),t._RF.pop()}}}));

System.register("chunks:///UI/Board/GamingUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var i,n,o,a,s,c,r,h,l,d,u,y,g;return t({_dec:void 0,_class:void 0}),{setters:[function(t){i=t.inherits,n=t.createClass,o=t.classCallCheck,a=t.possibleConstructorReturn,s=t.getPrototypeOf},function(t){c=t.cclegacy,r=t._decorator,h=t.Vec3,l=t.tween,d=t.Component}],execute:function(){c._RF.push({},"b7379HiLIFODaP71KwyPtxD","GamingUI",void 0),g=r.ccclass,r.property,t("GamingUI",(u=g("GamingUI"),u(y=function(t){function e(){return o(this,e),a(this,s(e).apply(this,arguments))}return i(e,t),n(e,[{key:"start",value:function(){}},{key:"showEmoji",value:function(){var t=this.node.getChildByName("Interaction").getPosition().y;this.node.getChildByName("Interaction").active=!1,this.node.getChildByName("Interaction-ex").active=!0,this.node.getChildByName("Interaction-ex").setPosition(new h(250,t,0)),l(this.node.getChildByName("Interaction-ex")).to(.3,{position:{x:57,y:t,z:0}},{onComplete:function(){}.bind(this)}).start()}},{key:"hideEmoji",value:function(){var t=this.node.getChildByName("Interaction-ex").getPosition().y;l(this.node.getChildByName("Interaction-ex")).to(.3,{position:{x:250,y:t,z:0}},{onComplete:function(){this.node.getChildByName("Interaction-ex").active=!1,this.node.getChildByName("Interaction").active=!0}.bind(this)}).start()}}]),e}(d))||y)),c._RF.pop()}}}));

System.register("chunks:///UI/resultUI.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../Const.js"],(function(t,e){var n,s,a,i,u,o,r,c,l,p,m,f,h;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,s=t.createClass,a=t.classCallCheck,i=t.possibleConstructorReturn,u=t.getPrototypeOf},function(t){o=t.cclegacy,r=t._decorator,c=t.Animation,l=t.Component},function(t){p=t.log}],execute:function(){o._RF.push({},"8f98aNhGdlEqY/iWb0VOzE3","resultUI",void 0),h=r.ccclass,r.property,t("ResultUI",(m=h("ResultUI"),m(f=function(t){function e(){return a(this,e),i(this,u(e).apply(this,arguments))}return n(e,t),s(e,[{key:"start",value:function(){this.anima=this.node.getComponent(c),p("anima: ",this.anima),p("parent: ",this.node.getParent()),this.anima.defaultClip.events.push({frame:1,func:"test",params:[]}),this.anima.defaultClip.updateEventDatas()}},{key:"test",value:function(){var t=this;p("anima test"),this.anima.pause(),setTimeout((function(){t.anima.resume()}),1e3)}},{key:"mvpAnimaEnd",value:function(){p("mvp Anima end")}}]),e}(l))||f)),o._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../Box.js","../Config.js","../Const.js","../quan.js","../Player.js","../Util.js","../SDK.js","../UI/Dialog/Dialog.js","../UI/Board/BaseBoard.js","../UI/Board/WaitLoverBoard.js","../OtherPlayer.js","../UI/avatar.js","../UI/Board/GamingBoard.js","../UI/Dialog/RulesDialog.js","../UI/Board/MainBoard.js","../UI/Board/MatchingBoard.js","../UI/Board/ResultBoard.js","../GameManager.js","../Interface.js","../UI/Board/GamingUI.js","../UI/resultUI.js"],(function(n,o){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/Box.js', 'chunks:///Box.js');
  r('project:///assets/Scripts/Config.js', 'chunks:///Config.js');
  r('project:///assets/Scripts/Const.js', 'chunks:///Const.js');
  r('project:///assets/Scripts/quan.js', 'chunks:///quan.js');
  r('project:///assets/Scripts/Player.js', 'chunks:///Player.js');
  r('project:///assets/Scripts/Util.js', 'chunks:///Util.js');
  r('project:///assets/Scripts/SDK.js', 'chunks:///SDK.js');
  r('project:///assets/Scripts/UI/Dialog/Dialog.js', 'chunks:///UI/Dialog/Dialog.js');
  r('project:///assets/Scripts/UI/Board/BaseBoard.js', 'chunks:///UI/Board/BaseBoard.js');
  r('project:///assets/Scripts/UI/Board/WaitLoverBoard.js', 'chunks:///UI/Board/WaitLoverBoard.js');
  r('project:///assets/Scripts/OtherPlayer.js', 'chunks:///OtherPlayer.js');
  r('project:///assets/Scripts/UI/avatar.js', 'chunks:///UI/avatar.js');
  r('project:///assets/Scripts/UI/Board/GamingBoard.js', 'chunks:///UI/Board/GamingBoard.js');
  r('project:///assets/Scripts/UI/Dialog/RulesDialog.js', 'chunks:///UI/Dialog/RulesDialog.js');
  r('project:///assets/Scripts/UI/Board/MainBoard.js', 'chunks:///UI/Board/MainBoard.js');
  r('project:///assets/Scripts/UI/Board/MatchingBoard.js', 'chunks:///UI/Board/MatchingBoard.js');
  r('project:///assets/Scripts/UI/Board/ResultBoard.js', 'chunks:///UI/Board/ResultBoard.js');
  r('project:///assets/Scripts/GameManager.js', 'chunks:///GameManager.js');
  r('project:///assets/Scripts/Interface.js', 'chunks:///Interface.js');
  r('project:///assets/Scripts/UI/Board/GamingUI.js', 'chunks:///UI/Board/GamingUI.js');
  r('project:///assets/Scripts/UI/resultUI.js', 'chunks:///UI/resultUI.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});
} }; });